<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Supporting Document Mandatory Technical Document: Evaluation Activities for collaborative Protection Profile for Hardcopy Devices</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book">
<div id="header">
<h1>Supporting Document Mandatory Technical Document: Evaluation Activities for collaborative Protection Profile for Hardcopy Devices</h1>
<div class="details">
<span id="revnumber">version 1.1,</span>
<span id="revdate">29 December 2025</span>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_foreword">Foreword</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a Supporting Document (SD), intended to complement the Common Criteria (CC) version CC:2022 Revision 1 and the associated Common Evaluation Methodology for Information Technology Security Evaluation.</p>
</div>
<div class="paragraph">
<p>Supporting Documents may be "Guidance Documents", that highlight specific approaches and application of the standard to areas where no mutual recognition of its application is required, and as such, are not of normative nature, or "Mandatory Technical Documents", whose application is mandatory for evaluations whose scope is covered by that of the Supporting Document. The usage of the latter class is not only mandatory, but certificates issued as a result of their application are recognized under the CCRA.</p>
</div>
<div class="paragraph">
<p>This SD has been developed by the Hardcopy Devices (HCD-iTC) and is designed to be used to support the evaluations of TOEs against the cPP identified in <a href="#_technology_area_and_scope_of_supporting_document">Section 1.1, &#8220;Technology Area and Scope of Supporting Document&#8221;</a>.</p>
</div>
<div class="sect2">
<h3 id="_technical_editor">Technical Editor</h3>
<div class="paragraph">
<p>Hardcopy Device International Technical Community (HCD-iTC)</p>
</div>
</div>
<div class="sect2">
<h3 id="_revision_history">Revision History</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Revision history</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31 October 2022</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial release for use</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 March 2024</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Errata version.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">29 December 2025</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CC:2022 update</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_general_purpose">General Purpose</h3>
<div class="paragraph">
<p>See <a href="#_technology_area_and_scope_of_supporting_document">Section 1.1, &#8220;Technology Area and Scope of Supporting Document&#8221;</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_field_of_special_use">Field of special use</h3>
<div class="paragraph">
<p>This Supporting Document applies to the evaluation of TOEs claiming conformance with the collaborative Protection Profile for Hardcopy Devices <a href="#HCDcPP">[HCDcPP]</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements">Acknowledgements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Supporting Document (SD) was developed by the Hardcopy Devices international Technical Community (iTC) also known as HCD-iTC with representatives from industry, Government agencies, Common Criteria Test Laboratories, and members of academia.</p>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_foreword">Foreword</a>
<ul class="sectlevel2">
<li><a href="#_technical_editor">Technical Editor</a></li>
<li><a href="#_revision_history">Revision History</a></li>
<li><a href="#_general_purpose">General Purpose</a></li>
<li><a href="#_field_of_special_use">Field of special use</a></li>
</ul>
</li>
<li><a href="#_acknowledgements">Acknowledgements</a></li>
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_technology_area_and_scope_of_supporting_document">1.1. Technology Area and Scope of Supporting Document</a></li>
<li><a href="#_structure_of_the_document">1.2. Structure of the Document</a></li>
</ul>
</li>
<li><a href="#_evaluation_activities_for_sfrs">2. Evaluation Activities for SFRs</a>
<ul class="sectlevel2">
<li><a href="#_security_audit_fau">2.1. Security Audit (FAU)</a>
<ul class="sectlevel3">
<li><a href="#_fau_gen_1_audit_data_generation">2.1.1. FAU_GEN.1 Audit data generation</a></li>
<li><a href="#_fau_gen_2_user_identity_association">2.1.2. FAU_GEN.2 User identity association</a></li>
<li><a href="#_fau_sar_1_audit_review">2.1.3. FAU_SAR.1 Audit review</a></li>
<li><a href="#_fau_sar_2_restricted_audit_review">2.1.4. FAU_SAR.2 Restricted audit review</a></li>
<li><a href="#_fau_stg_1_audit_data_storage_location">2.1.5. FAU_STG.1 Audit data storage location</a></li>
<li><a href="#_fau_stg_2_protected_audit_trail_storage">2.1.6. FAU_STG.2 Protected audit trail storage</a></li>
<li><a href="#_fau_stg_5_prevention_of_audit_data_loss">2.1.7. FAU_STG.5 Prevention of audit data loss</a></li>
</ul>
</li>
<li><a href="#_cryptographic_support_fcs">2.2. Cryptographic Support (FCS)</a>
<ul class="sectlevel3">
<li><a href="#_fcs_ckm_1skg_cryptographic_key_generation_symmetric_keys">2.2.1. FCS_CKM.1/SKG Cryptographic key generation (Symmetric Keys)</a></li>
<li><a href="#_fcs_ckm_2_cryptographic_key_establishment">2.2.2. FCS_CKM.2 Cryptographic Key Establishment</a></li>
<li><a href="#_fcs_ckm_6_timing_and_event_of_cryptographic_key_destruction">2.2.3. FCS_CKM.6 Timing and event of cryptographic key destruction</a></li>
<li><a href="#_fcs_cop_1dataencryption_cryptographic_operation_data_encryptiondecryption">2.2.4. FCS_COP.1/DataEncryption Cryptographic Operation (Data Encryption/Decryption)</a></li>
<li><a href="#_fcs_cop_1siggen_cryptographic_operation_signature_generation_and_verification">2.2.5. FCS_COP.1/SigGen Cryptographic Operation (Signature Generation and Verification)</a></li>
<li><a href="#_fcs_cop_1hash_cryptographic_operation_hash_algorithm">2.2.6. FCS_COP.1/Hash Cryptographic Operation (Hash Algorithm)</a></li>
<li><a href="#_fcs_rbg_ext_1_cryptographic_operation_random_bit_generation">2.2.7. FCS_RBG_EXT.1 Cryptographic Operation (Random Bit Generation)</a></li>
</ul>
</li>
<li><a href="#_user_data_protection_fdp">2.3. User Data Protection (FDP)</a>
<ul class="sectlevel3">
<li><a href="#_fdp_acc_1_subset_access_control">2.3.1. FDP_ACC.1 Subset access control</a></li>
<li><a href="#_fdp_acf_1_security_attribute_based_access_control">2.3.2. FDP_ACF.1 Security attribute based access control</a></li>
</ul>
</li>
<li><a href="#_identification_and_authentication_fia">2.4. Identification and Authentication (FIA)</a>
<ul class="sectlevel3">
<li><a href="#_fia_afl_1_authentication_failure_handling">2.4.1. FIA_AFL.1 Authentication failure handling</a></li>
<li><a href="#_fia_atd_1_user_attribute_definition">2.4.2. FIA_ATD.1 User attribute definition</a></li>
<li><a href="#_fia_pmg_ext_1_password_management">2.4.3. FIA_PMG_EXT.1 Password Management</a></li>
<li><a href="#_fia_uau_1_timing_of_authentication">2.4.4. FIA_UAU.1 Timing of authentication</a></li>
<li><a href="#_fia_uau_7_protected_authentication_feedback">2.4.5. FIA_UAU.7 Protected authentication feedback</a></li>
<li><a href="#_fia_uid_1_timing_of_identification">2.4.6. FIA_UID.1 Timing of identification</a></li>
<li><a href="#_fia_usb_1_user_subject_binding">2.4.7. FIA_USB.1 User-subject binding</a></li>
</ul>
</li>
<li><a href="#_security_management_fmt">2.5. Security Management (FMT)</a>
<ul class="sectlevel3">
<li><a href="#_fmt_mof_1_management_of_security_functions_behavior">2.5.1. FMT_MOF.1 Management of security functions behavior</a></li>
<li><a href="#_fmt_msa_1_management_of_security_attributes">2.5.2. FMT_MSA.1 Management of security attributes</a></li>
<li><a href="#_fmt_msa_3_static_attribute_initialization">2.5.3. FMT_MSA.3 Static attribute initialization</a></li>
<li><a href="#_fmt_mtd_1_management_of_tsf_data">2.5.4. FMT_MTD.1 Management of TSF data</a></li>
<li><a href="#_fmt_smf_1_specification_of_management_functions">2.5.5. FMT_SMF.1 Specification of Management Functions</a></li>
<li><a href="#_fmt_smr_1_security_roles">2.5.6. FMT_SMR.1 Security roles</a></li>
</ul>
</li>
<li><a href="#_protection_of_the_tsf_fpt">2.6. Protection of the TSF (FPT)</a>
<ul class="sectlevel3">
<li><a href="#_fpt_sbt_ext_1_secure_boot">2.6.1. FPT_SBT_EXT.1 Secure Boot</a></li>
<li><a href="#_fpt_skp_ext_1_protection_of_tsf_data">2.6.2. FPT_SKP_EXT.1 Protection of TSF Data</a></li>
<li><a href="#_fpt_stm_1_reliable_time_stamps">2.6.3. FPT_STM.1 Reliable time stamps</a></li>
<li><a href="#_fpt_tst_ext_1_tsf_testing">2.6.4. FPT_TST_EXT.1 TSF testing</a></li>
<li><a href="#_fpt_tud_ext_1_trusted_update">2.6.5. FPT_TUD_EXT.1 Trusted Update</a></li>
</ul>
</li>
<li><a href="#_toe_access_fta">2.7. TOE Access (FTA)</a>
<ul class="sectlevel3">
<li><a href="#_fta_ssl_3_tsf_initiated_termination">2.7.1. FTA_SSL.3 TSF-initiated termination</a></li>
</ul>
</li>
<li><a href="#_trusted_channels_ftp">2.8. Trusted Channels (FTP)</a>
<ul class="sectlevel3">
<li><a href="#_ftp_itc_1_inter_tsf_trusted_channel">2.8.1. FTP_ITC.1 Inter-TSF trusted channel</a></li>
<li><a href="#_ftp_trp_1admin_trusted_path_for_administrators">2.8.2. FTP_TRP.1/Admin Trusted path (for Administrators)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_evaluation_activities_for_conditionally_mandatory_requirements">3. Evaluation Activities for Conditionally Mandatory Requirements</a>
<ul class="sectlevel2">
<li><a href="#_confidential_data_on_nonvolatile_storage_devices">3.1. Confidential Data on Nonvolatile Storage Devices</a>
<ul class="sectlevel3">
<li><a href="#_fpt_kyp_ext_1_protection_of_key_and_key_material">3.1.1. FPT_KYP_EXT.1 Protection of Key and Key Material</a></li>
<li><a href="#_fcs_kyc_ext_1_key_chaining">3.1.2. FCS_KYC_EXT.1 Key Chaining</a></li>
<li><a href="#_fdp_dsk_ext_1_protection_of_data_on_disk">3.1.3. FDP_DSK_EXT.1 Protection of Data on Disk</a></li>
</ul>
</li>
<li><a href="#_pstn_fax_network_separation">3.2. PSTN Fax-Network Separation</a>
<ul class="sectlevel3">
<li><a href="#_fdp_fxs_ext_1_fax_separation">3.2.1. FDP_FXS_EXT.1 Fax separation</a></li>
</ul>
</li>
<li><a href="#_asymmetric_key_generation">3.3. Asymmetric Key Generation</a>
<ul class="sectlevel3">
<li><a href="#_fcs_ckm_1akg_cryptographic_key_generation_for_asymmetric_keys">3.3.1. FCS_CKM.1/AKG Cryptographic Key Generation (for asymmetric keys)</a></li>
</ul>
</li>
<li><a href="#_network_communications">3.4. Network Communications</a>
<ul class="sectlevel3">
<li><a href="#_ftp_trp_1nonadmin_trusted_path_for_non_administrators">3.4.1. FTP_TRP.1/NonAdmin Trusted path (for Non-administrators)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_evaluation_activities_for_optional_requirements">4. Evaluation Activities for Optional Requirements</a>
<ul class="sectlevel2">
<li><a href="#_user_doc_unavailability">4.1. USER.DOC Unavailability</a>
<ul class="sectlevel3">
<li><a href="#_fdp_udu_ext_document_unavailability">4.1.1. FDP_UDU_EXT Document Unavailability</a></li>
</ul>
</li>
<li><a href="#_data_wiping">4.2. Data Wiping</a>
<ul class="sectlevel3">
<li><a href="#_fpt_wipe_ext_data_wiping">4.2.1. FPT_WIPE_EXT Data Wiping</a></li>
</ul>
</li>
<li><a href="#_protected_communications">4.3. Protected Communications</a>
<ul class="sectlevel3">
<li><a href="#_fcs_tlsc_ext_2_tls_client_support_for_mutual_authentication">4.3.1. FCS_TLSC_EXT.2 TLS Client support for mutual authentication</a></li>
<li><a href="#_fcs_tlss_ext_2_tls_server_support_for_mutual_authentication">4.3.2. FCS_TLSS_EXT.2 TLS Server support for mutual authentication</a></li>
<li><a href="#_fcs_dtlsc_ext_2_dtls_client_support_for_mutual_authentication">4.3.3. FCS_DTLSC_EXT.2 DTLS Client support for mutual authentication</a></li>
<li><a href="#_fcs_dtlss_ext_2_dtls_server_support_for_mutual_authentication">4.3.4. FCS_DTLSS_EXT.2 DTLS Server support for mutual authentication</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_evaluation_activities_for_selection_based_requirements">5. Evaluation Activities for Selection-Based Requirements</a>
<ul class="sectlevel2">
<li><a href="#_confidential_data_on_nonvolatile_storage_devices_2">5.1. Confidential Data on Nonvolatile Storage Devices</a>
<ul class="sectlevel3">
<li><a href="#_fcs_cop_1storageencryption_cryptographic_operation_data_encryptiondecryption">5.1.1. FCS_COP.1/StorageEncryption Cryptographic operation (Data Encryption/Decryption)</a></li>
<li><a href="#_fcs_cop_1keywrap_cryptographic_operation_key_wrapping">5.1.2. FCS_COP.1/KeyWrap Cryptographic operation (Key Wrapping)</a></li>
<li><a href="#_fcs_cop_1keyenc_cryptographic_operation_key_encryption">5.1.3. FCS_COP.1/KeyEnc Cryptographic operation (Key Encryption)</a></li>
<li><a href="#_fcs_cop_1keytransport_cryptographic_operation_key_transport">5.1.4. FCS_COP.1/KeyTransport Cryptographic operation (Key Transport)</a></li>
<li><a href="#_fcs_smc_ext_1_submask_combining">5.1.5. FCS_SMC_EXT.1 Submask Combining</a></li>
</ul>
</li>
<li><a href="#_protected_communications_2">5.2. Protected Communications</a>
<ul class="sectlevel3">
<li><a href="#_fcs_ipsec_ext_1_ipsec_selected">5.2.1. FCS_IPSEC_EXT.1 IPsec selected</a></li>
<li><a href="#_fcs_tlsc_ext_1_tls_client_protocol_without_mutual_authentication">5.2.2. FCS_TLSC_EXT.1 TLS Client Protocol without mutual authentication</a></li>
<li><a href="#_fcs_tlss_ext_1_tls_server_protocol_without_mutual_authentication">5.2.3. FCS_TLSS_EXT.1 TLS Server Protocol without mutual authentication</a></li>
<li><a href="#_fcs_dtlsc_ext_1_dtls_client_protocol_without_mutual_authentication">5.2.4. FCS_DTLSC_EXT.1 DTLS Client Protocol without mutual authentication</a></li>
<li><a href="#_fcs_dtlss_ext_1_dtls_server_protocol_without_mutual_authentication">5.2.5. FCS_DTLSS_EXT.1 DTLS Server Protocol without mutual authentication</a></li>
<li><a href="#_fcs_sshc_ext_1_ssh_client">5.2.6. FCS_SSHC_EXT.1 SSH Client</a></li>
<li><a href="#_fcs_sshs_ext_1_ssh_server">5.2.7. FCS_SSHS_EXT.1 SSH Server</a></li>
<li><a href="#_fcs_https_ext_1_https_selected">5.2.8. FCS_HTTPS_EXT.1 HTTPS selected</a></li>
<li><a href="#_fcs_cop_1keyedhash_cryptographic_operation_keyed_hash_algorithm">5.2.9. FCS_COP.1/KeyedHash Cryptographic Operation (Keyed Hash Algorithm)</a></li>
<li><a href="#_fia_psk_ext_1_pre_shared_key_composition">5.2.10. FIA_PSK_EXT.1 Pre-Shared Key Composition</a></li>
</ul>
</li>
<li><a href="#_passphrase_based_key_entry">5.3. Passphrase-based Key Entry</a>
<ul class="sectlevel3">
<li><a href="#_fcs_pcc_ext_1_cryptographic_password_construct_and_conditioning">5.3.1. FCS_PCC_EXT.1 Cryptographic Password Construct and Conditioning</a></li>
<li><a href="#_fcs_kdf_ext_1_cryptographic_key_derivation">5.3.2. FCS_KDF_EXT.1 Cryptographic Key Derivation</a></li>
<li><a href="#_fcs_cop_1cmac_cryptographic_operation_for_cipher_based_message_authentication">5.3.3. FCS_COP.1/CMAC Cryptographic Operation (for cipher-based message authentication)</a></li>
<li><a href="#_fcs_sni_ext_1_cryptographic_operation_salt_nonce_and_initialization_vector_generation">5.3.4. FCS_SNI_EXT.1 Cryptographic Operation (Salt, Nonce, and Initialization Vector Generation)</a></li>
</ul>
</li>
<li><a href="#_identification_and_authentication_fia_2">5.4. Identification and Authentication (FIA)</a>
<ul class="sectlevel3">
<li><a href="#_authentication_using_x_509_certificates_fia_x509_ext">5.4.1. Authentication using X.509 certificates (FIA_X509_EXT)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_evaluation_activities_for_sars">6. Evaluation Activities for SARs</a>
<ul class="sectlevel2">
<li><a href="#_class_ase_security_target">6.1. Class ASE: Security Target</a></li>
<li><a href="#_class_adv_development">6.2. Class ADV: Development</a>
<ul class="sectlevel3">
<li><a href="#_basic_functional_specification_adv_fsp_1">6.2.1. Basic Functional Specification (ADV_FSP.1)</a></li>
<li><a href="#_adv_fsp_1_1_evaluation_activity">6.2.2. ADV_FSP.1-1 Evaluation Activity</a></li>
<li><a href="#_adv_fsp_1_2_evaluation_activity">6.2.3. ADV_FSP.1-2 Evaluation Activity</a></li>
<li><a href="#_adv_fsp_1_3_evaluation_activity">6.2.4. ADV_FSP.1-3 Evaluation Activity</a></li>
<li><a href="#_adv_fsp_1_5_evaluation_activity">6.2.5. ADV_FSP.1-5 Evaluation Activity</a></li>
</ul>
</li>
<li><a href="#_class_agd_guidance_documentation">6.3. Class AGD: Guidance Documentation</a>
<ul class="sectlevel3">
<li><a href="#_operational_user_guidance_agd_ope_1">6.3.1. Operational User Guidance (AGD_OPE.1)</a></li>
<li><a href="#_preparative_procedures_agd_pre_1">6.3.2. Preparative Procedures (AGD_PRE.1)</a></li>
</ul>
</li>
<li><a href="#_class_alc_life_cycle_support">6.4. Class ALC: Life-cycle Support</a>
<ul class="sectlevel3">
<li><a href="#_labelling_of_the_toe_alc_cmc_1">6.4.1. Labelling of the TOE (ALC_CMC.1)</a></li>
<li><a href="#_toe_cm_coverage_alc_cms_1">6.4.2. TOE CM coverage (ALC_CMS.1)</a></li>
</ul>
</li>
<li><a href="#_class_ate_tests">6.5. Class ATE: Tests</a>
<ul class="sectlevel3">
<li><a href="#_independent_testing_conformance_ate_ind_1">6.5.1. Independent Testing - Conformance (ATE_IND.1)</a></li>
</ul>
</li>
<li><a href="#_class_ava_vulnerability_assessment">6.6. Class AVA: Vulnerability Assessment</a>
<ul class="sectlevel3">
<li><a href="#_vulnerability_survey_ava_van_1">6.6.1. Vulnerability Survey (AVA_VAN.1)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_required_supplementary_information">7. Required Supplementary Information</a></li>
<li><a href="#_evaluation_activity_11">8. Evaluation Activity</a></li>
<li><a href="#_references">9. References</a></li>
<li><a href="#_vulnerability_analysis">Appendix A: Vulnerability Analysis</a>
<ul class="sectlevel2">
<li><a href="#_sources_of_vulnerability_information">A.1. Sources of Vulnerability Information</a>
<ul class="sectlevel3">
<li><a href="#Type1Hypotheses">A.1.1. Type 1 Hypotheses - Public-Vulnerability-based</a></li>
<li><a href="#Type2Hypotheses">A.1.2. Type 2 Hypotheses - iTC-sourced</a></li>
<li><a href="#Type3Hypotheses">A.1.3. Type 3 Hypotheses - Evaluation-Team-Generated</a></li>
<li><a href="#Type4Hypotheses">A.1.4. Type 4 Hypotheses - Tool-Generated</a></li>
</ul>
</li>
<li><a href="#_process_for_evaluator_vulnerability_analysis">A.2. Process for Evaluator Vulnerability Analysis</a></li>
<li><a href="#_reporting">A.3. Reporting</a></li>
</ul>
</li>
<li><a href="#_equivalency_considerations">Appendix B: Equivalency Considerations</a>
<ul class="sectlevel2">
<li><a href="#_introduction_2">B.1. Introduction</a></li>
<li><a href="#_evaluator_guidance_for_determining_equivalence">B.2. Evaluator guidance for determining equivalence</a>
<ul class="sectlevel3">
<li><a href="#_strategy">B.2.1. Strategy</a></li>
<li><a href="#_guidance_for_hardcopy_devices">B.2.2. Guidance for hardcopy devices</a></li>
<li><a href="#_test_presentationtruth_in_advertising">B.2.3. Test presentation/Truth in advertising</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_glossary">Appendix C: Glossary</a></li>
<li><a href="#_acronyms">Appendix D: Acronyms</a></li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_technology_area_and_scope_of_supporting_document">1.1. Technology Area and Scope of Supporting Document</h3>
<div class="paragraph">
<p>This Supporting Document (SD) defines the Evaluation Activities (EAs) associated
with the collaborative Protection Profile for Hardcopy Devices <a href="#HCDcPP">[HCDcPP]</a>.</p>
</div>
<div class="paragraph">
<p>This SD is mandatory for evaluations of products that claim conformance to any of the following cPP(s):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>collaborative Protection Profile for Hardcopy Devices, 1.1, 29 December 2025</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although EAs are defined mainly for the evaluator to follow, the definitions in this SD aim to provide a common understanding for developers, evaluators, certifiers/certification bodies, and users as to what aspects of the TOE are tested in an evaluation against the associated cPPs, and to what depth the testing is carried out. This common understanding in turn contributes to the goal of ensuring that evaluations against the cPP achieve comparable, transparent and repeatable results. In general, the definition of EAs will also help developers to prepare for evaluation by identifying specific requirements for their TOE. The specific requirements in EAs may in some cases clarify the meaning of SFRs, and may identify particular requirements for the content of Security Targets (STs) (especially the TOE Summary Specification (TSS)), Administrator Guidance Documentation (AGD), and possibly required supplementary information (e.g., for entropy analysis or cryptographic key management architecture - see <a href="#_required_supplementary_information">Chapter 7, <em>Required Supplementary Information</em></a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_structure_of_the_document">1.2. Structure of the Document</h3>
<div class="paragraph">
<p>EAs can be defined for both SFRs and SARs. These are defined in separate sections of this SD.</p>
</div>
<div class="paragraph">
<p>If any EA cannot be successfully completed in an evaluation then the overall verdict for the evaluation is a 'fail'.</p>
</div>
<div class="paragraph">
<p>In general, if all EAs (for both SFRs and SARs) are successfully completed in an evaluation then it would be expected that the overall verdict for the evaluation is a 'pass'. To reach a 'fail' verdict when the EAs have been successfully completed would require a specific justification from the evaluator as to why the EAs were not sufficient for that TOE.</p>
</div>
<div class="paragraph">
<p>Similarly, at the more granular level of Assurance Components, if the EAs for an Assurance Component and all of its related SFR EAs are successfully completed in an evaluation then it would be expected that the verdict for the Assurance Component is a 'pass'. To reach a 'fail' verdict for the Assurance Component when these EAs have been successfully completed would require a specific justification from the evaluator as to why the EAs were not sufficient for that TOE.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_evaluation_activities_for_sfrs">2. Evaluation Activities for SFRs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The EAs presented in this section capture the actions the evaluator performs to address technology specific aspects covering specific SARs (e.g.., ASE_TSS.1, ADV_FSP.1, AGD_OPE.1, and ATE_IND.1) - this is in addition to the CEM work units that are performed in Section 6 (Evaluation Activities for SARs).</p>
</div>
<div class="paragraph">
<p>Regarding design descriptions (designated by the subsections labelled TSS, as well as any required supplementary material that may be treated as proprietary), the evaluator must ensure there is specific information that satisfies the EA. For findings regarding the TSS section, the evaluators verdicts will be associated with the CEM work unit ASE_TSS.1-1. Evaluator verdicts associated with the supplementary evidence will also be associated with ASE_TSS.1-1, since the requirement to provide such evidence is specified in ASE in the cPP.</p>
</div>
<div class="paragraph">
<p>For ensuring the guidance documentation provides sufficient information for the administrators/users as it pertains to SFRs, the evaluators verdicts will be associated with CEM work units ADV_FSP.1-7, AGD_OPE.1-4, and AGD_OPE.1-5.</p>
</div>
<div class="paragraph">
<p>Finally, the subsection labelled Tests is where the iTC has determined that testing of the product in the context of the associated SFR is necessary. The CEM work units that are associated with the EAs specified in this section are: ATE_IND.1-3, ATE_IND.1-4, ATE_IND.1-5, ATE_IND.1-6, and ATE_IND.1-7.</p>
</div>
<div class="sect2">
<h3 id="_security_audit_fau">2.1. Security Audit (FAU)</h3>
<div class="sect3">
<h4 id="_fau_gen_1_audit_data_generation">2.1.1. FAU_GEN.1 Audit data generation</h4>
<div class="sect4">
<h5 id="_tss">2.1.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check the TOE Summary Specification (TSS) to ensure that auditable events and its recorded information are consistent with the definition of the SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation">2.1.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check the guidance documents to ensure that auditable events and its recorded information are consistent with the definition of the SFRs.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests">2.1.1.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the audit record of each of the auditable events described in Table 3 of <a href="#HCDcPP">[HCDcPP]</a> is appropriately generated.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check a representative sample of methods for generating auditable events, if there are multiple methods.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check that FIA_UAU.1 events have been generated for each mechanism, if there are several different I&amp;A mechanisms.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fau_gen_2_user_identity_association">2.1.2. FAU_GEN.2 User identity association</h4>
<div class="paragraph">
<p>The EAs for FAU_GEN.1 address this SFR.</p>
</div>
</div>
<div class="sect3">
<h4 id="_fau_sar_1_audit_review">2.1.3. FAU_SAR.1 Audit review</h4>
<div class="sect4">
<h5 id="_tss_2">2.1.3.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS describes that audit records can be read only by an Administrator and that the TSS describes the functions used to read audit records.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of the methods of using interfaces that retrieve audit records (e.g., methods for user identification and authentication, authorization, and retrieving audit records).</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_2">2.1.3.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the operational guidance appropriately describes the methods and formats by which audit records can be read.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_2">2.1.3.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall check to ensure that the forms of audit records are provided as specified in the operational guidance by retrieving audit records in accordance with the operational guidance.</p>
</li>
<li>
<p>The evaluator shall check to ensure that no users other than an Administrator can retrieve audit records.</p>
</li>
<li>
<p>The evaluator shall check to ensure that all audit records are retrieved by the operation of retrieving audit records.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fau_sar_2_restricted_audit_review">2.1.4. FAU_SAR.2 Restricted audit review</h4>
<div class="sect4">
<h5 id="_tests_3">2.1.4.1. Tests</h5>
<div class="paragraph">
<p>The evaluator shall include test 2 related to this function in the set of tests performed in FAU_SAR.1.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fau_stg_1_audit_data_storage_location">2.1.5. FAU_STG.1 Audit data storage location</h4>
<div class="sect4">
<h5 id="_tss_3">2.1.5.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to ensure it describes the means by which the audit data are transferred to the external audit server, and how the trusted channel is provided.</p>
</div>
<div class="paragraph">
<p>The evaluator shall examine the TSS to ensure it describes the amount of audit data that are stored locally; what happens when the local audit data store is full; and how these records are protected against unauthorized access.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_3">2.1.5.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall also examine the operational guidance to determine that it describes the relationship between the local audit data and the audit data that are sent to the audit log server. For example, when an audit event is generated, is it simultaneously sent to the external server and the local store, or is the local store used as a buffer and cleared periodically by sending the data to the audit server.</p>
</div>
<div class="paragraph">
<p>The evaluator shall also examine the operational guidance to ensure it describes how to establish the trusted channel to the audit server, as well as describe any requirements on the audit server (particular audit server protocol, version of the protocol required, etc.), as well as configuration of the TOE needed to communicate with the audit server.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_4">2.1.5.3. Tests</h5>
<div class="paragraph">
<p>Testing of the trusted channel mechanism will be performed as specified in the associated assurance activities for the particular trusted channel mechanism. The evaluator shall perform the following test for this requirement:</p>
</div>
<div class="paragraph">
<p>Test 1: The evaluator shall establish a session between the TOE and the audit server according to the configuration guidance provided. The evaluator shall then examine the traffic that passes between the audit server and the TOE during several activities of the evaluators choice designed to generate audit data to be transferred to the audit server. The evaluator shall observe that these data are not able to be viewed in the clear during this transfer, and that they are successfully received by the audit server. The evaluator shall record the particular software (name, version) used on the audit server during testing. The evaluator shall verify that the TOE is capable of transferring audit data to an external audit server automatically without administrator intervention.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fau_stg_2_protected_audit_trail_storage">2.1.6. FAU_STG.2 Protected audit trail storage</h4>
<div class="sect4">
<h5 id="_tss_4">2.1.6.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of the means of preventing audit records from unauthorized access (modification, deletion).</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_4">2.1.6.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS and operational guidance contain descriptions of the interfaces to access to audit records, and if the descriptions of the means of preventing audit records from unauthorized access (modification, deletion) are consistent.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_5">2.1.6.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following test:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall test that an authorized user can access the audit records.</p>
</li>
<li>
<p>The evaluator shall test that a user without authorization for the audit data cannot access the audit records.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fau_stg_5_prevention_of_audit_data_loss">2.1.7. FAU_STG.5 Prevention of audit data loss</h4>
<div class="sect4">
<h5 id="_tss_5">2.1.7.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of the processing performed when the capacity of audit records becomes full, which is consistent with the definition of the SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_5">2.1.7.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the operational guidance contains a description of the processing performed (such as informing the authorized users) when the capacity of audit records becomes full.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_6">2.1.7.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator generates auditable events after the capacity of audit records becomes full by generating auditable events in accordance with the operational guidance.</p>
</li>
<li>
<p>The evaluator shall check to ensure that audit records are processed in accordance with the definition of the SFR.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cryptographic_support_fcs">2.2. Cryptographic Support (FCS)</h3>
<div class="sect3">
<h4 id="_fcs_ckm_1skg_cryptographic_key_generation_symmetric_keys">2.2.1. FCS_CKM.1/SKG Cryptographic key generation (Symmetric Keys)</h4>
<div class="sect4">
<h5 id="_tss_6">2.2.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall review the TSS to determine that it describes how the functionality described by FCS_RBG_EXT.1 is invoked and how the TOE obtains a symmetric key through direct generation from a random bit generator as specified in FCS_RBG_EXT.1 or by combining one or more keys and other data.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kmd">2.2.1.2. KMD</h5>
<div class="paragraph">
<p>If the TOE is relying on random number generation from a third-party source, the KMD needs to describe the function call and parameters used when calling the third-party DRBG function.  Also, the KMD needs to include a short description of the vendor&#8217;s assumption for the amount of entropy seeding the third-party DRBG. The evaluator uses the description of the RBG functionality in FCS_RBG_EXT or the KMD to determine that the key size being requested is identical to the key size and mode to be used for the encryption/decryption of the user data (FCS_COP.1/StorageEncryption).</p>
</div>
<div class="paragraph">
<p>If the TOE uses the generated key in a key chain/hierarchy, then the evaluator shall examine the KMD to confirm that it describes how the key is used as part of the key chain/hierarchy.</p>
</div>
<div class="paragraph">
<p>The KMD is described in Appendix F of <a href="#HCDcPP">[HCDcPP]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_6">2.2.1.3. Guidance Documentation</h5>
<div class="paragraph">
<p>If the TOE provides interfaces to configure the cryptographic key generation functionality to the authorized role, then the evaluator shall examine the operational user guidance to determine that it describes advice regarding effective use of selected cryptographic key length and relative cryptographic algorithms.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_7">2.2.1.4. Tests</h5>
<div class="paragraph">
<p>The evaluator shall include test cases of FCS_CKM.1/SKG to the test subset. Note that FCS_CKM.1/SKG may be not mapped to the specific interface(s) after evaluators analysis during ADV_FSP.1.</p>
</div>
<div class="paragraph">
<p>The evaluator shall produce test documentation for test cases of FCS_CKM.1/SKG. If there is no explicit external interface(s) mapped to FCS_CKM.1/SKG, the evaluator shall employ an alternative test approach (refer to CEM, section 15.2.2.)</p>
</div>
<div class="paragraph">
<p>For each selected key size, the evaluator shall configure the symmetric key generation capability. The evaluator shall use the description of the RBG interface to verify that the TOE requests and receives an amount of RBG output greater than or equal to the requested key size.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_ckm_2_cryptographic_key_establishment">2.2.2. FCS_CKM.2 Cryptographic Key Establishment</h4>
<div class="sect4">
<h5 id="_tss_7">2.2.2.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall ensure that the supported key establishment schemes
correspond to the key generation schemes identified in FCS_CKM.1.1/AKG. If the
ST specifies more than one scheme, the evaluator shall examine the TSS to
verify that it identifies the usage for each scheme. It is sufficient to provide the
scheme, SFR, and service in the TSS.</p>
</div>
<div class="paragraph">
<p>If Diffie-Hellman group 14 is selected from FCS_CKM.2.1, the TSS shall
claim the TOE meets RFC 3526 Section 3.</p>
</div>
<div class="paragraph">
<p>The intent of this activity is to be able to identify the scheme being used by
each service. This would mean, for example, one way to document scheme
usage could be:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Scheme</th>
<th class="tableblock halign-left valign-top">SFR</th>
<th class="tableblock halign-left valign-top">Service</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSS_EXT.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Administration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ECDH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_SSHC_EXT.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit Server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Diffie-Hellman (Group 14)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_SSHC_EXT.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backup Server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ECDH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_IPSEC_EXT.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication Server</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The information provided in the example above does not necessarily have to
be included as a table but can be presented in other ways as long as the
necessary data is available.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_7">2.2.2.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall verify that the AGD guidance instructs the administrator
how to configure the TOE to use the selected key establishment scheme(s).</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_8">2.2.2.3. Tests</h5>
<div class="paragraph">
<p><strong>Key Establishment Schemes</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the implementation of the key establishment
schemes of the supported by the TOE using the applicable tests below.</p>
</div>
<div class="paragraph">
<p><strong><em>SP800-56A Key Establishment Schemes</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall verify a TOE&#8217;s implementation of SP800-56A key
agreement schemes using the following Function and Validity tests. These
validation tests for each key agreement scheme verify that a TOE has
implemented the components of the key agreement scheme according to the
specifications in the Recommendation. These components include the
calculation of the DLC primitives (the shared secret value Z) and the
calculation of the derived keying material (DKM) via the Key Derivation
Function (KDF). If key confirmation is supported, the evaluator shall also
verify that the components of key confirmation have been implemented
correctly, using the test procedures described below. This includes the parsing
of the DKM, the generation of MACdata and the calculation of MACtag.</p>
</div>
<div class="paragraph">
<p><em>Function Test</em></p>
</div>
<div class="paragraph">
<p>The Function test verifies the ability of the TOE to implement the key
agreement schemes correctly. To conduct this test the evaluator shall generate
or obtain test vectors from a known good implementation of the TOE
supported schemes. For each supported key agreement scheme-key agreement role combination, KDF type, and, if supported, key confirmation role- key confirmation type combination, the tester shall generate 10 sets of test vectors. The data set consists of one set of domain parameter values (FFC) or the NIST
approved curve (ECC) per 10 sets of public keys. These keys are static,
ephemeral or both depending on the scheme being tested.</p>
</div>
<div class="paragraph">
<p>The evaluator shall obtain the DKM, the corresponding TOEs public keys
(static and/or ephemeral), the MAC tag(s), and any inputs used in the KDF,
such as the Other Information field OI and TOE id fields.</p>
</div>
<div class="paragraph">
<p>If the TOE does not use a KDF defined in SP800-56A, the evaluator shall
obtain only the public keys and the hashed value of the shared secret.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the correctness of the TSFs implementation of a
given scheme by using a known good implementation to calculate the shared
secret value, derive the keying material DKM, and compare hashes or MAC
tags generated from these values.</p>
</div>
<div class="paragraph">
<p>If key confirmation is supported, the TSF shall perform the above for each
implemented approved MAC algorithm.</p>
</div>
<div class="paragraph">
<p><em>Validity Test</em></p>
</div>
<div class="paragraph">
<p>The Validity test verifies the ability of the TOE to recognize another partys
valid and invalid key agreement results with or without key confirmation. To
conduct this test, the evaluator shall obtain a list of the supporting
cryptographic functions included in the SP800-56A key agreement
implementation to determine which errors the TOE should be able to
recognize. The evaluator generates a set of 24 (FFC) or 30 (ECC) test vectors
consisting of data sets including domain parameter values or NIST approved
curves, the evaluators public keys, the TOEs public/private key pairs,
MACTag, and any inputs used in the KDF, such as the other info and TOE id
fields.</p>
</div>
<div class="paragraph">
<p>The evaluator shall inject an error in some of the test vectors to test that the
TOE recognizes invalid key agreement results caused by the following fields
being incorrect: the shared secret value Z, the DKM, the other information
field OI, the data to be MACed, or the generated MACTag. If the TOE
contains the full or partial (only ECC) public key validation, the evaluator will
also individually inject errors in both parties static public keys, both parties
ephemeral public keys and the TOEs static private key to assure the TOE
detects errors in the public key validation function and/or the partial key
validation function (in ECC only). At least two of the test vectors shall remain
unmodified and therefore should result in valid key agreement results (they
should pass).</p>
</div>
<div class="paragraph">
<p>The TOE shall use these modified test vectors to emulate the key agreement
scheme using the corresponding parameters. The evaluator shall compare the
TOEs results with the results using a known good implementation verifying
that the TOE detects these errors.</p>
</div>
<div class="paragraph">
<p><strong><em>RSA-based key establishment</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the correctness of the TSFs implementation of
RSAES-PKCS1-v1_5 by using a known good implementation for each
protocol selected in FTP_TRP.1/Admin, FTP_TRP.1/NonAdmin and FTP_ITC.1 that uses RSAES-PKCS1-v1_5.</p>
</div>
<div class="paragraph">
<p><strong><em>Diffie-Hellman Group 14</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the correctness of the TSFs implementation of
Diffie-Hellman group 14 by using a known good implementation for each
protocol selected in FTP_TRP.1/Admin, FTP_TRP.1/NonAdmin and FTP_ITC.1 that uses Diffie-Hellman group 14.
FFC Schemes using safe-prime groups</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the correctness of the TSFs implementation of safeprime
groups by using a known good implementation for each protocol
selected in FTP_TRP.1/Admin, FTP_TRP.1/NonAdmin and FTP_ITC.1 that uses safe-prime groups. This test must be performed for each safe-prime
group that each protocol uses.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_ckm_6_timing_and_event_of_cryptographic_key_destruction">2.2.3. FCS_CKM.6 Timing and event of cryptographic key destruction</h4>
<div class="sect4">
<h5 id="_tss_8">2.2.3.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall verify the TSS provides a high level description of what keys and key material are destroyed, under what conditions they are destroyed, and how they are destroyed.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure the TSS lists each type of key that is stored in nonvolatile memory, and identifies how the TOE interacts with the underlying platform to manage keys (e.g., store, retrieve, destroy). The description includes details on the method of how the TOE interacts with the platform, including an identification and description of the interfaces it uses to manage keys (e.g., file system APIs, platform key store APIs).</p>
</div>
<div class="paragraph">
<p>If the ST makes use of the open assignment and fills in the type of pattern that is used, the evaluator examines the TSS to ensure it describes how that pattern is obtained and used. The evaluator shall verify that the pattern does not contain any CSPs.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check that the TSS identifies any configurations or circumstances that may not strictly conform to the key destruction requirement.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kmd_2">2.2.3.2. KMD</h5>
<div class="paragraph">
<p>The evaluator shall verify the Key Management Description (KMD) includes a key lifecycle that describes the purpose of the key and how it is used, where the keys and key material reside (i.e. volatile or nonvolatile storage), how each identified key is introduced into storage (e.g., by derivation from user input, or by unwrapping a wrapped key stored in nonvolatile storage), how it is determined that keys and key material are no longer needed, and how the material is destroyed once it is not needed and that the documentation in the KMD follows FCS_CKM.6 for the destruction.</p>
</div>
<div class="paragraph">
<p>The KMD identifies and describes the interface(s) that are used to service commands to read/write memory/storage. The evaluator examines the interface description for each different media type to ensure that the interface supports the selection(s) made by the ST Author.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_8">2.2.3.3. Guidance Documentation</h5>
<div class="paragraph">
<p>There are a variety of concerns that may prevent or delay key destruction in some cases. The evaluator shall check that the guidance documentation identifies configurations or circumstances that may not strictly conform to the key destruction requirement, and that this description is consistent with the relevant parts of the TSS and any other relevant Required Supplementary Information. The evaluator shall check that the guidance documentation provides guidance on situations where key destruction may be delayed at the physical layer and how such situations can be avoided or mitigated if possible.</p>
</div>
<div class="paragraph">
<p>Some examples of what is expected to be in the documentation are provided here.</p>
</div>
<div class="paragraph">
<p>When the TOE does not have full access to the physical memory, it is possible that the storage may be implementing wear-leveling and garbage collection. This may create additional copies of the key that are logically inaccessible but persist physically. In this case, to mitigate this the drive should support the TRIM command and implements garbage collection to destroy these persistent copies when not actively engaged in other tasks.</p>
</div>
<div class="paragraph">
<p>Drive vendors implement garbage collection in a variety of different ways, as such there is a variable amount of time until data is truly removed from these solutions. There is a risk that data may persist for a longer amount of time if it is contained in a block with other data not ready for erasure. To reduce this risk, the operating system and file system of the TOE should support TRIM, instructing the nonvolatile memory to erase copies via garbage collection upon their deletion. If a RAID array is being used, only set-ups that support TRIM are utilized. If the drive is connected via PCI-Express, the operating system supports TRIM over that channel.</p>
</div>
<div class="paragraph">
<p>The drive should be healthy and contains minimal corrupted data and should be end-of-lifed before a significant amount of damage to drive health occurs, this minimizes the risk that small amounts of potentially recoverable data may remain in damaged areas of the drive.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_9">2.2.3.4. Tests</h5>
<div class="paragraph">
<p>For these tests the evaluator shall utilize appropriate development environment (e.g., a Virtual Machine) and development tools (debuggers, simulators, etc.) to test that keys are cleared, including all copies of the key that may have been created internally by the TOE during normal cryptographic processing with that key.</p>
</div>
<div class="paragraph">
<p>Test 1 [conditional]: Applied to each key held as in volatile memory and subject to destruction by overwrite by the TOE (whether or not the value is subsequently encrypted for storage in volatile or nonvolatile memory). In the case where the only selection made for the key destruction method was removal of power, destruction of reference to the key directly followed by a request for garbage collection, or memory management, then this test is unnecessary. The evaluator shall:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Record the value of the key in the TOE subject to clearing.</p>
</li>
<li>
<p>Cause the TOE to perform a normal cryptographic processing with the key from Step #1.</p>
</li>
<li>
<p>Cause the TOE to clear the key.</p>
</li>
<li>
<p>Cause the TOE to stop the execution but not exit.</p>
</li>
<li>
<p>Cause the TOE to dump the entire memory of the TOE into a binary file.</p>
</li>
<li>
<p>Search the content of the binary file created in Step #5 for instances of the known key value from Step #1.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Steps 1-6 ensure that the complete key does not exist anywhere in volatile memory. If a copy is found, then the test fails.</p>
</div>
<div class="paragraph">
<p>Test 2: Applied to each key held in nonvolatile memory and subject to destruction by the TOE, except  for replacing a key using the selection [a new value of a key of the same size]. The evaluator shall use special tools (as needed), provided by the TOE developer if necessary, to ensure the tests function as intended.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Identify the purpose of the key and what access should fail when it is deleted. (e.g., the data encryption key being deleted would cause data decryption to fail.)</p>
</li>
<li>
<p>Cause the TOE to clear the key.</p>
</li>
<li>
<p>Have the TOE attempt the functionality that the cleared key would be necessary for. The test succeeds if step 3 fails.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Test 3: Applied to each key held in nonvolatile memory and subject to destruction by overwrite by the TOE. The evaluator shall use special tools (as needed), provided by the TOE developer if necessary, to view the key storage location:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Record the value of the key in the TOE subject to clearing.</p>
</li>
<li>
<p>Cause the TOE to perform a normal cryptographic processing with the key from Step #1.</p>
</li>
<li>
<p>Cause the TOE to clear the key.</p>
</li>
<li>
<p>Search the nonvolatile memory the key was stored in for instances of the known key value from Step #1. If a copy is found, then the test fails.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Test 4: Applied to each key held in nonvolatile memory and subject to destruction by overwrite by the TOE. The evaluator shall use special tools (as needed), provided by the TOE developer if necessary, to view the key storage location:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Record the storage location of the key in the TOE subject to clearing.</p>
</li>
<li>
<p>Cause the TOE to perform a normal cryptographic processing with the key from Step #1.</p>
</li>
<li>
<p>Cause the TOE to clear the key.</p>
</li>
<li>
<p>Search the storage location in Step #1 of nonvolatile memory to ensure the appropriate pattern is utilized.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The test succeeds if correct pattern is used to overwrite the key in the memory location. If the pattern is not found the test fails.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_cop_1dataencryption_cryptographic_operation_data_encryptiondecryption">2.2.4. FCS_COP.1/DataEncryption Cryptographic Operation (Data Encryption/Decryption)</h4>
<div class="sect4">
<h5 id="_tss_9">2.2.4.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to ensure it identifies the key size(s) and
mode(s) supported by the TOE for data encryption/decryption.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_9">2.2.4.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall verify that the AGD guidance instructs the administrator
how to configure the TOE to use the selected mode(s) and key size(s) defined
in the Security Target supported by the TOE for data encryption/decryption.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_10">2.2.4.3. Tests</h5>
<div class="paragraph">
<p>Note: Testing of cryptographic functions implemented in the Root of Trust for Secure Boot (FPT_SBT_EXT.1) may not be feasible and independent testing may not be available. In this situation, contact the CC Scheme.</p>
</div>
<div class="paragraph">
<p><strong>AES-CBC Known Answer Tests</strong></p>
</div>
<div class="paragraph">
<p>There are four Known Answer Tests (KATs), described below. In all KATs,
the plaintext, ciphertext, and IV values shall be 128-bit blocks. The results
from each test may either be obtained by the evaluator directly or by supplying
the inputs to the implementer and receiving the results in response. To
determine correctness, the evaluator shall compare the resulting values to
those obtained by submitting the same inputs to a known good
implementation.</p>
</div>
<div class="paragraph">
<p><span class="underline">KAT-1 (GFSBox):</span> To test the encrypt functionality of AES-CBC, the evaluator
shall supply a set of five different plaintext values for each selected key size and
obtain the ciphertext value that results from AES-CBC encryption of the given
plaintext using a key value of all zeros and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of AES-CBC, the evaluator shall supply a set of
five different ciphertext values for each selected key size and obtain the plaintext
value that results from AES-CBC decryption of the given ciphertext using a key
value of all zeros and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p><span class="underline">KAT-2 (KeySBox):</span> To test the encrypt functionality of AES-CBC, the evaluator
shall supply a set of five different key values for each selected key size and obtain
the ciphertext value that results from AES-CBC encryption of an all-zeros plaintext
using the given key value and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of AES-CBC, the evaluator shall supply a set of
five different key values for each selected key size and obtain the plaintext that
results from AES-CBC decryption of an all-zeros ciphertext using the given key
and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p><span class="underline">KAT-3 (Variable Key):</span> To test the encrypt functionality of AES-CBC, the evaluator
shall supply a set of keys for each selected key size (as described below) and obtain
the ciphertext value that results from AES encryption of an all-zeros plaintext using
each key and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p>Key i in each set shall have the leftmost i bits set to ones and the remaining bits to
zeros, for values of i from 1 to the key size. The keys and corresponding ciphertext
are listed in AESAVS, Appendix E.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of AES-CBC, the evaluator shall use the same keys
as above to decrypt the ciphertext results from above. Each decryption should result
in an all-zeros plaintext.</p>
</div>
<div class="paragraph">
<p><span class="underline">KAT-4 (Variable Text):</span> To test the encrypt functionality of AES-CBC, for each
selected key size, the evaluator shall supply a set of 128-bit plaintext values (as
described below) and obtain the ciphertext values that result from AES-CBC
encryption of each plaintext value using a key of each size and IV consisting of all
zeros.</p>
</div>
<div class="paragraph">
<p>Plaintext value i shall have the leftmost i bits set to ones and the remaining bits set
to zeros, for values of i from 1 to 128. The plaintext values are listed in AESAVS,
Appendix D.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of AES-CBC, for each selected key size, use the
plaintext values from above as ciphertext input, and AES-CBC decrypt each
ciphertext value using key of each size consisting of all zeros and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p><strong>AES-CBC Multi-Block Message Test</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality by encrypting an <em>i</em>-block
message where 1 &lt; <em>i</em> &lt;=10. The evaluator shall choose a key, an IV and
plaintext message of length <em>i</em> blocks and encrypt the message, using the mode
to be tested, with the chosen key and IV. The ciphertext shall be compared to
the result of encrypting the same plaintext message with the same key and IV
using a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall also test the decrypt functionality for each mode by
decrypting an <em>i</em>-block message where 1 &lt; <em>i</em> &lt;=10. The evaluator shall choose a
key, an IV and a ciphertext message of length <em>i</em> blocks and decrypt the
message, using the mode to be tested, with the chosen key and IV. The
plaintext shall be compared to the result of decrypting the same ciphertext
message with the same key and IV using a known good implementation.</p>
</div>
<div class="paragraph">
<p><strong>AES-CBC Monte Carlo Tests</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality for each selected key size using
100 3-tuples of pseudo-random values for plaintext, IVs, and keys.</p>
</div>
<div class="paragraph">
<p>The evaluator shall supply a single 3-tuple of pseudo-random values for each
selected key size. This 3-tuple of plaintext, IV, and key is provided as input to the
below algorithm to generate the remaining 99 3-tuples, and to run each 3-tuple
through 1000 iterations of AES-CBC encryption.</p>
</div>
<div class="literalblock">
<div class="content">
<pre># Input: PT, IV, Key
Key[0] = Key
IV[0] = IV
PT[0] = PT
for i = 0 to 99 {
    Output Key[i], IV[i], PT[0]
    for j = 0 to 999 {
        if (j == 0) {
            CT[j] = AES-CBC-Encrypt(Key[i], IV[i], PT[j])
            PT[j+1] = IV[i]
        } else {
            CT[j] = AES-CBC-Encrypt(Key[i], PT[j])
            PT[j+1] = CT[j-1]
        }
    }
    Output CT[j]
    If (KeySize == 128) Key[i+1] = Key[i] xor CT[j]
    If (KeySize == 192) Key[i+1] = Key[i] xor (last 64 bits of CT[j-1] || CT[j])
    If (KeySize == 256) Key[i+1] = Key[i] xor ((CT[j-1] | CT[j])
    IV[i+1] = CT[j]
    PT[0] = CT[j-1]
}</pre>
</div>
</div>
<div class="paragraph">
<p>The ciphertext computed in the 1000th iteration (CT[999]) is the result for each of
the 100 3-tuples for each selected key size. This result shall be compared to the
result of running 1000 iterations with the same values using a known good
implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality using the same test as above,
exchanging CT and PT, and replacing AES-CBC-Encrypt with AES-CBC-Decrypt.</p>
</div>
<div class="paragraph">
<p><strong>AES-GCM Test</strong></p>
</div>
<div class="paragraph">
<p>These tests are intended to be equivalent to those described in the NIST document,
The Galois/Counter Mode (GCM) and GMAC Validation System (GCMVS) with
the Addition of XPN Validation Testing, rev. 15 Jun 2016, section 6.2, found at
<a href="http://csrc.nist.gov/groups/STM/cavp/documents/mac/gcmvs.pdf" class="bare">http://csrc.nist.gov/groups/STM/cavp/documents/mac/gcmvs.pdf</a>.</p>
</div>
<div class="paragraph">
<p>It is not recommended that evaluators use values obtained from static sources such
as <a href="http://csrc.nist.gov/groups/STM/cavp/documents/mac/gcmtestvectors.zip" class="bare">http://csrc.nist.gov/groups/STM/cavp/documents/mac/gcmtestvectors.zip</a>, or use
values not generated expressly to exercise the AES-GCM implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the authenticated encryption functionality of AES-GCM by
supplying 15 sets of Key, Plaintext, AAD, IV, and Tag data for every combination
of the following parameters as selected in the ST and supported by the
implementation under test:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Key size in bits:</strong> Each selected and supported key size (e.g., 128, 192, or
256 bits).</p>
</li>
<li>
<p><strong>Plaintext length in bits:</strong> Up to four values for plaintext length: Two values
that are non-zero integer multiples of 128, if supported. And two values that
are non-multiples of 128, if supported.</p>
</li>
<li>
<p><strong>AAD length in bits:</strong> Up to five values for AAD length: Zero-length, if
supported. Two values that are non-zero integer multiples of 128, if
supported. And two values that are integer non-multiples of 128, if
supported.</p>
</li>
<li>
<p><strong>IV length in bits:</strong> Up to three values for IV length: 96 bits. Minimum and
maximum supported lengths, if different.</p>
</li>
<li>
<p><strong>MAC length in bits:</strong> Each supported length (e.g., 128, 120, 112, 104, 96).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To determine correctness, the evaluator shall compare the resulting values to those
obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the authenticated decrypt functionality of AES-GCM by
supplying 15 Ciphertext-Tag pairs for every combination of the above parameters,
replacing Plaintext length with Ciphertext length. For each parameter combination
the evaluator shall introduce an error into either the Ciphertext or the Tag such that
approximately half of the cases are correct and half the cases contain errors. To
determine correctness, the evaluator shall compare the resulting pass/fail status and
Plaintext values to the results obtained by submitting the same inputs to a knowngood
implementation.</p>
</div>
<div class="paragraph">
<p><strong>AES-CTR Known Answer Tests</strong></p>
</div>
<div class="paragraph">
<p>The Counter (CTR) mode is a confidentiality mode that features the
application of the forward cipher to a set of input blocks, called counters, to
produce a sequence of output blocks that are exclusive-ORed with the
plaintext to produce the ciphertext, and vice versa. Since the Counter Mode
does not specify the counter that is used, it is not possible to implement an
automated test for this mode. The generation and management of the counter
is tested through FCS_SSH*_EXT.1.4. If CBC and/or GCM are selected in
FCS_COP.1/DataEncryption, the test activities for those modes sufficiently
demonstrate the correctness of the AES algorithm. If CTR is the only selection
in FCS_COP.1/DataEncryption, the AES-CBC Known Answer Test, AES-GCM
Known Answer Test, or the following test shall be performed (all of
these tests demonstrate the correctness of the AES algorithm):</p>
</div>
<div class="paragraph">
<p>There are four Known Answer Tests (KATs) described below to test a basic
AES encryption operation (AES-ECB mode). For all KATs, the plaintext, IV,
and ciphertext values shall be 128-bit blocks. The results from each test may
either be obtained by the validator directly or by supplying the inputs to the
implementer and receiving the results in response. To determine correctness,
the evaluator shall compare the resulting values to those obtained by
submitting the same inputs to a known good implementation.</p>
</div>
<div class="paragraph">
<p>KAT-1 To test the encrypt functionality, the evaluator shall supply a set of 5
plaintext values for each selected keysize and obtain the ciphertext value that
results from encryption of the given plaintext using a key value of all zeros.</p>
</div>
<div class="paragraph">
<p>KAT-2 To test the encrypt functionality, the evaluator shall supply a set of 5
key values for each selected keysize and obtain the ciphertext value that results
from encryption of an all zeros plaintext using the given key value.</p>
</div>
<div class="paragraph">
<p>KAT-3 To test the encrypt functionality, the evaluator shall supply a set of key
values for each selected keysize as described below and obtain the ciphertext
values that result from AES encryption of an all zeros plaintext using the given
key values. A set of 128 128-bit keys, a set of 192 192-bit keys, and/or a set
of 256 256-bit keys. Key_i in each set shall have the leftmost i bits be ones
and the rightmost N-i bits be zeros, for i in [1, N].</p>
</div>
<div class="paragraph">
<p>KAT-4 To test the encrypt functionality, the evaluator shall supply the set of
128 plaintext values described below and obtain the ciphertext values that
result from encryption of the given plaintext using each selected keysize with a key value of all zeros (e.g. 256 ciphertext values will be generated if 128 bits
and 256 bits are selected and 384 ciphertext values will be generated if all
keysizes are selected). Plaintext value i in each set shall have the leftmost bits
be ones and the rightmost 128-i bits be zeros, for i in [1, 128].</p>
</div>
<div class="paragraph">
<p><strong>AES-CTR Multi-Block Message Test</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality by encrypting an i-block
message where 1 less-than i less-than-or-equal to 10 (test shall be performed
using AES-ECB mode). For each i the evaluator shall choose a key and
plaintext message of length i blocks and encrypt the message, using the mode
to be tested, with the chosen key. The ciphertext shall be compared to the result
of encrypting the same plaintext message with the same key using a known
good implementation. The evaluator shall perform this test using each selected
keysize.</p>
</div>
<div class="paragraph">
<p><strong>AES-CTR Monte-Carlo Test</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality using 100 plaintext/key pairs.
The plaintext values shall be 128-bit blocks. For each pair, 1000 iterations
shall be run as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    # Input: PT, Key
    for i = 1 to 1000:
    CT[i] = AES-ECB-Encrypt(Key, PT) PT = CT[i]</pre>
</div>
</div>
<div class="paragraph">
<p>The ciphertext computed in the 1000th iteration is the result for that trial. This
result shall be compared to the result of running 1000 iterations with the same
values using a known good implementation. The evaluator ciphertext computed in the 1000th iteration is the result for that trial. This
result shall be compared to the result of running 1000 iterations with the same
values using a known good implementation. The evaluator shall perform this
test using each selected keysize.</p>
</div>
<div class="paragraph">
<p>There is no need to test the decryption engine.</p>
</div>
<div class="paragraph">
<p><strong>SEED-CBC Tests</strong></p>
</div>
<div class="paragraph">
<p>For the SEED-CBC tests described below, the plaintext, ciphertext, and IV values shall consist of 128-bit blocks. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>SEED-CBC Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p><strong>KAT-1 (Variable Key):</strong> To test the encrypt functionality of SEED-CBC, the evaluator shall supply a set of 128-bit keys (as described below) and obtain the ciphertext value that results from SEED encryption of an all-zeros plaintext using each key and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p>Key i in each set shall have the leftmost i bits set to ones and the remaining bits to zeros, for values of i from 1 to 128.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of SEED-CBC, the evaluator shall use the same keys as above to decrypt the ciphertext results from above. Each decryption should result in an all-zeros plaintext.</p>
</div>
<div class="paragraph">
<p><strong>KAT-2 (Variable Text):</strong> To test the encrypt functionality of SEED-CBC, the evaluator shall supply a set of 128-bit plaintext values (as described below) and obtain the ciphertext values that result from SEED-CBC encryption of each plaintext value using a 128-bits key and IV consisting of all zeros.</p>
</div>
<div class="paragraph">
<p>Plaintext value i shall have the leftmost i bits set to ones and the remaining bits set to zeros, for values of i from 1 to 128.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of SEED-CBC, use the plaintext values from above as ciphertext input, and SEED-CBC decrypt each ciphertext value using a 128-bits key consisting of all zeros and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p><strong><em>SEED-CBC Multi-Block Message Tests</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality by encrypting nine i-block messages for a 128-bits key size, for 2  i  10. For each test, the evaluator shall supply a key, an IV, and a plaintext message of length i blocks, and encrypt the message using SEED-CBC. The resulting ciphertext values shall be compared to the results of encrypting the plaintext messages using a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality by decrypting nine i-block messages for a 128-bits key size, for 2  i  10. For each test, the evaluator shall supply a key, an IV, and a ciphertext message of length i blocks, and decrypt the message using SEED-CBC. The resulting plaintext values shall be compared to the results of decrypting the ciphertext messages using a known good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>SEED-CBC Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality for each selected key size using 100 3-tuples of pseudo-random values for plaintext, IVs, and keys.</p>
</div>
<div class="paragraph">
<p>The evaluator shall supply a single 3-tuple of pseudo-random values for 128-bits key. This 3-tuple of plaintext, IV, and key is provided as input to the below algorithm to generate the remaining 99 3-tuples, and to run each 3-tuple through 1000 iterations of SEED-CBC encryption.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Key[0] = Key, IV[0] = IV, PT[0] = PT
for i = 0 to 99  {
    Output Key[i], IV[i], PT[0]
    for j = 0 to 999 {
        if (j == 0) {
            CT[j] = SEED-CBC-Encrypt(Key[i], IV[i], PT[j])
            PT[j+1] = IV[i]
        } else {
            CT[j] = SEED-CBC-Encrypt(Key[i], PT[j])
            PT[j+1] = CT[j-1]
        }
    }
    Output CT[j]
    Key[i+1] = Key[i] xor CT[j]
    IV[i+1] = CT[j]
    PT[0] = CT[j-1]
}</pre>
</div>
</div>
<div class="paragraph">
<p>The ciphertext computed in the 1000th iteration (CT[999]) is the result for each of the 100 3-tuples for a 128-bits key. This result shall be compared to the result of running 1000 iterations with the same values using a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality using the same test as above, exchanging CT and PT, and replacing SEED-CBC-Encrypt with SEED-CBC-Decrypt.</p>
</div>
<div class="paragraph">
<p><strong>SEED-CFB Tests</strong></p>
</div>
<div class="paragraph">
<p>For the SEED-CFB tests described below, the plaintext, ciphertext, and IV values shall consist of 128-bit blocks. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>SEED-CFB Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p><strong>KAT-1 (Variable Key):</strong> To test the encrypt functionality of SEED-CFB, the evaluator shall supply a set of 128-bit keys(as described below) and obtain the ciphertext value that results from SEED encryption of an all-zeros plaintext using each key and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p>Key i in each set shall have the leftmost i bits set to ones and the remaining bits to zeros, for values of i from 1 to 128.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of SEED-CFB, the evaluator shall use the same keys as above to decrypt the ciphertext results from above. Each decryption should result in an all-zeros plaintext.</p>
</div>
<div class="paragraph">
<p><strong>KAT-2 (Variable Text):</strong> To test the encrypt functionality of SEED-CFB, the evaluator shall supply a set of 128-bit IV values (as described below) and obtain the ciphertext values that result from SEED-CFB encryption of a plaintext value consisting of all zeros using a 128-bits key and each IV.</p>
</div>
<div class="paragraph">
<p>IV value i shall have the leftmost i bits set to ones and the remaining bits set to zeros, for values of i from 1 to 128.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of SEED-CFB, use the IV values from above as ciphertext input, and SEED-CFB decrypt each ciphertext value using a 128-bits key consisting of all zeros and a plaintext value consisting of all zeros.</p>
</div>
<div class="paragraph">
<p><strong><em>SEED-CFB Multi-Block Message Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CBC Multi-Block Message Tests for the required SEED-CFB testing.</p>
</div>
<div class="paragraph">
<p><strong><em>SEED-CFB Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality for each selected key size using 100 3-tuples of pseudo-random values for plaintext, IVs, and keys.</p>
</div>
<div class="paragraph">
<p>The evaluator shall supply a single 3-tuple of pseudo-random values for 128-bits key. This 3-tuple of plaintext, IV, and key is provided as input to the below algorithm to generate the remaining 99 3-tuples, and to run each 3-tuple through 1000 iterations of SEED-CFB encryption.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Key[0] = Key, IV[0] = IV, PT[0] = PT
for i = 0 to 99  {
    Output Key[i], IV[i], PT[0]
    for j = 0 to 999 {
        if (j == 0) {
            CT[j] = PT[j] xor SEED-CFB-Encrypt(Key[i], IV[i])
            PT[j+1] = IV[i]
        } else {
            CT[j] = PT[j] xor SEED-CFB-Encrypt(Key[i], CT[j-1])
            PT[j+1] = CT[j-1]
        }
    }
    Output CT[j]
    Key[i+1] = Key[i] xor CT[j]
    IV[i+1] = CT[j]
    PT[0] = CT[j-1]
}</pre>
</div>
</div>
<div class="paragraph">
<p>The ciphertext computed in the 1000th iteration (CT[999]) is the result for each of the 100 3-tuples for a 128-bits key. This result shall be compared to the result of running 1000 iterations with the same values using a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality using the same test as above, exchanging CT and PT, and replacing SEED-CFB-Encrypt with SEED-CFB-Decrypt.</p>
</div>
<div class="paragraph">
<p><strong>SEED-OFB Tests</strong></p>
</div>
<div class="paragraph">
<p>For the SEED-OFB tests described below, the plaintext, ciphertext, and IV values shall consist of 128-bit blocks. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>SEED-OFB Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CFB Known Answer Tests for the required SEED-OFB testing.</p>
</div>
<div class="paragraph">
<p><strong><em>SEED-OFB Multi-Block Message Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CFB Multi-Block Message Tests for the required SEED-OFB testing.</p>
</div>
<div class="paragraph">
<p><strong><em>SEED-OFB Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality for each selected key size using 100 3-tuples of pseudo-random values for plaintext, IVs, and keys.</p>
</div>
<div class="paragraph">
<p>The evaluator shall supply a single 3-tuple of pseudo-random values for 128-bits key. This 3-tuple of plaintext, IV, and key is provided as input to the below algorithm to generate the remaining 99 3-tuples, and to run each 3-tuple through 1000 iterations of SEED-OFB encryption.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Key[0] = Key, IV[0] = IV, PT[0] = PT
for i = 0 to 99  {
    Output Key[i], IV[i], PT[0]
    for j = 0 to 999 {
        if (j == 0) {
            OT[j] = SEED-OFB-Encrypt(Key[i], IV[i])
            CT[j] = PT[j] xor OT[j]
            PT[j+1] = IV[i]
        } else {
            OT[j] = SEED-OFB-Encrypt(Key[i], OT[j-1])
            CT[j] = PT[j] xor OT[j]
            PT[j+1] = CT[j-1]
        }
    }
    Output CT[j]
    Key[i+1] = Key[i] xor CT[j]
    IV[i+1] = CT[j]
    PT[0] = CT[j-1]
}</pre>
</div>
</div>
<div class="paragraph">
<p>The ciphertext computed in the 1000th iteration (CT[999]) is the result for each of the 100 3-tuples for a 128-bits key. This result shall be compared to the result of running 1000 iterations with the same values using a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality using the same test as above, exchanging CT and PT, and replacing SEED-OFB-Encrypt with SEED-OFB-Decrypt.</p>
</div>
<div class="paragraph">
<p><strong>SEED-CTR Tests</strong></p>
</div>
<div class="paragraph">
<p>For the SEED-CTR tests described below, the plaintext, ciphertext, and counters shall consist of 128-bit blocks. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>SEED-CTR Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CFB Known Answer Tests for the required SEED-CTR testing. The evaluator shall test the encrypt functionality using the same test as SEED-CFB Tests, replacing IVs with counters.</p>
</div>
<div class="paragraph">
<p><strong><em>SEED-CTR Multi-Block Message Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CFB Multi-Block Message Tests for the required SEED-CTR testing. The evaluator shall test the encrypt functionality using the same test as SEED-CFB Tests, replacing IVs with counters.</p>
</div>
<div class="paragraph">
<p><strong><em>SEED-CTR Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality for each selected key size using 100 3-tuples of pseudo-random values for plaintext, counters, and keys.</p>
</div>
<div class="paragraph">
<p>The evaluator shall supply a single 3-tuple of pseudo-random values for 128-bits key. This 3-tuple of plaintext, counter, and key is provided as input to the below algorithm to generate the remaining 99 3-tuples, and to run each 3-tuple through 1000 iterations of SEED-CFB encryption.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Key[0] = Key, CTR[0] = CTR, PT[0] = PT
for i = 0 to 99  {
    Output Key[i], CTR[i], PT[0]
    for j = 0 to 999 {
        CT[j] = PT[j] xor SEED-CTR-Encrypt(Key[i], CTR[0])
        CTR[0] = (CTR[0] + 1) mod 2^128
        PT[j+1] = CT[j]
    }
    Output CT[j]
    Key[i+1] = Key[i] xor CT[j]
    PT[0] = CT[j-1]
}</pre>
</div>
</div>
<div class="paragraph">
<p>The ciphertext computed in the 1000th iteration (CT[999]) is the result for each of the 100 3-tuples for a 128-bits key. This result shall be compared to the result of running 1000 iterations with the same values using a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality using the same test as above, exchanging CT and PT, and replacing SEED-CTR-Encrypt with SEED-CTR-Decrypt.</p>
</div>
<div class="paragraph">
<p><strong>SEED-CCM Tests</strong></p>
</div>
<div class="paragraph">
<p>These tests are intended to be equivalent to those described in the NIST document, The CCM Validation System (CCMVS), updated 9 Jan 2012, found at <a href="http://csrc.nist.gov/groups/STM/cavp/documents/mac/CCMVS.pdf" class="bare">http://csrc.nist.gov/groups/STM/cavp/documents/mac/CCMVS.pdf</a>.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the generation-encryption and decryption-verification functionality of SEED-CCM for the following input parameter and tag lengths:</p>
</div>
<div class="paragraph">
<p><strong>Keys:</strong> 128-bits key is supported</p>
</div>
<div class="paragraph">
<p><strong>Associated Data:</strong> Two or three values for associated data length: The minimum ( 0 bytes) and maximum ( 32 bytes) supported associated data lengths, and 2^16 (65536) bytes, if supported.</p>
</div>
<div class="paragraph">
<p><strong>Payload:</strong> Two values for payload length: The minimum ( 0 bytes) and maximum ( 32 bytes) supported payload lengths.</p>
</div>
<div class="paragraph">
<p><strong>Nonces:</strong> All supported nonce lengths (7, 8, 9, 10, 11, 12, 13) in bytes.</p>
</div>
<div class="paragraph">
<p><strong>Tag:</strong> All supported tag lengths (4, 6, 8, 10, 12, 14, 16) in bytes.</p>
</div>
<div class="paragraph">
<p>The testing for CCM consists of five tests. To determine correctness in each of the below tests, the evaluator shall compare the ciphertext with the result of encryption of the same inputs with a known good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>Variable Associated Data Test</em></strong></p>
</div>
<div class="paragraph">
<p>For 128-bits key and associated data length, and any supported payload length, nonce length, and tag length, the evaluator shall supply one key value, one nonce value, and 10 pairs of associated data and payload values, and obtain the resulting ciphertext.</p>
</div>
<div class="paragraph">
<p><strong><em>Variable Payload Text</em></strong></p>
</div>
<div class="paragraph">
<p>For 128-bits key and payload length, and any supported associated data length, nonce length, and tag length, the evaluator shall supply one key value, one nonce value, and 10 pairs of associated data and payload values, and obtain the resulting ciphertext.</p>
</div>
<div class="paragraph">
<p><strong><em>Variable Nonce Test</em></strong></p>
</div>
<div class="paragraph">
<p>For 128-bits key and nonce length, and any supported associated data length, payload length, and tag length, the evaluator shall supply one key value, one nonce value, and 10 pairs of associated data and payload values, and obtain the resulting ciphertext.</p>
</div>
<div class="paragraph">
<p><strong><em>Variable Tag Test</em></strong></p>
</div>
<div class="paragraph">
<p>For 128-bits key and tag length, and any supported associated data length, payload length, and nonce length, the evaluator shall supply one key value, one nonce value, and 10 pairs of associated data and payload values, and obtain the resulting ciphertext.</p>
</div>
<div class="paragraph">
<p><strong><em>Decryption-Verification Process Test</em></strong></p>
</div>
<div class="paragraph">
<p>To test the decryption-verification functionality of SEED-CCM, for each combination of supported associated data length, payload length, nonce length, and tag length, the evaluator shall supply a key value and 15 sets of input plus ciphertext, and obtain the decrypted payload. Ten of the 15 input sets supplied should fail verification and five should pass.</p>
</div>
<div class="paragraph">
<p><strong>SEED-GCM Tests</strong></p>
</div>
<div class="paragraph">
<p>These tests are intended to be equivalent to those described in the NIST document, The Galois/Counter Mode (GCM) and GMAC Validation System (GCMVS) with the Addition of XPN Validation Testing, rev. 15 Jun 2016, section 6.2, found at <a href="http://csrc.nist.gov/groups/STM/cavp/documents/mac/gcmvs.pdf" class="bare">http://csrc.nist.gov/groups/STM/cavp/documents/mac/gcmvs.pdf</a>.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the authenticated encryption functionality of SEED-GCM by supplying 15 sets of Key, Plaintext, AAD, IV, and Tag data for every combination of the following parameters as selected in the ST and supported by the implementation under test:</p>
</div>
<div class="paragraph">
<p><strong>Key size in bits:</strong> 128-bits key is supported.</p>
</div>
<div class="paragraph">
<p><strong>Plaintext length in bits:</strong> Up to four values for plaintext length: Two values that are non-zero integer multiples of 128, if supported. And two values that are non-multiples of 128, if supported.</p>
</div>
<div class="paragraph">
<p><strong>AAD length in bits:</strong> Up to five values for AAD length: Zero-length, if supported. Two values that are non-zero integer multiples of 128, if supported. And two values that are integer non-multiples of 128, if supported.</p>
</div>
<div class="paragraph">
<p><strong>IV length in bits:</strong> Up to three values for IV length: 96 bits. Minimum and maximum supported lengths, if different.</p>
</div>
<div class="paragraph">
<p><strong>Tag length in bits:</strong> Each supported length (128, 120, 112, 104, 96, 64, 32).</p>
</div>
<div class="paragraph">
<p>To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the authenticated decrypt functionality of SEED-GCM by supplying 15 Ciphertext-Tag pairs for every combination of the above parameters, replacing Plaintext length with Ciphertext length. For each parameter combination the evaluator shall introduce an error into either the Ciphertext or the Tag such that approximately half of the cases are correct and half the cases contain errors. To determine correctness, the evaluator shall compare the resulting pass/fail status and Plaintext values to the results obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong>HIGHT-CBC Tests</strong></p>
</div>
<div class="paragraph">
<p>For the HIGHT-CBC tests described below, the plaintext, ciphertext, and IV values shall consist of 64-bit blocks. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>HIGHT-CBC Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CBC Known Answer Tests for the required HIGHT-CBC testing. The evaluator shall test the encrypt functionality using the same test as SEED-CBC Tests, replacing SEED-CBC-Encrypt with HIGHT-ECB-Encrypt.</p>
</div>
<div class="paragraph">
<p><strong><em>HIGHT-CBC Multi-Block Message Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CBC Multi-Block Message Tests for the required HIGHT-CBC testing. The evaluator shall test the encrypt functionality using the same test as SEED-CBC Tests, replacing SEED-CBC-Encrypt with HIGHT-ECB-Encrypt.</p>
</div>
<div class="paragraph">
<p><strong><em>HIGHT-CBC Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CBC Monte Carlo Tests for the required HIGHT-CBC testing. The evaluator shall test the encrypt functionality using the same test as SEED-CBC Tests, replacing SEED-CBC-Encrypt with HIGHT-ECB-Encrypt.</p>
</div>
<div class="paragraph">
<p><strong>HIGHT-CFB Tests</strong></p>
</div>
<div class="paragraph">
<p>For the HIGHT-CFB tests described below, the plaintext, ciphertext, and IV values shall consist of 64-bit blocks. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>HIGHT-CFB Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CFB Known Answer Tests for the required HIGHT-CFB testing. The evaluator shall test the encrypt functionality using the same test as SEED-CFB Tests, replacing SEED-CFB-Encrypt with HIGHT-CFB-Encrypt.</p>
</div>
<div class="paragraph">
<p><strong><em>HIGHT-CFB Multi-Block Message Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CFB Multi-Block Message Tests for the required HIGHT-CFB testing. The evaluator shall test the encrypt functionality using the same test as SEED-CFB Tests, replacing SEED-CFB-Encrypt with HIGHT-CFB-Encrypt.</p>
</div>
<div class="paragraph">
<p><strong><em>HIGHT-CFB Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CFB Monte Carlo Tests for the required HIGHT-CFB testing. The evaluator shall test the encrypt functionality using the same test as SEED-CFB Tests, replacing SEED-CFB-Encrypt with HIGHT-CFB-Encrypt.</p>
</div>
<div class="paragraph">
<p><strong>HIGHT-OFB Tests</strong></p>
</div>
<div class="paragraph">
<p>For the HIGHT-OFB tests described below, the plaintext, ciphertext, and IV values shall consist of 64-bit blocks. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>HIGHT-OFB Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-OFB Known Answer Tests for the required HIGHT-OFB testing. The evaluator shall test the encrypt functionality using the same test as SEED-OFB Tests, replacing SEED-OFB-Encrypt with HIGHT-OFB-Encrypt.</p>
</div>
<div class="paragraph">
<p><strong><em>HIGHT-OFB Multi-Block Message Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-OFB Multi-Block Message Tests for the required HIGHT-OFB testing. The evaluator shall test the encrypt functionality using the same test as SEED-OFB Tests, replacing SEED-OFB-Encrypt with HIGHT-OFB-Encrypt.</p>
</div>
<div class="paragraph">
<p><strong><em>HIGHT-OFB Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-OFB Monte Carlo Tests for the required HIGHT-OFB testing. The evaluator shall test the encrypt functionality using the same test as SEED-OFB Tests, replacing SEED-OFB-Encrypt with HIGHT-OFB-Encrypt.</p>
</div>
<div class="paragraph">
<p><strong>HIGHT-CTR Tests</strong></p>
</div>
<div class="paragraph">
<p>For the HIGHT-CTR tests described below, the plaintext, ciphertext, and counters shall consist of 64-bit blocks. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>HIGHT-CTR Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CTR Known Answer Tests for the required HIGHT-CTR testing. The evaluator shall test the encrypt functionality using the same test as SEED-CTR Tests, replacing SEED-CTR-Encrypt with HIGHT-CTR-Encrypt.</p>
</div>
<div class="paragraph">
<p><strong><em>HIGHT-CTR Multi-Block Message Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CTR Multi-Block Message Tests for the required HIGHT-CTR testing. The evaluator shall test the encrypt functionality using the same test as SEED-CTR Tests, replacing SEED-CTR-Encrypt with HIGHT-CTR-Encrypt.</p>
</div>
<div class="paragraph">
<p><strong><em>HIGHT-CTR Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-CTR Monte Carlo Tests for the required HIGHT-CTR testing. The evaluator shall test the encrypt functionality using the same test as SEED-CTR Tests, replacing SEED-CTR-Encrypt with HIGHT-CTR-Encrypt.</p>
</div>
<div class="paragraph">
<p><strong>LEA-CBC Tests</strong></p>
</div>
<div class="paragraph">
<p>For the LEA-CBC tests described below, the plaintext, ciphertext, and IV values shall consist of 128-bit blocks. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>LEA-CBC Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p><strong>KAT-1 (Variable Key):</strong> To test the encrypt functionality of LEA-CBC, the evaluator shall supply a set of keys for each selected key size (as described below) and obtain the ciphertext value that results from LEA encryption of an all-zeros plaintext using each key and an IV of all zeros.
Key i in each set shall have the leftmost i bits set to ones and the remaining bits to zeros, for values of i from 1 to the key size.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of LEA-CBC, the evaluator shall use the same keys as above to decrypt the ciphertext results from above. Each decryption should result in an all-zeros plaintext.</p>
</div>
<div class="paragraph">
<p><strong>KAT-2 (Variable Text):</strong> To test the encrypt functionality of LEA-CBC, for each selected key size, the evaluator shall supply a set of 128-bit plaintext values (as described below) and obtain the ciphertext values that result from LEA-CBC encryption of each plaintext value using a 128-bits key and IV consisting of all zeros.</p>
</div>
<div class="paragraph">
<p>Plaintext value i shall have the leftmost i bits set to ones and the remaining bits set to zeros, for values of i from 1 to 128.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of LEA-CBC, use the plaintext values from above as ciphertext input, and LEA-CBC decrypt each ciphertext value using key of each size consisting of all zeros and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p><strong><em>LEA-CBC Multi-Block Message Tests</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality by encrypting nine i-block messages for each selected key size, for 2  i  10. For each test, the evaluator shall supply a key, an IV, and a plaintext message of length i blocks, and encrypt the message using LEA-CBC. The resulting ciphertext values shall be compared to the results of encrypting the plaintext messages using a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality by decrypting nine i-block messages for each selected key size, for 2  i  10. For each test, the evaluator shall supply a key, an IV, and a ciphertext message of length i blocks, and decrypt the message using LEA-CBC. The resulting plaintext values shall be compared to the results of decrypting the ciphertext messages using a known good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>LEA-CBC Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality for each selected key size using 100 3-tuples of pseudo-random values for plaintext, IVs, and keys.</p>
</div>
<div class="paragraph">
<p>The evaluator shall supply a single 3-tuple of pseudo-random values for for each selected key size. This 3-tuple of plaintext, IV, and key is provided as input to the below algorithm to generate the remaining 99 3-tuples, and to run each 3-tuple through 1000 iterations of LEA-CBC encryption.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Key[0] = Key, IV[0] = IV, PT[0] = PT
for i = 0 to 99  {
    Output Key[i], IV[i], PT[0]
    for j = 0 to 999 {
        if (j == 0) {
            CT[j] = LEA-CBC-Encrypt(Key[i], IV[i], PT[j])
            PT[j+1] = IV[i]
        } else {
            CT[j] = LEA-CBC-Encrypt(Key[i], PT[j])
            PT[j+1] = CT[j-1]
        }
    }
    Output CT[j]
    If(KeySize==128) Key[i+1] = Key[i] xor CT[j]
    If(KeySize==192) Key[i+1] = Key[i] xor (last 64 bits of CT[j-1]||CT[j])
    If(KeySize==256) Key[i+1] = Key[i] xor (CT[j-1]||CT[j])
    IV[i+1] = CT[j]
    PT[0] = CT[j-1]
}</pre>
</div>
</div>
<div class="paragraph">
<p>The ciphertext computed in the 1000th iteration (CT[999]) is the result for each of the 100 3-tuples for each selected key size. This result shall be compared to the result of running 1000 iterations with the same values using a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality using the same test as above, exchanging CT and PT, and replacing LEA-CBC-Encrypt with LEA-CBC-Decrypt.</p>
</div>
<div class="paragraph">
<p><strong>LEA-CFB Tests</strong></p>
</div>
<div class="paragraph">
<p>For the LEA-CFB tests described below, the plaintext, ciphertext, and IV values shall consist of 128-bit blocks. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>LEA-CFB Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p><strong>KAT-1 (Variable Key):</strong> To test the encrypt functionality of SEED-CFB, the evaluator shall supply a set of keys for each selected key size (as described below) and obtain the ciphertext value that results from LEA encryption of an all-zeros plaintext using each key and an IV of all zeros.
Key i in each set shall have the leftmost i bits set to ones and the remaining bits to zeros, for values of i from 1 to the key size.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of LEA-CFB, the evaluator shall use the same keys as above to decrypt the ciphertext results from above. Each decryption should result in an all-zeros plaintext.</p>
</div>
<div class="paragraph">
<p><strong>KAT-2 (Variable Text):</strong> To test the encrypt functionality of LEA-CFB, the evaluator shall supply a set of 128-bit IV values (as described below) and obtain the ciphertext values that result from LEA-CFB encryption of a plaintext value consisting of all zeros using a key of each size and IV.
IV value i shall have the leftmost i bits set to ones and the remaining bits set to zeros, for values of i from 1 to 128.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of LEA-CFB, use the IV values from above as ciphertext input, and LEA-CFB decrypt each ciphertext value using a key of each size consisting of all zeros and a plaintext value consisting of all zeros.</p>
</div>
<div class="paragraph">
<p><strong><em>LEA-CFB Multi-Block Message Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to LEA-CBC Multi-Block Message Tests for the required LEA-CFB testing.</p>
</div>
<div class="paragraph">
<p><strong><em>LEA-CFB Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality for each selected key size using 100 3-tuples of pseudo-random values for plaintext, IVs, and keys.</p>
</div>
<div class="paragraph">
<p>The evaluator shall supply a single 3-tuple of pseudo-random values for selected key size. This 3-tuple of plaintext, IV, and key is provided as input to the below algorithm to generate the remaining 99 3-tuples, and to run each 3-tuple through 1000 iterations of LEA-CFB encryption.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Key[0] = Key, IV[0] = IV, PT[0] = PT
for i = 0 to 99  {
    Output Key[i], IV[i], PT[0]
    for j = 0 to 999 {
        if (j == 0) {
            CT[j] = PT[j] xor LEA-CFB-Encrypt(Key[i], IV[i])
            PT[j+1] = IV[i]
        } else {
            CT[j] = PT[j] xor LEA-CFB-Encrypt(Key[i], CT[j-1])
            PT[j+1] = CT[j-1]
        }
    }
    Output CT[j]
    If(KeySize==128) Key[i+1] = Key[i] xor CT[j]
    If(KeySize==192) Key[i+1] = Key[i] xor (last 64 bits of CT[j-1]||CT[j])
    If(KeySize==256) Key[i+1] = Key[i] xor (CT[j-1]||CT[j])
    IV[i+1] = CT[j]
    PT[0] = CT[j-1]
}</pre>
</div>
</div>
<div class="paragraph">
<p>The ciphertext computed in the 1000th iteration (CT[999]) is the result for each of the 100 3-tuples for each selected key size. This result shall be compared to the result of running 1000 iterations with the same values using a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality using the same test as above, exchanging CT and PT, and replacing LEA-CFB-Encrypt with LEA-CFB-Decrypt.</p>
</div>
<div class="paragraph">
<p><strong>LEA-OFB Tests</strong></p>
</div>
<div class="paragraph">
<p>For the LEA-OFB tests described below, the plaintext, ciphertext, and IV values shall consist of 128-bit blocks. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>LEA-OFB Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to LEA-CFB Known Answer Tests for the required LEA-OFB testing.</p>
</div>
<div class="paragraph">
<p><strong><em>LEA-OFB Multi-Block Message Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to [LEA-CFB Multi-Block Message Tests] for the required LEA-OFB testing.</p>
</div>
<div class="paragraph">
<p><strong><em>LEA-OFB Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality for each selected key size using 100 3-tuples of pseudo-random values for plaintext, IVs, and keys.</p>
</div>
<div class="paragraph">
<p>The evaluator shall supply a single 3-tuple of pseudo-random values for 128-bits key. This 3-tuple of plaintext, IV, and key is provided as input to the below algorithm to generate the remaining 99 3-tuples, and to run each 3-tuple through 1000 iterations of LEA-OFB encryption.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Key[0] = Key, IV[0] = IV, PT[0] = PT
for i = 0 to 99  {
    Output Key[i], IV[i], PT[0]
    for j = 0 to 999 {
        if (j == 0) {
            OT[j] = LEA-OFB-Encrypt(Key[i], IV[i])
            CT[j] = PT[j] xor OT[j]
            PT[j+1] = IV[i]
        } else {
            OT[j] = LEA-OFB-Encrypt(Key[i], OT[j-1])
            CT[j] = PT[j] xor OT[j]
            PT[j+1] = CT[j-1]
        }
    }
    Output CT[j]
    If(KeySize==128) Key[i+1] = Key[i] xor CT[j]
    If(KeySize==192) Key[i+1] = Key[i] xor (last 64 bits of CT[j-1]||CT[j])
    If(KeySize==256) Key[i+1] = Key[i] xor (CT[j-1]||CT[j])
    IV[i+1] = CT[j]
    PT[0] = CT[j-1]
}</pre>
</div>
</div>
<div class="paragraph">
<p>The ciphertext computed in the 1000th iteration (CT[999]) is the result for each of the 100 3-tuples for each selected key size. This result shall be compared to the result of running 1000 iterations with the same values using a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality using the same test as above, exchanging CT and PT, and replacing LEA-OFB-Encrypt with LEA-OFB-Decrypt.</p>
</div>
<div class="paragraph">
<p><strong>LEA-CTR Tests</strong></p>
</div>
<div class="paragraph">
<p>For the LEA-CTR tests described below, the plaintext, ciphertext, and counters shall consist of 128-bit blocks. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>LEA-CTR Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to LEA-CFB Known Answer Tests for the required LEA-CTR testing. The evaluator shall test the encrypt functionality using the same test as LEA-CFB Tests, replacing IVs with counters.</p>
</div>
<div class="paragraph">
<p><strong><em>LEA-CTR Multi-Block Message Tests</em></strong></p>
</div>
<div class="paragraph">
<p>Refer to LEA-CFB Multi-Block Message Tests for the required LEA-CTR testing. The evaluator shall test the encrypt functionality using the same test as LEA-CFB Tests, replacing IVs with counters.</p>
</div>
<div class="paragraph">
<p><strong><em>LEA-CTR Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality for each selected key size using 100 3-tuples of pseudo-random values for plaintext, counters, and keys.</p>
</div>
<div class="paragraph">
<p>The evaluator shall supply a single 3-tuple of pseudo-random values for 128-bits key. This 3-tuple of plaintext, counter, and key is provided as input to the below algorithm to generate the remaining 99 3-tuples, and to run each 3-tuple through 1000 iterations of SEED-CFB encryption.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Key[0] = Key, CTR[0] = CTR, PT[0] = PT
for i = 0 to 99  {
    Output Key[i], CTR[i], PT[0]
    for j = 0 to 999 {
        CT[j] = PT[j] xor SEED-CTR-Encrypt(Key[i], CTR[0])
        CTR[0] = (CTR[0] + 1) mod 2^128
        PT[j+1] = CT[j]
    }
    Output CT[j]
    If(KeySize==128) Key[i+1] = Key[i] xor CT[j]
    If(KeySize==192) Key[i+1] = Key[i] xor (last 64 bits of CT[j-1]||CT[j])
    If(KeySize==256) Key[i+1] = Key[i] xor (CT[j-1]||CT[j])
    PT[0] = CT[j-1]
}</pre>
</div>
</div>
<div class="paragraph">
<p>The ciphertext computed in the 1000th iteration (CT[999]) is the result for each of the 100 3-tuples for each selected key size. This result shall be compared to the result of running 1000 iterations with the same values using a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality using the same test as above, exchanging CT and PT, and replacing LEA-CTR-Encrypt with LEA-CTR-Decrypt.</p>
</div>
<div class="paragraph">
<p><strong>LEA-CCM Tests</strong></p>
</div>
<div class="paragraph">
<p>These tests are intended to be equivalent to those described in the NIST document, The CCM Validation System (CCMVS), updated 9 Jan 2012, found at <a href="http://csrc.nist.gov/groups/STM/cavp/documents/mac/CCMVS.pdf" class="bare">http://csrc.nist.gov/groups/STM/cavp/documents/mac/CCMVS.pdf</a>.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the generation-encryption and decryption-verification functionality of LEA-CCM for the following input parameter and tag lengths:</p>
</div>
<div class="paragraph">
<p><strong>Keys:</strong> All supported and selected key sizes (e.g., 128, 192, 256 bits).</p>
</div>
<div class="paragraph">
<p><strong>Associated Data:</strong> Two or three values for associated data length: The minimum ( 0 bytes) and maximum ( 32 bytes) supported associated data lengths, and 2^16 (65536) bytes, if supported.</p>
</div>
<div class="paragraph">
<p><strong>Payload:</strong> Two values for payload length: The minimum ( 0 bytes) and maximum ( 32 bytes) supported payload lengths.</p>
</div>
<div class="paragraph">
<p><strong>Nonces:</strong> All supported nonce lengths (7, 8, 9, 10, 11, 12, 13) in bytes.</p>
</div>
<div class="paragraph">
<p><strong>Tag:</strong> All supported tag lengths (4, 6, 8, 10, 12, 14, 16) in bytes.</p>
</div>
<div class="paragraph">
<p>The testing for CCM consists of five tests. To determine correctness in each of the below tests, the evaluator shall compare the ciphertext with the result of encryption of the same inputs with a known good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>Variable Associated Data Test</em></strong></p>
</div>
<div class="paragraph">
<p>For each supported key size and associated data length, and any supported payload length, nonce length, and tag length, the evaluator shall supply one key value, one nonce value, and 10 pairs of associated data and payload values, and obtain the resulting ciphertext.</p>
</div>
<div class="paragraph">
<p><strong><em>Variable Payload Text</em></strong></p>
</div>
<div class="paragraph">
<p>For each supported key size and payload length, and any supported associated data length, nonce length, and tag length, the evaluator shall supply one key value, one nonce value, and 10 pairs of associated data and payload values, and obtain the resulting ciphertext.</p>
</div>
<div class="paragraph">
<p><strong><em>Variable Nonce Test</em></strong></p>
</div>
<div class="paragraph">
<p>For each supported key size and nonce length, and any supported associated data length, payload length, and tag length, the evaluator shall supply one key value, one nonce value, and 10 pairs of associated data and payload values, and obtain the resulting ciphertext.</p>
</div>
<div class="paragraph">
<p><strong><em>Variable Tag Test</em></strong></p>
</div>
<div class="paragraph">
<p>For each supported key size and tag length, and any supported associated data length, payload length, and nonce length, the evaluator shall supply one key value, one nonce value, and 10 pairs of associated data and payload values, and obtain the resulting ciphertext.</p>
</div>
<div class="paragraph">
<p><strong><em>Decryption-Verification Process Test</em></strong></p>
</div>
<div class="paragraph">
<p>To test the decryption-verification functionality of LEA-CCM, for each combination of supported associated data length, payload length, nonce length, and tag length, the evaluator shall supply a key value and 15 sets of input plus ciphertext, and obtain the decrypted payload. Ten of the 15 input sets supplied should fail verification and five should pass.</p>
</div>
<div class="paragraph">
<p><strong>LEA-GCM Tests</strong></p>
</div>
<div class="paragraph">
<p>These tests are intended to be equivalent to those described in the NIST document, The Galois/Counter Mode (GCM) and GMAC Validation System (GCMVS) with the Addition of XPN Validation Testing, rev. 15 Jun 2016, section 6.2, found at <a href="http://csrc.nist.gov/groups/STM/cavp/documents/mac/gcmvs.pdf" class="bare">http://csrc.nist.gov/groups/STM/cavp/documents/mac/gcmvs.pdf</a>.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the authenticated encryption functionality of LEA-GCM by supplying 15 sets of Key, Plaintext, AAD, IV, and Tag data for every combination of the following parameters as selected in the ST and supported by the implementation under test:</p>
</div>
<div class="paragraph">
<p><strong>Key size in bits:</strong> All supported and selected key sizes (e.g., 128, 192, 256 bits).</p>
</div>
<div class="paragraph">
<p><strong>Plaintext length in bits:</strong> Up to four values for plaintext length: Two values that are non-zero integer multiples of 128, if supported. And two values that are non-multiples of 128, if supported.</p>
</div>
<div class="paragraph">
<p><strong>AAD length in bits:</strong> Up to five values for AAD length: Zero-length, if supported. Two values that are non-zero integer multiples of 128, if supported. And two values that are integer non-multiples of 128, if supported.</p>
</div>
<div class="paragraph">
<p><strong>IV length in bits:</strong> Up to three values for IV length: 96 bits. Minimum and maximum supported lengths, if different.</p>
</div>
<div class="paragraph">
<p><strong>Tag length in bits:</strong> Each supported length (128, 120, 112, 104, 96, 64, 32).</p>
</div>
<div class="paragraph">
<p>To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known-good implementation. The evaluator shall test the authenticated decryption functionality of LEA-GCM by supplying 15 ciphertext-tag pairs for every combination of the above parameters, replacing plaintext length with ciphertext length. For each parameter combination the evaluator shall introduce an error into either the ciphertext or the tag such that approximately half of the cases are correct and half the cases contain errors. To determine correctness, the evaluator shall compare the resulting pass/fail status and Plaintext values to the results obtained by submitting the same inputs to a known-good implementation.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_cop_1siggen_cryptographic_operation_signature_generation_and_verification">2.2.5. FCS_COP.1/SigGen Cryptographic Operation (Signature Generation and Verification)</h4>
<div class="sect4">
<h5 id="_tss_10">2.2.5.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to determine that it specifies the
cryptographic algorithm and key size supported by the TOE for signature
services and the overall flow of the signature generation and verification.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_10">2.2.5.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall verify that the AGD guidance instructs the administrator
how to configure the TOE to use the selected cryptographic algorithm and key
size defined in the Security Target supported by the TOE for signature
services.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_11">2.2.5.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall include test cases of FCS_COP.1/SigGen to the test subset. Note that FCS_COP.1/SigGen may be not mapped to the specific interface(s) after evaluators analysis during ADV_FSP.1.</p>
</div>
<div class="paragraph">
<p>The evaluator shall produce test documentation for test cases of FCS_COP.1/SigGen. If there is no explicit external interface(s) mapped to FCS_COP.1/SigGen, the evaluator shall employ an alternative test approach (refer to CEM, section 15.2.2.).</p>
</div>
<div class="paragraph">
<p>Each section below contains tests the evaluators shall perform for each selected digital signature scheme. Based on the assignments and selections in the requirement, the evaluators choose the specific activities that correspond to those selections.</p>
</div>
<div class="paragraph">
<p>Note: Testing of cryptographic functions implemented in the Root of Trust for Secure Boot (FPT_SBT_EXT.1) may not be feasible and independent testing may not be available. In this situation, contact the CC Scheme.</p>
</div>
<div class="paragraph">
<p><strong>ECDSA Algorithm Tests</strong></p>
</div>
<div class="paragraph">
<p><strong><em>ECDSA FIPS 186-4 Signature Generation Test</em></strong></p>
</div>
<div class="paragraph">
<p>For each supported NIST curve (i.e., P-256, P-384 and P-521) and SHA
function pair, the evaluator shall generate 10 1024-bit long messages and
obtain for each message a public key and the resulting signature values R and
S. To determine correctness, the evaluator shall use the signature verification
function of a known good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>ECDSA FIPS 186-4 Signature Verification Test</em></strong></p>
</div>
<div class="paragraph">
<p>For each supported NIST curve (i.e., P-256, P-384 and P-521) and SHA
function pair, the evaluator shall generate a set of 10 1024-bit message, public
key and signature tuples and modify one of the values (message, public key or
signature) in five of the 10 tuples. The evaluator shall obtain in response a set
of 10 PASS/FAIL values.</p>
</div>
<div class="paragraph">
<p><strong>RSA Signature Algorithm Tests</strong></p>
</div>
<div class="paragraph">
<p><strong><em>Signature Generation Test</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator generates or obtains 10 messages for each modulus size/SHA
combination supported by the TOE. The TOE generates and returns the
corresponding signatures.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the correctness of the TOEs signature using a
trusted reference implementation of the signature verification algorithm and
the associated public keys to verify the signatures.</p>
</div>
<div class="paragraph">
<p><strong><em>Signature Verification Test</em></strong></p>
</div>
<div class="paragraph">
<p>For each modulus size/hash algorithm selected, the evaluator generates a
modulus and three associated key pairs, (<em>d</em>, <em>e</em>). Each private key <em>d</em> is used to
sign six pseudorandom messages each of 1024 bits using a trusted reference
implementation of the signature generation algorithm. Some of the public
keys, <em>e</em>, messages, or signatures are altered so that signature verification
should fail. For both the set of original messages and the set of altered
messages: the modulus, hash algorithm, public key <em>e</em> values, messages, and
signatures are forwarded to the TOE, which then attempts to verify the
signatures and returns the verification results.</p>
</div>
<div class="paragraph">
<p>The evaluator verifies that the TOE confirms correct signatures on the original
messages and detects the errors introduced in the altered messages.</p>
</div>
<div class="paragraph">
<p><strong>KCDSA Tests</strong></p>
</div>
<div class="paragraph">
<p>The following test require the developer to provide access to a test platform that provides the evaluator with tools that are not found on the TOE in its evaluated configuration.
The following or equivalent steps shall be taken to test the TSF.</p>
</div>
<div class="paragraph">
<p><strong><em>Signature Generation Test</em></strong></p>
</div>
<div class="paragraph">
<p>For each domain parameter (i.e., (p=2048, q= 224), (p=2048, q=256)) and SHA function pair, the evaluator shall generate a set of 10 1024-bit message. The test passes only if all the signatures with submitted parameters result in successful signature verification.</p>
</div>
<div class="paragraph">
<p><strong><em>Signature Verification Test</em></strong></p>
</div>
<div class="paragraph">
<p>The KCDSA Signature Verification Test tests the ability of the TSF to recognize valid and invalid signatures. The evaluator shall provide a modulus and associated key pair (x, y) for each combination of selected curve, modulus size, and hash size. Each private key (x) is used to sign 15 pseudorandom messages of 1024 bits. For eight of the fifteen messages, the message, IR format, padding, or signature is altered so that signature verification should fail. The test passes only if all the signatures made using unaltered parameters result in successful signature verification, and all the signatures made using altered parameters result in unsuccessful signature verification.</p>
</div>
<div class="paragraph">
<p><strong>EC-KCDSA Tests</strong></p>
</div>
<div class="paragraph">
<p>The following test require the developer to provide access to a test platform that provides the evaluator with tools that are not found on the TOE in its evaluated configuration.
The following or equivalent steps shall be taken to test the TSF.</p>
</div>
<div class="paragraph">
<p><strong><em>Signature Generation Test</em></strong></p>
</div>
<div class="paragraph">
<p>For each supported NIST curve (i.e., P-224/P-256, B-233/B-283, K-233/K-283) and SHA function pair, the evaluator shall generate a set of 10 1024-bit message. The test passes only if all the signatures with submitted parameters result in successful signature verification.</p>
</div>
<div class="paragraph">
<p><strong><em>Signature Verification Test</em></strong></p>
</div>
<div class="paragraph">
<p>The EC-KCDSA Signature Verification Test tests the ability of the TSF to recognize valid and invalid signatures. The evaluator shall provide a modulus and associated key pair (x, y) for each combination of selected curve, modulus size, and hash size. Each private key (x) is used to sign 15 pseudorandom messages of 1024 bits. For eight of the fifteen messages, the message, IR format, padding, or signature is altered so that signature verification should fail. The test passes only if all the signatures made using unaltered parameters result in successful signature verification, and all the signatures made using altered parameters result in unsuccessful signature verification.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_cop_1hash_cryptographic_operation_hash_algorithm">2.2.6. FCS_COP.1/Hash Cryptographic Operation (Hash Algorithm)</h4>
<div class="sect4">
<h5 id="_tss_11">2.2.6.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check that the association of the hash function with other
TSF cryptographic functions (for example, the digital signature verification
function) is documented in the TSS.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_11">2.2.6.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator checks the AGD documents to determine that any configuration
that is required to configure the required hash sizes is present.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_12">2.2.6.3. Tests</h5>
<div class="paragraph">
<p>The TSF hashing functions can be implemented in one of two modes. The first
mode is the byte-oriented mode. In this mode the TSF only hashes messages
that are an integral number of bytes in length; i.e., the length (in bits) of the
message to be hashed is divisible by 8. The second mode is the bit-oriented
mode. In this mode the TSF hashes messages of arbitrary length. As there are
different tests for each mode, an indication is given in the following sections
for the bit-oriented vs. the byte-oriented test mode.</p>
</div>
<div class="paragraph">
<p>The evaluator shall perform all of the following tests for each hash algorithm
implemented by the TSF and used to satisfy the requirements of this cPP.</p>
</div>
<div class="paragraph">
<p>Note: Testing of cryptographic functions implemented in the Root of Trust for Secure Boot (FPT_SBT_EXT.1) may not be feasible and independent testing may not be available. In this situation, contact the CC Scheme.</p>
</div>
<div class="paragraph">
<p><strong>Short Messages Test - Bit-oriented Mode</strong></p>
</div>
<div class="paragraph">
<p>The evaluators devise an input set consisting of m+1 messages, where m is the
block length of the hash algorithm. The length of the messages range
sequentially from 0 to m bits. The message text shall be pseudorandomly
generated. The evaluators compute the message digest for each of the
messages and ensure that the correct result is produced when the messages are
provided to the TSF.</p>
</div>
<div class="paragraph">
<p><strong>Short Messages Test - Byte-oriented Mode</strong></p>
</div>
<div class="paragraph">
<p>The evaluators devise an input set consisting of m/8+1 messages, where m is
the block length of the hash algorithm. The length of the messages range
sequentially from 0 to m/8 bytes, with each message being an integral number
of bytes. The message text shall be pseudorandomly generated. The evaluators
compute the message digest for each of the messages and ensure that the
correct result is produced when the messages are provided to the TSF.</p>
</div>
<div class="paragraph">
<p><strong>Selected Long Messages Test - Bit-oriented Mode</strong></p>
</div>
<div class="paragraph">
<p>The evaluators devise an input set consisting of m messages, where m is the
block length of the hash algorithm (e.g. 512 bits for SHA-256). The length of
the ith message is m + 99*i, where 1  i  m. The message text shall be
pseudorandomly generated. The evaluators compute the message digest for
each of the messages and ensure that the correct result is produced when the
messages are provided to the TSF.</p>
</div>
<div class="paragraph">
<p><strong>Selected Long Messages Test - Byte-oriented Mode</strong></p>
</div>
<div class="paragraph">
<p>The evaluators devise an input set consisting of m/8 messages, where m is the
block length of the hash algorithm (e.g. 512 bits for SHA-256). The length of
the ith message is m + 8*99*i, where 1  i  m/8. The message text shall be
pseudorandomly generated. The evaluators compute the message digest for
each of the messages and ensure that the correct result is produced when the
messages are provided to the TSF.</p>
</div>
<div class="paragraph">
<p><strong>Pseudorandomly Generated Messages Test</strong></p>
</div>
<div class="paragraph">
<p>This test is for byte-oriented implementations only. The evaluators randomly
generate a seed that is n bits long, where n is the length of the message digest
produced by the hash function to be tested. The evaluators then formulate a set
of 100 messages and associated digests by following the algorithm provided
in Figure 1 of [SHAVS]. The evaluators then ensure that the correct result is
produced when the messages are provided to the TSF.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_rbg_ext_1_cryptographic_operation_random_bit_generation">2.2.7. FCS_RBG_EXT.1 Cryptographic Operation (Random Bit Generation)</h4>
<div class="paragraph">
<p>Documentation shall be producedand the evaluator shall perform the
activitiesin accordance with Appendix E of <a href="#HCDcPP">[HCDcPP]</a>.</p>
</div>
<div class="sect4">
<h5 id="_tss_12">2.2.7.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to determine that it specifies the DRBG
type, identifies the entropy source(s) seeding the DRBG, and state the assumed
or calculated min-entropy supplied either separately by each source or the min-entropy
contained in the combined seed value.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_12">2.2.7.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall confirm that the guidance documentation contains
appropriate instructions for configuring the RNG functionality.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_13">2.2.7.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall include test cases of FCS_RBG_EXT.1 to the test subset. Note that FCS_RBG_EXT.1 may be not mapped to the specific interface(s) after evaluators analysis during ADV_FSP.1.</p>
</div>
<div class="paragraph">
<p>The evaluator shall produce test documentation for test cases of FCS_RBG_EXT.1. If there is no explicit external interface(s) mapped to FCS_RBG_EXT.1, the evaluator shall employ an alternative test approach (refer to CEM, section 15.2.2.).</p>
</div>
<div class="paragraph">
<p>The evaluator shall perform 15 trials for the RNG implementation. If the RNG
is configurable, the evaluator shall perform 15 trials for each configuration considering the following parameters as selected in FCS_RBG_EXT.1.1 and supported by the implementation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Mechanism: Hash_DRBG, HMAC_DRBG, CTR_DRBG</p>
</li>
<li>
<p>Option for Hash_DRBG and HMAC_DRBG: selected hash function and size</p>
</li>
<li>
<p>Option for CTR_DRBG: selected block cipher and whether or not a Derivation Function (df) is used</p>
</li>
<li>
<p>Prediction Resistance enabled or disabled</p>
</li>
<li>
<p>Entropy input length</p>
</li>
<li>
<p>Nonce length</p>
</li>
<li>
<p>Personalization String length</p>
</li>
<li>
<p>Additional Input length</p>
</li>
<li>
<p>Returned Bits length</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the RNG has prediction resistance enabled, each trial consists of steps (1)
instantiate DRBG, (2) generate the first block of random bits (3) generate a
second block of random bits (4) uninstantiate. The evaluator verifies that the
second block of random bits is the expected value. The evaluator shall generate
eight input values for each trial. The first is a count (0  14). The next three
are entropy input, nonce, and personalization string for the instantiate
operation (i.e., step (1)). The next two are additional input and entropy input for the first call
to generate (i.e., for step (2)). The final two are additional input and entropy input for the second
call to generate (i.e., for step (3)). These values are randomly generated. generate one block of
random bits means to generate random bits with number of returned bits equal
to the Output Block Length (as defined in SP800-90A). The evaluator shall use a known-good implementation to verify that the Returned Bits output from step (3) is the result expected.</p>
</div>
<div class="paragraph">
<p>If the RNG does not have prediction resistance, each trial consists of steps (1)
instantiate DRBG, (2) reseed, (3) generate the first block of random bits, (4)
generate a second block of random bits (5) uninstantiate. The evaluator
verifies that the second block of random bits is the expected value. The
evaluator shall generate eight input values for each trial. The first is a count (0
 14). The next three are entropy input, nonce, and personalization string for
the instantiate operation (i.e., step (1)). The fifth value is additional input to the first call to
generate (i.e., for step (2)). The sixth and seventh are additional input and entropy input to the
call to reseed (i.e., for step (3)). The final value is additional input to the second generate call (i.e., for step (4)). The evaluator shall use a known-good implementation to verify that the Returned Bits output from step (4) is the result expected.</p>
</div>
<div class="paragraph">
<p>The implementation passes the DRBG test if the Returned Bits result matches the Returned Bits from the known-good implementation.</p>
</div>
<div class="paragraph">
<p>The following paragraphs contain more information on some of the input
values to be generated/selected by the evaluator.</p>
</div>
<div class="paragraph">
<p><strong>Entropy input:</strong> the length of the entropy input value must equal the seed
length.</p>
</div>
<div class="paragraph">
<p><strong>Nonce:</strong> If a nonce is supported (CTR_DRBG with no Derivation Function
does not use a nonce), the nonce bit length is one-half the seed length.</p>
</div>
<div class="paragraph">
<p><strong>Personalization string:</strong> The length of the personalization string must be &lt;=
seed length. If the implementation only supports one personalization string
length, then the same length can be used for both values. If more than one
string length is support, the evaluator shall use personalization strings of two
different lengths. If the implementation does not use a personalization string,
no value needs to be supplied.</p>
</div>
<div class="paragraph">
<p><strong>Additional input:</strong> the additional input bit lengths have the same defaults and
restrictions as the personalization string lengths.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_user_data_protection_fdp">2.3. User Data Protection (FDP)</h3>
<div class="sect3">
<h4 id="_fdp_acc_1_subset_access_control">2.3.1. FDP_ACC.1 Subset access control</h4>
<div class="paragraph">
<p>It is covered by assurance activities for FDP_ACF.1.</p>
</div>
</div>
<div class="sect3">
<h4 id="_fdp_acf_1_security_attribute_based_access_control">2.3.2. FDP_ACF.1 Security attribute based access control</h4>
<div class="sect4">
<h5 id="_tss_13">2.3.2.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS describes the functions to realize SFP defined in Table 4 and Table 5 of  <a href="#HCDcPP">[HCDcPP]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_13">2.3.2.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the operational guidance contains a description of the operation to realize the SFP defined in Tables 4 and Table 5 of <a href="#HCDcPP">[HCDcPP]</a>, which is consistent with the description in the TSS.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_14">2.3.2.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall perform tests to confirm the functions to realize the SFP defined in Table 4 and Table 5 of  <a href="#HCDcPP">[HCDcPP]</a> with each type of interface (e.g., operation panel, Web interfaces) to the TOE.</p>
</div>
<div class="paragraph">
<p>The evaluator testing should include the following viewpoints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>representative sets of the operations against representative sets of the object types defined in Table 4 and Table 5 of <a href="#HCDcPP">[HCDcPP]</a> (including some cases where operations are either permitted or denied)</p>
</li>
<li>
<p>representative sets for the combinations of the setting for security attributes that are used in access control</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_identification_and_authentication_fia">2.4. Identification and Authentication (FIA)</h3>
<div class="sect3">
<h4 id="_fia_afl_1_authentication_failure_handling">2.4.1. FIA_AFL.1 Authentication failure handling</h4>
<div class="sect4">
<h5 id="_tss_14">2.4.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of the actions in the case of authentication failure (types of authentication events, the number of unsuccessful authentication attempts, actions to be conducted), which is consistent with the definition of the SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_14">2.4.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the administrator guidance describes the setting for actions to be taken in the case of authentication failure, if any are defined in the SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_15">2.4.1.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall check to ensure that the subsequent authentication attempts do not succeed by the behavior according to the actions defined in the SFR when unsuccessful authentication attempts reach the status defined in the SFR.</p>
</li>
<li>
<p>The evaluator shall check to ensure that authentication attempts succeed when conditions to re-enable authentication attempts are defined in the SFR and when the conditions are fulfilled.</p>
</li>
<li>
<p>The evaluator shall perform the tests 1 and 2 described above for all the targeted authentication methods when there are multiple Internal Authentication methods (e.g., password authentication, biometric authentication).</p>
</li>
<li>
<p>The evaluator shall perform the tests 1 and 2 described above for all interfaces when there are multiple interfaces (e.g., operation panel, Web interfaces) that implement authentication attempts.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fia_atd_1_user_attribute_definition">2.4.2. FIA_ATD.1 User attribute definition</h4>
<div class="sect4">
<h5 id="_tss_15">2.4.2.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of the user security attributes that the TOE uses to implement the SFR, which is consistent with the definition of the SFR.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fia_pmg_ext_1_password_management">2.4.3. FIA_PMG_EXT.1 Password Management</h4>
<div class="sect4">
<h5 id="_guidance_documentation_15">2.4.3.1. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall examine the operational guidance to determine that it provides guidance to security administrators on the composition of passwords, and that it provides instructions on setting the minimum password length.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_16">2.4.3.2. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall compose passwords that meet the
requirements in some way. For each password, the evaluator shall
verify that the TOE supports the password. While the evaluator is not
required (nor is it feasible) to test all possible compositions of
passwords, the evaluator shall ensure that all characters, and a
minimum length listed in the requirement are supported and justify
the subset of those characters chosen for testing.</p>
</li>
<li>
<p>Test 2: The evaluator shall compose passwords that do not meet the
requirements in some way. For each password, the evaluator shall
verify that the TOE does not support the password. While the
evaluator is not required (nor is it feasible) to test all possible
compositions of passwords, the evaluator shall ensure that the TOE
enforces the allowed characters and the minimum length listed in the
requirement and justify the subset of those characters chosen for
testing.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fia_uau_1_timing_of_authentication">2.4.4. FIA_UAU.1 Timing of authentication</h4>
<div class="sect4">
<h5 id="_tss_16">2.4.4.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS describes all the identification and authentication mechanisms that the TOE provides (e.g., Internal Authentication and authentication by external servers).</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS identifies all the interfaces to perform identification and authentication (e.g., identification and authentication from operation panel or via Web interfaces).</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS describes the protocols (e.g., LDAP, Kerberos, OCSP) used in performing identification and authentication when the TOE exchanges identification and authentication with External Authentication servers.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of the permitted actions before performing identification and authentication, which is consistent with the definition of the SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_16">2.4.4.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the administrator guidance contains descriptions of identification and authentication methods that the TOE provides (e.g., External Authentication, Internal Authentication) as well as interfaces (e.g., identification and authentication from operation panel or via Web interfaces), which are consistent with the ST (TSS).</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_17">2.4.4.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall check to ensure that identification and authentication succeeds, enabling the access to the TOE when using authorized data.</p>
</li>
<li>
<p>The evaluator shall check to ensure that identification and authentication fails, disabling the access to the TOE afterwards when using unauthorized data.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The evaluator shall perform the tests described above for each of the authentication methods that the TOE provides (e.g., External Authentication, Internal Authentication) as well as interfaces (e.g., identification and authentication from operation panel or via Web interfaces).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fia_uau_7_protected_authentication_feedback">2.4.5. FIA_UAU.7 Protected authentication feedback</h4>
<div class="sect4">
<h5 id="_tss_17">2.4.5.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of the authentication information feedback provided to users while the authentication is in progress, which is consistent with the definition of the SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_18">2.4.5.2. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall check to ensure that only the information defined in the SFR is provided for feedback by attempting identification and authentication.</p>
</li>
<li>
<p>The evaluator shall perform the test 1 described above for all the interfaces that the TOE provides (e.g., operation panel, identification and authentication via Web interface).</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fia_uid_1_timing_of_identification">2.4.6. FIA_UID.1 Timing of identification</h4>
<div class="paragraph">
<p>It is covered by assurance activities for FIA_UAU.1.</p>
</div>
</div>
<div class="sect3">
<h4 id="_fia_usb_1_user_subject_binding">2.4.7. FIA_USB.1 User-subject binding</h4>
<div class="sect4">
<h5 id="_tss_18">2.4.7.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of rules for associating security attributes with the users who succeed identification and authentication, which is consistent with the definition of the SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_19">2.4.7.2. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following test:</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that security attributes defined in the SFR are associated with the users who succeed identification and authentication (it is ensured in the tests of FDP_ACF.1) for each role that the TOE supports (e.g., User and Administrator).</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_security_management_fmt">2.5. Security Management (FMT)</h3>
<div class="sect3">
<h4 id="_fmt_mof_1_management_of_security_functions_behavior">2.5.1. FMT_MOF.1 Management of security functions behavior</h4>
<div class="sect4">
<h5 id="_tss_19">2.5.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of the management functions that the TOE provides as well as user roles that are permitted to manage the functions, which is consistent with the definition of the SFR.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS identifies interfaces to operate the management functions.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_17">2.5.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the administrator guidance describes the operation methods for users of the given roles defined in the SFR to operate the management functions.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_20">2.5.1.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall check to ensure that users of the given roles defined in the SFR can operate the management functions in accordance with the operation methods specified in the administrator guidance.</p>
</li>
<li>
<p>The evaluator shall check to ensure that the operation results are appropriately reflected.</p>
</li>
<li>
<p>The evaluator shall check to ensure that U.NORMAL is not permitted to operate the management functions.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmt_msa_1_management_of_security_attributes">2.5.2. FMT_MSA.1 Management of security attributes</h4>
<div class="sect4">
<h5 id="_tss_20">2.5.2.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of possible operations for security attributes and given roles to those security attributes, which is consistent with the definition of the SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_18">2.5.2.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the administrator guidance contains a description of possible operations for security attributes and given roles to those security attributes, which is consistent with the definition of the SFR.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the administrator guidance describes the timing of modified security attributes.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_21">2.5.2.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall check to ensure that users of the given roles defined in the SFR can perform operations to the security attributes in accordance with the operation methods specified in the administrator guidance.</p>
</li>
<li>
<p>The evaluator shall check to ensure that the operation results are appropriately reflected as specified in the administrator guidance.</p>
</li>
<li>
<p>The evaluator shall check to ensure that a user that is not part of an authorized role defined in the SFR is not permitted to perform operations on the security attributes.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmt_msa_3_static_attribute_initialization">2.5.3. FMT_MSA.3 Static attribute initialization</h4>
<div class="sect4">
<h5 id="_tss_21">2.5.3.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS describes mechanisms to generate security attributes which have properties of default values, which are defined in the SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_22">2.5.3.2. Tests</h5>
<div class="paragraph">
<p>If U.ADMIN is selected, then testing of this SFR is performed in the tests of FDP_ACF.1.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmt_mtd_1_management_of_tsf_data">2.5.4. FMT_MTD.1 Management of TSF data</h4>
<div class="sect4">
<h5 id="_guidance_documentation_19">2.5.4.1. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the administrator guidance identifies the management operations and authorized roles consistent with the SFR.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the administrator guidance describes how the assignment of roles is managed.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the administrator guidance describes how security attributes are assigned and managed.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the administrator guidance describes how the security-related rules (.e.g., access control rules, timeout, number of consecutive logon failures) are configured.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_23">2.5.4.2. Tests</h5>
<div class="paragraph">
<p>The evaluator shall perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall check to ensure that users of the given roles defined in the SFR can perform operations to TSF data in accordance with the operation methods specified in the administrator guidance.</p>
</li>
<li>
<p>The evaluator shall check to ensure that the operation results are appropriately reflected as specified in the administrator guidance.</p>
</li>
<li>
<p>The evaluator shall check to ensure that no users other than users of the given roles defined in the SFR can perform operations to TSF data.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmt_smf_1_specification_of_management_functions">2.5.5. FMT_SMF.1 Specification of Management Functions</h4>
<div class="sect4">
<h5 id="_tss_22">2.5.5.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check the TSS to ensure that the management functions are consistent with the assignment in the SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_20">2.5.5.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check the guidance documents to ensure that management functions are consistent with the assignment in the SFR, and that their operation is described.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmt_smr_1_security_roles">2.5.6. FMT_SMR.1 Security roles</h4>
<div class="sect4">
<h5 id="_tss_23">2.5.6.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of security related roles that the TOE maintains, which is consistent with the definition of the SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_24">2.5.6.2. Tests</h5>
<div class="paragraph">
<p>As for tests of this SFR, it is performed in the tests of FMT_MOF.1, FMT_MSA.1, and FMT_MTD.1.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_protection_of_the_tsf_fpt">2.6. Protection of the TSF (FPT)</h3>
<div class="sect3">
<h4 id="_fpt_sbt_ext_1_secure_boot">2.6.1. FPT_SBT_EXT.1 Secure Boot</h4>
<div class="sect4">
<h5 id="_tss_24">2.6.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall verify that the TSS describes each chain of trust and its associated Root of Trust. For each chain of trust, the evaluator shall verify:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>that the TSS describes the hash, digital signature, or message authentication verification performed by the TOE at boot.</p>
</li>
<li>
<p>that the TSS describes data and/or key contained in the Root of Trust and how they are used for firmware/software integrity verification.</p>
</li>
<li>
<p>that the TSS describes how the Root of Trust is immutable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note: Due to the proprietary nature of this information, the vendor may provide the information pertaining to the root of trust in a separate document. This document must be provided for review to the evaluation lab and the scheme for review but will not be posted on the approved products list page.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance">2.6.1.2. Guidance</h5>
<div class="paragraph">
<p>The evaluator shall examine the guidance documentation and verify that procedures are provided on the remediation of an integrity verification failure in a chain of trust.</p>
</div>
<div class="paragraph">
<p>Note: Acceptable actions for remediation of the device include reverting to a previous TOE image, reinstalling the TOE, performing a factory reset of the TOE, or contacting vendor support for assistance.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_25">2.6.1.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall carry out the following tests.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>During initial boot of the TOE, the evaluator shall review the initialization output or audit records and verify that the TOE successfully performs verification of the firmware/software.</p>
</li>
<li>
<p>For every element in each chain of trust, the evaluator shall attempt to boot the TOE using firmware/software with an invalid hash, digital signature, or message authentication verification and verify that the verification check fails and the TOE doesnt execute corrupted firmware/software.</p>
<div class="paragraph">
<p>Note: Verification of the Root of Trust is out of scope for Test 2.</p>
</div>
</li>
<li>
<p>For every element in each chain of trust, the evaluator shall attempt to boot the TOE using a corrupted firmware image and verify that upon failure, the TOE performs the action selected within FPT_SBT_EXT.1.4.</p>
<div class="paragraph">
<p>Note: Corruption of the Root of Trust is out of scope for Test 3.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>(conditional) If revert to previous TOE image is selected, the evaluator, following a failed boot attempt, shall review the guidance documentation, verifies that the TOE performed the action of reverting to a previous TOE image and confirms that the TOE returns to an operational state following the remediation action.</p>
<div class="paragraph">
<p>Note: The administrator might need to take an action to perform the remediation action.</p>
</div>
</li>
<li>
<p>(conditional) If reinstall TOE image is selected, the evaluator, following a failed boot attempt, shall review the guidance documentation, verifies that the TOE performed the action of reinstalling the TOE image and confirms that the TOE returns to an operational state following the remediation action.</p>
<div class="paragraph">
<p>Note: The administrator might need to take an action to perform the remediation action.</p>
</div>
</li>
<li>
<p>(conditional) If perform factory reset is selected, the evaluator, following a failed boot attempt, shall review the guidance documentation, verifies that the TOE performs a factory reset and confirms that the TOE returns to an initialized state where it can be returned into an operational state following the remediation action.</p>
<div class="paragraph">
<p>Note: The administrator might need to take an action to perform the remediation action.</p>
</div>
</li>
<li>
<p>(conditional) If indicate a need to contact vendor support is selected, the evaluator, following a failed boot attempt, shall review the guidance documentation and verifies that the TSF provides an indication to contact vendor support.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fpt_skp_ext_1_protection_of_tsf_data">2.6.2. FPT_SKP_EXT.1 Protection of TSF Data</h4>
<div class="sect4">
<h5 id="_tss_25">2.6.2.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to determine that it details how any pre-shared keys, symmetric keys, and private keys are stored and that they are unable to be viewed through an interface designed specifically for that purpose, as outlined in the application note. If these values are not stored in plaintext, the TSS shall describe how they are protected/obscured.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fpt_stm_1_reliable_time_stamps">2.6.3. FPT_STM.1 Reliable time stamps</h4>
<div class="sect4">
<h5 id="_tss_26">2.6.3.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS describes mechanisms that provide reliable time stamps.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_21">2.6.3.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the guidance describes the method of setting the time.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_26">2.6.3.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall check to ensure that the time is correctly set up in accordance with the guidance or external network services (e.g., NTP).</p>
</li>
<li>
<p>The evaluator shall check to ensure that the time stamps are appropriately provided.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fpt_tst_ext_1_tsf_testing">2.6.4. FPT_TST_EXT.1 TSF testing</h4>
<div class="sect4">
<h5 id="_tss_27">2.6.4.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to ensure that it details the self-tests that are run by the TSF on start-up; this description should include an outline of what the tests are actually doing (e.g., rather than saying "memory is tested", a description similar to "memory is tested by writing a value to each memory location and reading it back to ensure it is identical to what was written" shall be used). The evaluator shall ensure that the TSS makes an argument that the tests are sufficient to demonstrate that the TSF is operating correctly.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_22">2.6.4.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall also ensure that the operational guidance describes the possible errors that may result from such tests, and actions the administrator should take in response; these possible errors shall correspond to those described in the TSS.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_27">2.6.4.3. Tests</h5>
<div class="paragraph">
<p>Self-test is intended to detect malfunctions which may compromise the TSF. Since the integrity of the firmware/software is guaranteed by FPT_SBT_EXT, the function for FPT_TST_EXT should address the malfunction detection like DRBG self-test defined in ISO/IEC 18031:2011.</p>
</div>
<div class="paragraph">
<p>Although formal compliance is not mandated, the self-tests performed should aim for a level of confidence comparable to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>[FIPS 140-2], chap. 4.9.1, Cryptographic algorithm test for the verification of the correct operation of cryptographic functions.
Alternatively, national requirements of any CCRA member state for the security evaluation of cryptographic functions should be considered as appropriate.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The evaluator shall either verify that the self-tests described above are carried out during initial start-up or that the developer has justified any deviation from this.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fpt_tud_ext_1_trusted_update">2.6.5. FPT_TUD_EXT.1 Trusted Update</h4>
<div class="sect4">
<h5 id="_tss_28">2.6.5.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of mechanisms that verify software for update when performing updates, which is consistent with the definition of the SFR.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS identifies interfaces for administrators to obtain the current version of the TOE as well as interfaces to perform updates.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_23">2.6.5.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the administrator guidance contains descriptions of the operation methods to obtain the TOE version as well as the operation methods to start update processing, which are consistent with the description of the TSS.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_28">2.6.5.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall check to ensure the current version of the TOE can be appropriately obtained by means of the operation methods specified by the administrator guidance.</p>
</li>
<li>
<p>The evaluator shall check to ensure that the verification of the data for updates of the TOE succeeds using authorized data for updates by means of the operation methods specified by the administrator guidance.</p>
</li>
<li>
<p>The evaluator shall check to ensure that only administrators can implement the application for updates using authorized data for updates.</p>
</li>
<li>
<p>The evaluator shall check to ensure that the updates are correctly performed by obtaining the current version of the TOE after the normal updates finish.</p>
</li>
<li>
<p>The evaluator shall check to ensure that the verification of the data for updates of the TOE fails using unauthorized data for updates by means of the operation methods specified by the administrator guidance. (The evaluator shall also check those cases where hash verification mechanism, if selected in FPT_TUD_EXT.1.3, and digital signature verification mechanism fail.)</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_toe_access_fta">2.7. TOE Access (FTA)</h3>
<div class="sect3">
<h4 id="_fta_ssl_3_tsf_initiated_termination">2.7.1. FTA_SSL.3 TSF-initiated termination</h4>
<div class="sect4">
<h5 id="_tss_29">2.7.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS describes the types of user sessions to be terminated (e.g., user sessions via operation panel or Web interfaces) after a specified period of user inactivity.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_24">2.7.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the guidance describes the default time interval and, if it is settable, the method of setting the time intervals until the termination of the session.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_29">2.7.1.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If it is settable, the evaluator shall check to ensure that the time until the termination of the session can be set up by the method of setting specified in the administrator guidance.</p>
</li>
<li>
<p>The evaluator shall check to ensure that the session terminates after the specified time interval.</p>
</li>
<li>
<p>The evaluator shall perform the tests 1 and 2 described above for all the user sessions identified in the TSS.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_trusted_channels_ftp">2.8. Trusted Channels (FTP)</h3>
<div class="sect3">
<h4 id="_ftp_itc_1_inter_tsf_trusted_channel">2.8.1. FTP_ITC.1 Inter-TSF trusted channel</h4>
<div class="sect4">
<h5 id="_tss_30">2.8.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to determine that, for all communications with authorized IT entities identified in the requirement, each secure  communications mechanism is identified in terms of the allowed protocols for that IT entity.  The evaluator shall also confirm that all protocols listed in the TSS are specified and included in the requirements in the ST.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_25">2.8.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall confirm that the operational guidance contains instructions for establishing the allowed protocols with each authorized IT entity, and that it contains recovery instructions should a connection be unintentionally broken.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_30">2.8.1.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluators shall ensure that communications using each protocol with each authorized IT entity is tested during the course of the evaluation, setting up the connections as described in the operational guidance and ensuring that communication is successful.</p>
</li>
<li>
<p>For each protocol that the TOE or trusted IT entity can initiate as defined in the requirement, the evaluator shall follow the operational guidance to ensure that in fact the communication channel can be initiated from the TOE / trusted IT entity.</p>
</li>
<li>
<p>The evaluator shall ensure, for each communication channel with an authorized IT entity, the channel data are not sent in plaintext.</p>
</li>
<li>
<p>The evaluator shall ensure, for each protocol associated with each authorized IT entity tested during test 1, the connection is physically interrupted.  The evaluator shall ensure that when physical connectivity is restored, communications are appropriately protected.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Further assurance activities are associated with the specific protocols.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ftp_trp_1admin_trusted_path_for_administrators">2.8.2. FTP_TRP.1/Admin Trusted path (for Administrators)</h4>
<div class="sect4">
<h5 id="_tss_31">2.8.2.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to determine that the methods of remote TOE administration are indicated, along with how those communications are protected.  The evaluator shall also confirm that all protocols listed in the TSS in support of TOE administration are consistent with those specified in the requirement, and are included in the requirements in the ST.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_26">2.8.2.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall confirm that the operational guidance contains instructions for establishing the remote administrative sessions for each supported method.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_31">2.8.2.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluators shall ensure that communications using each specified (in the operational guidance) remote administration method is tested during the course of the evaluation, setting up the connections as described in the operational guidance and ensuring that communication is successful.</p>
</li>
<li>
<p>For each method of remote administration supported, the evaluator shall follow the operational guidance to ensure that there is no available interface that can be used by a remote user to establish a remote administrative session without invoking the trusted path.</p>
</li>
<li>
<p>The evaluator shall ensure, for each method of remote administration, the channel data are not sent in plaintext.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Further assurance activities are associated with the specific protocols.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_evaluation_activities_for_conditionally_mandatory_requirements">3. Evaluation Activities for Conditionally Mandatory Requirements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_confidential_data_on_nonvolatile_storage_devices">3.1. Confidential Data on Nonvolatile Storage Devices</h3>
<div class="sect3">
<h4 id="_fpt_kyp_ext_1_protection_of_key_and_key_material">3.1.1. FPT_KYP_EXT.1 Protection of Key and Key Material</h4>
<div class="sect4">
<h5 id="_tss_32">3.1.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS and verify it identifies the methods used to protect keys stored in nonvolatile memory.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kmd_3">3.1.1.2. KMD</h5>
<div class="paragraph">
<p>The evaluator shall verify the KMD to ensure it describes the storage location of all keys and the protection of all keys stored in nonvolatile memory. The description of the key chain shall be reviewed to ensure the selected method is followed for the storage of wrapped or encrypted keys in nonvolatile memory and plaintext keys in nonvolatile memory meet one of the exemptions under the selection only store plaintext keys that meet any one of the following criteria.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_kyc_ext_1_key_chaining">3.1.2. FCS_KYC_EXT.1 Key Chaining</h4>
<div class="sect4">
<h5 id="_tss_33">3.1.2.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall verify that the TSS contains a high-level description of the BEV sizes  that it supports BEV outputs of no fewer 128 bits for products that support only AES-128, and that no fewer than 256 bits for products that support AES-256.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kmd_4">3.1.2.2. KMD</h5>
<div class="paragraph">
<p>The evaluator shall examine the KMD to ensure that it describes a high level description of the key hierarchy for all accepted BEVs. The evaluator shall examine the KMD to ensure it describes the key chain in detail. The description of the key chain shall be reviewed to ensure it maintains a chain of keys using key wrap, submask combining, or key encryption.</p>
</div>
<div class="paragraph">
<p>The evaluator shall examine the KMD to ensure that it describes how the key chain process functions, such that it does not expose any material that might compromise any key in the chain. (e.g., using a key directly as a compare value against a TPM) This description must include a diagram illustrating the key hierarchy implemented and detail where all keys and keying material is stored or what it is derived from. The evaluator shall examine the key hierarchy to ensure that at no point the chain could be broken without a cryptographic exhaust or the initial authorization value and the effective strength of the BEV is maintained throughout the key chain.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the KMD includes a description of the strength of keys throughout the key chain.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the KMD description describes how the start (or root) of key chain is protected if it is protected by another key that is not in the key chain or a protected storage device. One approach the evaluator can take is to make sure that the device, which protects the start (or root) of key chain, is a protected storage device or separate co-processor by inspection of type identifier of the device or published document referred from KMD. But the evaluator does not need to verify the protection method in detail for the start (or root) of key chain if the key to protect is not in the key chain specified in FCS_KYC_EXT.1. Also the evaluator does not need to verify the protection method implemented in the protected storage device if the key is stored in the protected storage device.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fdp_dsk_ext_1_protection_of_data_on_disk">3.1.3. FDP_DSK_EXT.1 Protection of Data on Disk</h4>
<div class="paragraph">
<p>In the EAs, below, Device refers to the Nonvolatile Storage Device from FDP_DSK_EXT.1. If the TOE contains more than one applicable Device, then the EAs are performed as necessary on each such Device.</p>
</div>
<div class="sect4">
<h5 id="_tss_34">3.1.3.1. TSS</h5>
<div class="paragraph">
<p>If  the self-encrypting device option is selected, the Device must be certified in conformance to the current Full Disk Encryption collaborative Protection Profile. The tester shall confirm that the specific SED is listed in the TSS, documented and verified to be CC certified against the FDE EE cPP.</p>
</div>
<div class="paragraph">
<p>The evaluator shall examine the TSS to ensure that the description is comprehensive in how the data is written to the Device and the point at which the encryption function is applied.</p>
</div>
<div class="paragraph">
<p>For the cryptographic functions that are provided by the Operational Environment, the evaluator shall check the TSS to ensure it describes the interface(s) used by the TOE to invoke this functionality.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify that the TSS describes the initialization of the Device at shipment of the TOE, or by the activities the TOE performs to ensure that it encrypts all the storage devices entirely when a user or administrator first provisions the Device.  The evaluator shall verify the TSS describes areas of the Device that it does not encrypt (e.g., portions that do not contain confidential data boot loaders, partition tables, etc.).</p>
</div>
<div class="paragraph">
<p>If data (e.g., D.USER.JOB, D.TSF.PROT) other than D.USER.DOC and D.TSF.CONF are encrypted, the evaluator shall verify that TSS identifies all such data and states that no other customer-supplied data are encrypted.</p>
</div>
<div class="paragraph">
<p>If any D.USER.DOC or D.TSF.CONF are transparently encrypted and written to disk via mechanisms other than operating TSFI, the evaluator shall verify that the TSS identifies those mechanisms and describes at a high level how the associated data are encrypted. The swap files and core dump may potentially contain D.USER.DOC or D.TSF.CONF and should be considered.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_27">3.1.3.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall review the AGD guidance to determine that it describes the initial steps needed to enable the Device encryption function, including any necessary preparatory steps. The guidance shall provide instructions that are sufficient to ensure that all Devices will be encrypted when encryption is enabled or at shipment of the TOE. If the TOE supports multiple Device encryptions, the evaluator shall examine the administration guidance to ensure the initialization procedure encrypts all Devices.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kmd_5">3.1.3.3. KMD</h5>
<div class="paragraph">
<p>The evaluator shall verify the KMD includes a description of the data encryption engine, its components, and details about its implementation (e.g., for hardware: integrated within the devices main SOC or separate co-processor, for software: initialization of the Device, drivers, libraries (if applicable), logical interfaces for encryption/decryption, and areas which are not encrypted (e.g., boot loaders, portions that do not contain confidential data, partition tables, etc.)). The evaluator shall verify the KMD provides a functional (block) diagram showing the main components (such as memories and processors) and the data path between, for hardware, the Devices interface and the Devices persistent media storing the data, or for software, the initial steps needed to the activities the TOE performs to ensure it encrypts the storage device entirely when a user or administrator first provisions the product. The hardware encryption diagram shall show the location of the data encryption engine within the data path. The evaluator shall validate that the hardware encryption diagram contains enough detail showing the main components within the data path and that it clearly identifies the data encryption engine.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the KMD provides sufficient instructions to ensure that when the encryption is enabled, the TOE encrypts all Nonvolatile Storage  Devices.  The evaluator shall verify that the KMD describes the data flow from the interface to the Devices persistent media storing the data. The evaluator shall verify that the KMD provides information on those conditions in which the data bypasses the data encryption engine (e.g., read-write operations to an unencrypted area).</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify that the KMD provides a description of the boot initialization, the encryption initialization process, and at what moment the product enables the encryption. If encryption can be enabled and disabled, the evaluator shall ensure the KMD contains a description of how data is protected from transfer before cryptographic initialization.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_32">3.1.3.4. Tests</h5>
<div class="paragraph">
<p>The evaluator shall perform the following tests:</p>
</div>
<div class="paragraph">
<p>Test 1. Write data to Storage device: Perform writing to the storage device with operating TSFI which enforce write process of D.USER.DOC and D.TSF.CONF.</p>
</div>
<div class="paragraph">
<p>Test 2. Confirm that written data are encrypted: Verify there are no plaintext data present in the encrypted range written by Test 1; and, verify that the data can be decrypted by proper key and key material.</p>
</div>
<div class="paragraph">
<p>All TSFIs for writing D.USER.DOC and D.TSF.CONF should be tested by Test 1 and Test 2 above.</p>
</div>
<div class="paragraph">
<p>Test 3. [Conditional: If the ST author claims FPT_WIPE_EXT.1 with cryptographic erase, and if data other than D.USER.DOC and D.TSF.CONF are encrypted] Write the data to the storage device with operating TSFI which enforce write process of the data.</p>
</div>
<div class="paragraph">
<p>Test 4. [Conditional: If the ST author claims FPT_WIPE_EXT.1 with cryptographic erase, and if data other than D.USER.DOC and D.TSF.CONF are encrypted] Verify that the data written in Test 3 is not in plaintext form; and verify that the data can be decrypted by proper key and key material.</p>
</div>
<div class="paragraph">
<p>Test 5. [Conditional: If any D.USER.DOC or D.TSF.CONF are transparently encrypted and written to disk via mechanisms other than operating TSFI] Using a special tooling that the developer shall provide, the evaluator shall write the known data to the storage through transparent encryption.</p>
</div>
<div class="paragraph">
<p>Test 6. [Conditional: If any D.USER.DOC or D.TSF.CONF are transparently encrypted and written to disk via mechanisms other than operating TSFI] Verify that the data written in Test 5 is not in plaintext form; and verify that the data can be decrypted by proper key and key material.</p>
</div>
<div class="paragraph">
<p>Test 5 and Test 6 should be performed for each mechanism not involving the operation of TSFIs described in the TSS.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pstn_fax_network_separation">3.2. PSTN Fax-Network Separation</h3>
<div class="sect3">
<h4 id="_fdp_fxs_ext_1_fax_separation">3.2.1. FDP_FXS_EXT.1 Fax separation</h4>
<div class="paragraph">
<p>The following assurance activities are required when the TOE has a fax communication function to transmit and receive via PSTN.</p>
</div>
<div class="sect4">
<h5 id="_tss_35">3.2.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall check the TSS to ensure that it describes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The fax interface use cases</p>
</li>
<li>
<p>The capabilities of the fax modem and the supported fax protocols</p>
</li>
<li>
<p>The data that is allowed to be sent or received via the fax interface</p>
</li>
<li>
<p>How the TOE can only be used for transmitting or receiving User Data using fax protocols</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_28">3.2.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the operational guidance contains a description of the fax interface in terms of usage and available features.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_33">3.2.1.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall test to ensure that the fax interface can only be used for transmitting or receiving User Data using fax protocols. Testing will be dependent upon how the TOE enforces this requirement. The following tests shall be used and supplemented with additional testing or a rationale as to why the following tests are sufficient:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verify that the TOE accepts incoming calls using fax carrier protocols and rejects calls that use data carriers. For example, this may be achieved using a terminal application to issue modem commands directly to the TOE from a PC modem (issue terminal command: ATDT &lt;TOE Fax Number&gt;)  the TOE should answer the call and disconnect.</p>
</li>
<li>
<p>Verify TOE negotiates outgoing calls using fax carrier protocols and rejects negotiation of data carriers. For example, this may be achieved by using a PC modem to attempt to receive a call from the TOE (submit a fax job from the TOE to &lt;PC modem number&gt;, at PC issue terminal command: ATA)  the TOE should disconnect without negotiating a carrier.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_asymmetric_key_generation">3.3. Asymmetric Key Generation</h3>
<div class="sect3">
<h4 id="_fcs_ckm_1akg_cryptographic_key_generation_for_asymmetric_keys">3.3.1. FCS_CKM.1/AKG Cryptographic Key Generation (for asymmetric keys)</h4>
<div class="sect4">
<h5 id="_tss_36">3.3.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall ensure that the TSS identifies the key sizes supported by
the TOE. If the ST specifies more than one scheme, the evaluator shall
examine the TSS to verify that it identifies the usage for each scheme.</p>
</div>
<div class="paragraph">
<p>The TSS may refer to the KMD, described in Appendix F of <a href="#HCDcPP">[HCDcPP]</a>, that may not be made available to the public.</p>
</div>
<div class="paragraph">
<p>The evaluator shall examine the TOE summary specification to verify that it describes how the TOE obtains a key based on input from a random bit generator as specified in FCS_RBG_EXT.1. The evaluator shall review the TOE summary specification to verify that it describes how the functionality described by FCS_RBG_EXT.1 is invoked.</p>
</div>
<div class="paragraph">
<p>If the TOE uses the generated key in a key chain/hierarchy, then the evaluator shall examine the TOE summary specification to confirm that it describes the followings:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>if KCDSA is selected, then the TOE summary specification describes which methods for generating p and q are used, and</p>
</li>
<li>
<p>how the key is used as part of the key chain/hierarchy</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_29">3.3.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall verify that the AGD guidance instructs the administrator
how to configure the TOE to use the selected key generation scheme(s) and
key size(s) for all cryptographic protocols defined in the Security Target.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_34">3.3.1.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall include test cases of FCS_CKM.1/AKG to the test subset. Note that FCS_CKM.1/AKG may be not mapped to the specific interface(s) after evaluators analysis during ADV_FSP.1.</p>
</div>
<div class="paragraph">
<p>The evaluator shall produce test documentation for test cases of FCS_CKM.1/AKG. If there is no explicit external interface(s) mapped to FCS_CKM.1/AKG, the evaluator shall employ an alternative test approach (refer to CEM, section 15.2.2.)</p>
</div>
<div class="paragraph">
<p>Note: The following tests require the developer to provide access to a test
platform that provides the evaluator with tools that are typically not found on
factory products. Generation of long-term cryptographic keys (i.e. keys that
are not ephemeral keys/session keys) might be performed automatically (e.g.
during initial start-up). Testing of key generation must cover not only
administrator invoked key generation but also automated key generation (if
supported).</p>
</div>
<div class="paragraph">
<p><strong>Key Generation for FIPS PUB 186-4 RSA Schemes</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the implementation of RSA Key Generation by the
TOE using the Key Generation test. This test verifies the ability of the TSF to
correctly produce values for the key components including the public
verification exponent <em>e</em>, the private prime factors <em>p</em> and <em>q</em>, the public modulus
<em>n</em> and the calculation of the private signature exponent <em>d</em>.</p>
</div>
<div class="paragraph">
<p>Key Pair generation specifies 5 ways (or methods) to generate the primes <em>p</em>
and <em>q</em>. These include:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Random Primes:</p>
<div class="ulist">
<ul>
<li>
<p>Provable primes</p>
</li>
<li>
<p>Probable primes</p>
</li>
</ul>
</div>
</li>
<li>
<p>Primes with Conditions:</p>
<div class="ulist">
<ul>
<li>
<p>Primes p1, p2, q1, q2, p and q shall all be provable primes</p>
</li>
<li>
<p>Primes p1, p2, q1, and q2 shall be provable primes and p and q
shall be probable primes</p>
</li>
<li>
<p>Primes p1, p2, q1, q2, p and q shall all be probable primes</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>To test the key generation method for the Random Provable primes method
and for all the Primes with Conditions methods, the evaluator must seed the
TSF key generation routine with sufficient data to deterministically generate
the RSA key pair. This includes the random seed(s), the public exponent of
the RSA key, and the desired key length. For each key length supported, the
evaluator shall have the TSF generate 25 key pairs. The evaluator shall verify
the correctness of the TSFs implementation by comparing values generated
by the TSF with those generated from a known good implementation.</p>
</div>
<div class="paragraph">
<p><strong>Key Generation for Elliptic Curve Cryptography (ECC)</strong></p>
</div>
<div class="paragraph">
<p><em>FIPS 186-4 ECC Key Generation Test</em></p>
</div>
<div class="paragraph">
<p>For each supported NIST curve, i.e., P-256, P-384 and P-521, the evaluator
shall require the implementation under test (IUT) to generate 10 private/public
key pairs. The private key shall be generated using an approved random bit
generator (RBG). To determine correctness, the evaluator shall submit the
generated key pairs to the public key verification (PKV) function of a known
good implementation.</p>
</div>
<div class="paragraph">
<p><em>FIPS 186-4 Public Key Verification (PKV) Test</em></p>
</div>
<div class="paragraph">
<p>For each supported NIST curve, i.e., P-256, P-384 and P-521, the evaluator
shall generate 10 private/public key pairs using the key generation function of
a known good implementation and modify five of the public key values so that
they are incorrect, leaving five values unchanged (i.e., correct). The evaluator
shall obtain in response a set of 10 PASS/FAIL values.</p>
</div>
<div class="paragraph">
<p><strong>Key Generation for Finite-Field Cryptography (FFC)</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the implementation of the Parameters Generation
and the Key Generation for FFC by the TOE using the Parameter Generation
and Key Generation test. This test verifies the ability of the TSF to correctly
produce values for the field prime p, the cryptographic prime q (dividing p-1),
the cryptographic group generator g, and the calculation of the private key x
and public key y.</p>
</div>
<div class="paragraph">
<p>The Parameter generation specifies 2 ways (or methods) to generate the
cryptographic prime q and the field prime p:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Primes q and p shall both be provable primes</p>
</li>
<li>
<p>Primes q and field prime p shall both be probable primes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and two ways to generate the cryptographic group generator g:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Generator g constructed through a verifiable process</p>
</li>
<li>
<p>Generator g constructed through an unverifiable process.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Key generation specifies 2 ways to generate the private key x:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>len(q) bit output of RBG where 1 &lt;=x &lt;= q-1</p>
</li>
<li>
<p>len(q) + 64 bit output of RBG, followed by a mod q-1 operation
and a +1 operation, where 1&lt;= x&lt;=q-1.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The security strength of the RBG must be at least that of the security offered
by the FFC parameter set.</p>
</div>
<div class="paragraph">
<p>To test the cryptographic and field prime generation method for the provable
primes method and/or the group generator g for a verifiable process, the
evaluator must seed the TSF parameter generation routine with sufficient data
to deterministically generate the parameter set.</p>
</div>
<div class="paragraph">
<p>For each key length supported, the evaluator shall have the TSF generate 25
parameter sets and key pairs. The evaluator shall verify the correctness of the
TSFs implementation by comparing values generated by the TSF with those
generated from a known good implementation. Verification must also confirm</p>
</div>
<div class="ulist">
<ul>
<li>
<p>g != 0,1</p>
</li>
<li>
<p>q divides p-1</p>
</li>
<li>
<p>g^q mod p = 1</p>
</li>
<li>
<p>g^x mod p = y</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>for each FFC parameter set and key pair.</p>
</div>
<div class="paragraph">
<p><em>Diffie-Hellman Group 14 and FFC Schemes using safe-prime groups</em></p>
</div>
<div class="paragraph">
<p>Testing for FFC Schemes using Diffie-Hellman group 14 and/or safe-prime
groups is done as part of testing in CKM.2.1.</p>
</div>
<div class="paragraph">
<p><strong>Key Generation for KCDSA</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the implementation of KCDSA Key Generation by the TOE using the Key Generation test. This test verifies the ability of the TSF to correctly produce values for the key components including the private signing exponent x, the public verification exponent y, the private prime factor p and q, the generator g.</p>
</div>
<div class="paragraph">
<p>FIPS 186-4 Key Pair generation specifies 2 methods for generating the primes p and q.</p>
</div>
<div class="paragraph">
<p>These are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Primes p and q shall both be probable primes</p>
</li>
<li>
<p>Primes p and q shall both be provable primes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and two ways to generate the cryptographic group generator g:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Generator g constructed through a verifiable process</p>
</li>
<li>
<p>Generator g constructed through an unverifiable process.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Key generation specifies 2 ways to generate the private key x: Private Key:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>len(q) bit output of RBG where 1 &lt;=x &lt;= q-1</p>
</li>
<li>
<p>len(q) + 64 bit output of RBG, followed by a mod q-1 operation and +1 operation where 1&lt;= x&lt;=q-1.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To test the key generation method for the Probable primes method and Provable primes method, the evaluator must seed the TSF key generation routine with sufficient data to deterministically generate the KCDSA key pair.</p>
</div>
<div class="paragraph">
<p>For each key length supported, the evaluator shall have the TSF generate 10 key pairs. The evaluator shall verify the correctness of the TSFs implementation by comparing values generated by the TSF with those generated by a known good implementation using the same input parameters.</p>
</div>
<div class="paragraph">
<p>If the TOE generates Random Probable Primes then if possible, the Random Probable primes method should also be verified against a known good implementation as described above. If verification against a known good implementation is not possible, the evaluator shall have the TSF generate 25 key pairs for each supported key length and verify that all of the following are true:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>2^(len(p)-1)&lt;p&lt;2^(len(p))</p>
</li>
<li>
<p>2^(len(q)-1)&lt;p&lt;2^(len(q))</p>
</li>
<li>
<p>q divides p-1</p>
</li>
<li>
<p>1&lt;g&lt;p-1</p>
</li>
<li>
<p>g^((p-1)/q) mod p&gt;1</p>
</li>
<li>
<p>0&lt;x&lt;q</p>
</li>
<li>
<p>g^q mod p =1</p>
</li>
<li>
<p>g^x mod p=y.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Key Generation for EC-KCDSA</strong></p>
</div>
<div class="paragraph">
<p><strong><em>ECC Key Generation Test</em></strong></p>
</div>
<div class="paragraph">
<p>For each selected curve, and for each key pair generation method as described in FIPS 186-4, section B.4, the evaluator shall require the implementation under test to generate 10 private/public key pairs (d, Q=d^(-1) G), where G is a base point. The private key, d, shall be generated using a random bit generator as specified in FCS_RBG_EXT.1. The private key, d, is used to compute the public key, Q. The evaluator shall confirm that 0&lt;d&lt;n (where n is the order of the group), and the computed value Q is then compared to the generated public/private key pairs public key, Q, to confirm that Q is equal to Q.</p>
</div>
<div class="paragraph">
<p><strong><em>Public Key Validation (PKV) Test</em></strong></p>
</div>
<div class="paragraph">
<p>For each supported curve, the evaluator shall generate 10 private/public key pairs using the key generation function of a known good implementation and modify some public key values so that they are incorrect, leaving values unchanged (i.e., correct). To determine correctness, the evaluator shall submit the 10 key pairs to the public key validation (PKV) function of the TOE and shall confirm that the results correspond as expected to the modified and unmodified values.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_network_communications">3.4. Network Communications</h3>
<div class="sect3">
<h4 id="_ftp_trp_1nonadmin_trusted_path_for_non_administrators">3.4.1. FTP_TRP.1/NonAdmin Trusted path (for Non-administrators)</h4>
<div class="sect4">
<h5 id="_tss_37">3.4.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to determine that the methods of remote TOE access for non-administrative users are indicated, along with how those communications are protected.</p>
</div>
<div class="paragraph">
<p>The evaluator shall also confirm that all protocols listed in the TSS in support of remote TOE access are consistent with those specified in the requirement, and are included in the requirements in the ST.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_30">3.4.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall confirm that the operational guidance contains instructions for establishing the remote user sessions for each supported method.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_35">3.4.1.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluators shall ensure that communications using each specified (in the operational guidance) remote user access method is tested during the course of the evaluation, setting up the connections as described in the operational guidance and ensuring that communication is successful.</p>
</li>
<li>
<p>For each method of remote access supported, the evaluator shall follow the operational guidance to ensure that there is no available interface that can be used by a remote user to establish a remote user session without invoking the trusted path.</p>
</li>
<li>
<p>The evaluator shall ensure, for each method of remote user access, the channel data are not sent in plaintext.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Further EAs are associated with the specific protocols.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_evaluation_activities_for_optional_requirements">4. Evaluation Activities for Optional Requirements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_user_doc_unavailability">4.1. USER.DOC Unavailability</h3>
<div class="sect3">
<h4 id="_fdp_udu_ext_document_unavailability">4.1.1. FDP_UDU_EXT Document Unavailability</h4>
<div class="sect4">
<h5 id="_tss_38">4.1.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to ensure that the description is comprehensive in describing where image data is stored and how and when it is overwritten.</p>
</div>
<div class="paragraph">
<p>The evaluator shall examine the TSS to ensure that the TSS states whether the TOE stores D.USER.DOC on any wear-leveling storage device.</p>
</div>
<div class="paragraph">
<p>The evaluator shall examine the TSS to ensure that the TSS describes the type(s) of overwrite (e.g., single overwrite with zeros) of D.USER.DOC that the TOE performs.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_31">4.1.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the operational guidance describes the type(s) of overwrite (e.g., single overwrite with zeros) of user document data that the TOE performs.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_36">4.1.1.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall include tests related to this function in the set of tests performed in FMT_SMF.1.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_wiping">4.2. Data Wiping</h3>
<div class="sect3">
<h4 id="_fpt_wipe_ext_data_wiping">4.2.1. FPT_WIPE_EXT Data Wiping</h4>
<div class="sect4">
<h5 id="_tss_39">4.2.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to ensure that the description is comprehensive in describing what customer-supplied data is to be wiped, where it is stored, and how it is made unavailable.</p>
</div>
<div class="paragraph">
<p>If a media-specific method is selected, the evaluator shall ensure that the TSS describes the method in sufficient detail to determine whether any encrypted D.USER or D.TSF remains on the storage media.</p>
</div>
<div class="paragraph">
<p>If multiple methods are specified, the evaluator shall ensure that the description clearly states what methods are used for each type of storage and/or customer-supplied data.</p>
</div>
<div class="paragraph">
<p>The evaluator shall ensure the storage medium(s) subject to overwrite are identified and the storage medium(s) leverage functionality that matches the selection on wear-leveling.</p>
</div>
<div class="paragraph">
<p>The evaluator shall examine the TSS to ensure that the TSS describes the type(s) of overwrite (e.g., single overwrite with zeros) of D.USER.DOC that the TOE performs.</p>
</div>
<div class="paragraph">
<p>If FPT_WIPE_EXT.1 claims all the customer-supplied information is made unavailable using cryptographic erase only, the evaluator shall confirm that all the customer-supplied information is encrypted by the TSF according to FDP_DSK_EXT.1.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_32">4.2.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check to ensure that the operational guidance contains instructions for initiating the Wipe function.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the operational guidance describes the type(s) of information that is wiped, and the method(s) used.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the operational guidance describes the indication to administrators that the wipe is in progress (optional) and that the wipe completes.</p>
</div>
<div class="paragraph">
<p>If a wipe method is used that leaves any encrypted D.USER or D.TSF on the storage media, the evaluator shall check to ensure that the operational guidance includes a statement cautioning the user about that condition.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check to ensure that the operational guidance describes the type(s) of overwrite (e.g., single overwrite with zeros) of user document data that the TOE performs.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_37">4.2.1.3. Tests</h5>
<div class="paragraph">
<p><em>Tests activities consists of the six tests below. Test 2 and 6 are mandatory in all cases. Tests 3, 4, and 5 are conditional on the wipe method selected by the ST author.</em></p>
</div>
<div class="paragraph">
<p>Test 1: [Conditional: D.USER can be stored in nonvolatile memory] Cause the TOE to contain and retain some type of D.USER containing known text strings or byte array in nonvolatile memory (e.g., submit a print job when no paper is loaded in the HCD. This will ensure that the job will remain in the HCD for reference in Test 6). Verify that the D.USER data is present on the TOE. For example, it is sufficient to verify that a print job is on the HCD.</p>
</div>
<div class="paragraph">
<p>Test 2: The evaluator shall perform the following steps to verify that a wipe function can be initiated by an authorized administrator and that the TOE provides feedback about the status of the wipe operation.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Initiate a wipe.</p>
</li>
<li>
<p>If the guidance documentation indicates that status information about the wipe operation is provided during the process, the evaluator shall verify that the status information is provided as described.</p>
</li>
<li>
<p>The evaluator shall verify that the indication of completion of the wipe operation is provided as described in the guidance documentation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>All the following tests are dependent on Test 2 being performed.</p>
</div>
<div class="paragraph">
<p>Test 3: [<em>Conditional: If a media-specific method or block erase is selected</em>] Using a debug log or special tooling that the developer shall provide, the evaluator shall verify that the media-specific method or block erase command is executed.</p>
</div>
<div class="paragraph">
<p>This test verifies the execution of the media-specific method or block erase command.</p>
</div>
<div class="paragraph">
<p>Test 4: [<em>Conditional: If overwrite is selected</em>] The evaluator shall verify that locations on the storage media available for D.USER and/or D.TSF have been set to the pattern specified in the SFR.  This test may require forensic tools to be installed on the HCD, or for the storage media to be moved to a separate system equipped with forensic tools.  At minimum, the evaluator shall examine the storage locations specified in the following table for the specified storage types.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Storage Media Type</th>
<th class="tableblock halign-left valign-top">Locations Examined</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Magnetic Media</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>First 2049 sectors of the disk/partition</p>
</li>
<li>
<p>129 sectors before and after the middle of the disk/partition, including the middle sector</p>
</li>
<li>
<p>Last 1025 sectors of the disk/partition</p>
</li>
<li>
<p>10 separate sectors chosen by the tester at random in the remaining area of the disk/partition</p>
</li>
<li>
<p>If the disk/partition has over 268,435,456 sectors (28-bit Logical Block Addressing (LBA) limit) then sectors 268,435,327 to 268,435,585 sectors of the disk/partition</p>
</li>
<li>
<p>If the disk/partition has over 4,294,967,296 sectors (32-bit LBA limit) then sectors 4,294,967,167 to 4,294,967,425 sectors of the disk/partition</p>
</li>
<li>
<p>Sectors that the tester believes should be tested, if any</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Flash-based storage</p>
</div>
<div class="paragraph">
<p>(including wear-leveling media)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>First 2049 logical sectors of the disk</p>
</li>
<li>
<p>129 logical sectors before and after the middle of the disk, including the middle logical sector</p>
</li>
<li>
<p>Last 1025 logical sectors of the disk</p>
</li>
<li>
<p>10 separate logical sectors chosen by the tester at random in the remaining area of the disk</p>
</li>
<li>
<p>If the disk has over 268,435,456 logical sectors (28-bit Logical Block Addressing (LBA) limit) then logical sectors 268,435,327 to 268,435,585 logical sectors of the disk</p>
</li>
<li>
<p>If the disk has over 4,294,967,296 logical sectors (32-bit LBA limit) then logical sectors 4,294,967,167 to 4,294,967,425 logical sectors of the disk</p>
</li>
<li>
<p>Logical sectors that the tester believes should be tested, if any.</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Test 5: [Conditional: The case cryptographic erase is selected] The evaluator shall verify that the appropriate key(s) according to the KMD description required by FCS_CKM_EXT.4 has been destroyed in the method described in the Test Assurance Activity for FCS_CKM.4.</p>
</div>
<div class="paragraph">
<p>Test 6: The evaluator shall verify that known text strings or byte array for D.USER and D.TSF are not found on the nonvolatile storage media after wipe has been performed. In some cases, cryptographic erase would make unable to read data from the storage media. In that case, failed to read data with error can be considered as not found. This test may require special tools to be installed on the TOE, or for the storage media to be moved to a separate system equipped with special tools provided by the TOE developer as necessary. The evaluator shall examine the storage media as specified in the following table for the indicated search patterns. This test is not applicable to protected storage devices (e.g., TPMs) that do not provide direct access to their storage.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Data Type</th>
<th class="tableblock halign-left valign-top">Search Patterns</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D.USER</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Known text strings or byte array from Test 1 that was stored on the TOE prior to the wipe being performed.</p>
</div>
<div class="paragraph">
<p>Note: If the TOE does not store D.USER data in nonvolatile memory (reference Test 1) the non-existence of this D.USER data does not have to be verified.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D.TSF</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The text representation of the IP address assigned to the TOE when it was in operation</p>
</li>
<li>
<p>The hexadecimal representation of the IP address assigned to the TOE when it was in operation</p>
</li>
<li>
<p>The text representation of an administrator account that was configured for the TOE when it was in operation.</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_protected_communications">4.3. Protected Communications</h3>
<div class="sect3">
<h4 id="_fcs_tlsc_ext_2_tls_client_support_for_mutual_authentication">4.3.1. FCS_TLSC_EXT.2 TLS Client support for mutual authentication</h4>
<div class="sect4">
<h5 id="_tss_40">4.3.1.1. TSS</h5>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_2_1">4.3.1.1.1. FCS_TLSC_EXT.2.1</h6>
<div class="paragraph">
<p>The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for TLS mutual authentication.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_33">4.3.1.2. Guidance Documentation</h5>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_2_1_2">4.3.1.2.1. FCS_TLSC_EXT.2.1</h6>
<div class="paragraph">
<p>If the TSS indicates that mutual authentication using X.509v3 certificates is used, the evaluator shall verify that the AGD guidance includes instructions for configuring the client-side certificates for TLS mutual authentication.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_38">4.3.1.3. Tests</h5>
<div class="paragraph">
<p>For all tests in this chapter the TLS server used for testing of the TOE shall be configured to require mutual authentication.</p>
</div>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_2_1_3">4.3.1.3.1. FCS_TLSC_EXT.2.1</h6>
<div class="paragraph">
<p>(covered by FCS_TLSC_EXT.1.1 Test 1 and testing for FIA_X.509_EXT.*)</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_tlss_ext_2_tls_server_support_for_mutual_authentication">4.3.2. FCS_TLSS_EXT.2 TLS Server support for mutual authentication</h4>
<div class="sect4">
<h5 id="_tss_41">4.3.2.1. TSS</h5>
<div class="sect5">
<h6 id="_fcs_tlss_ext_2_1_and_fcs_tlss_ext_2_2">4.3.2.1.1. FCS_TLSS_EXT.2.1 and FCS_TLSS_EXT.2.2</h6>
<div class="paragraph">
<p>The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for TLS mutual authentication.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the TSS describes how the TSF uses certificates to authenticate the TLS client. The evaluator shall verify the TSS describes if the TSF supports any fallback authentication functions (e.g. username/password, challenge response) the TSF uses to authenticate TLS clients that do not present a certificate. If fallback authentication functions are supported, the evaluator shall verify the TSS describes whether the fallback authentication functions can be disabled.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_2_3">4.3.2.1.2. FCS_TLSS_EXT.2.3</h6>
<div class="paragraph">
<p>The evaluator shall verify that the TSS describes which types of identifiers are supported during client authentication (e.g. Fully Qualified Domain Name (FQDN)). If FQDNs are supported, the evaluator shall verify that the TSS describes that corresponding identifiers are matched according to RFC6125. For all other types of identifiers, the evaluator shall verify that the TSS describes how these identifiers are parsed from the certificate, what the expected identifiers are and how the parsed identifiers from the certificate are matched against the expected identifiers.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_34">4.3.2.2. Guidance Documentation</h5>
<div class="sect5">
<h6 id="_fcs_tlss_ext_2_1_and_fcs_tlss_ext_2_2_2">4.3.2.2.1. FCS_TLSS_EXT.2.1 and FCS_TLSS_EXT.2.2</h6>
<div class="paragraph">
<p>If the TSS indicates that mutual authentication using X.509v3 certificates is used, the evaluator shall verify that the AGD guidance includes instructions for configuring the client-side certificates for TLS mutual authentication.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the guidance describes how to configure the TLS client certificate authentication function. If the TSF supports fallback authentication functions, the evaluator shall verify the guidance provides instructions for configuring the fallback authentication functions. If fallback authentication functions can be disabled, the evaluator shall verify the guidance provides instructions for disabling the fallback authentication functions.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_2_3_2">4.3.2.2.2. FCS_TLSS_EXT.2.3</h6>
<div class="paragraph">
<p>The evaluator shall ensure that the AGD guidance describes the configuration of expected identifier(s) for X.509 certificate-based authentication of TLS clients. The evaluator ensures this description includes all types of identifiers described in the TSS and, if claimed, configuration of the TOE to use a directory server.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_39">4.3.2.3. Tests</h5>
<div class="paragraph">
<p>For all tests in this chapter the TLS client used for testing of the TOE shall support mutual authentication.</p>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_2_1_and_fcs_tlss_ext_2_2_3">4.3.2.3.1. FCS_TLSS_EXT.2.1 and FCS_TLSS_EXT.2.2</h6>
<div class="paragraph">
<p>Test 1a [conditional]: If the TOE requires or can be configured to require a client certificate, the evaluator shall configure the TOE to require a client certificate and send a Certificate Request to the client. The evaluator shall attempt a connection while sending a certificate_list structure with a length of zero in the Client Certificate message. The evaluator shall verify that the handshake is not finished successfully and no application data flows.</p>
</div>
<div class="paragraph">
<p>Test 1b [conditional]: If the TOE supports fallback authentication functions and these functions cannot be disabled, the evaluator shall configure the fallback authentication functions on the TOE and configure the TOE to send a Certificate Request to the client. The evaluator shall attempt a connection while sending a certificate_list structure with a length of zero in the Client Certificate message. The evaluator shall verify the TOE authenticates the connection using the fallback authentication functions as described in the TSS.</p>
</div>
<div class="paragraph">
<p>Note: Testing the validity of the client certificate is performed as part of X.509 testing.</p>
</div>
<div class="paragraph">
<p>Test 2 [conditional]: If TLS 1.2 is claimed for the TOE, the evaluator shall configure the server to send a certificate request to the client without the supported_signature_algorithm used by the client&#8217;s certificate. The evaluator shall attempt a connection using the client certificate and verify that the connection is denied.</p>
</div>
<div class="paragraph">
<p>Test 3: The aim of this test is to check the response of the server when it receives a client identity certificate that is signed by an impostor CA (either Root CA or intermediate CA). To carry out this test the evaluator shall configure the client to send a client identity certificate with an issuer field that identifies a CA recognised by the TOE as a trusted CA, but where the key used for the signature on the client certificate does not correspond to the CA certificate trusted by the TOE (meaning that the client certificate is invalid because its certification path does not terminate in the claimed CA certificate). The evaluator shall verify that the attempted connection is denied.</p>
</div>
<div class="paragraph">
<p>Test 4: The evaluator shall configure the client to send a certificate with the Client Authentication purpose in the extendedKeyUsage field and verify that the server accepts the attempted connection. The evaluator shall repeat this test without the Client Authentication purpose and shall verify that the server denies the connection. Ideally, the two certificates should be identical except for the Client Authentication purpose.</p>
</div>
<div class="paragraph">
<p>Test 5: The evaluator shall perform the following modifications to the traffic:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Configure the server to require mutual authentication and then connect to the server with a client configured to send a client certificate that is signed by a Certificate Authority trusted by the TOE.  The evaluator shall verify that the server accepts the connection.</p>
</li>
<li>
<p>Configure the server to require mutual authentication and then modify a byte in the signature block of the clients Certificate Verify handshake message (see RFC5246 Sec 7.4.8). The evaluator shall verify that the server rejects the connection.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note: Testing the validity of the client certificate is performed as part of X.509 testing.</p>
</div>
<div class="paragraph">
<p>The evaluator shall demonstrate that using an invalid certificate results in the function failing as follows:</p>
</div>
<div class="paragraph">
<p>Test 6: Using the administrative guidance, the evaluator shall load a CA certificate or certificates needed to validate the presented certificate used to authenticate an external entity and demonstrate that the function succeeds, and a trusted channel can be established.</p>
</div>
<div class="paragraph">
<p>Test 7: The evaluator shall then change the presented certificate(s) so that validation fails and show that the certificate is not automatically accepted. The evaluator shall repeat this test to cover the selected types of failure defined in the SFR (i.e. the selected ones from failed matching of the reference identifier, failed validation of the certificate path, failed validation of the expiration date, failed determination of the revocation status). The evaluator performs the action indicated in the SFR selection observing the TSF resulting in the expected state for the trusted channel (e.g. trusted channel was established) covering the types of failure for which an override mechanism is defined.</p>
</div>
<div class="paragraph">
<p>Test 8 [conditional]: The purpose of this test is to verify that only selected certificate validation failures could be administratively overridden. If any override mechanism is defined for failed certificate validation, the evaluator shall configure a new presented certificate that does not contain a valid entry in one of the mandatory fields or parameters (e.g. inappropriate value in extendedKeyUsage field) but is otherwise valid and signed by a trusted CA. The evaluator shall confirm that the certificate validation fails (i.e. certificate is rejected), and there is no administrative override available to accept such certificate.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_2_3_3">4.3.2.3.2. FCS_TLSS_EXT.2.3</h6>
<div class="paragraph">
<p>The evaluator shall send a client certificate with an identifier that does not match an expected identifier and verify that the server denies the connection.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_dtlsc_ext_2_dtls_client_support_for_mutual_authentication">4.3.3. FCS_DTLSC_EXT.2 DTLS Client support for mutual authentication</h4>
<div class="sect4">
<h5 id="_tss_42">4.3.3.1. TSS</h5>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_2_1">4.3.3.1.1. FCS_DTLSC_EXT.2.1</h6>
<div class="paragraph">
<p>The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for DTLS mutual authentication.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_2_2">4.3.3.1.2. FCS_DTLSC_EXT.2.2</h6>
<div class="paragraph">
<p>The evaluator shall verify that the TSS describes the actions that take place if a message received from the DTLS Server fails the MAC integrity check.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_2_3">4.3.3.1.3. FCS_DTLSC_EXT.2.3</h6>
<div class="paragraph">
<p>The evaluator shall verify that TSS describes how replay is detected and silently discarded for DTLS records that have previously been received and too old to fit in the sliding window.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_35">4.3.3.2. Guidance Documentation</h5>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_2_1_2">4.3.3.2.1. FCS_DTLSC_EXT.2.1</h6>
<div class="paragraph">
<p>If the TSS indicates that mutual authentication using X.509v3 certificates is used, the evaluator shall verify that the AGD guidance includes instructions for configuring the client-side certificates for DTLS mutual authentication.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_40">4.3.3.3. Tests</h5>
<div class="paragraph">
<p>For all tests in this chapter the TLS server used for testing of the TOE shall be configured to require mutual authentication.</p>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_2_1_3">4.3.3.3.1. FCS_DTLSC_EXT.2.1</h6>
<div class="paragraph">
<p>(covered by FCS_DTLSC_EXT.1.1 Test 1 and testing for FIA_X.509_EXT.*)</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_2_2_2">4.3.3.3.2. FCS_DTLSC_EXT.2.2</h6>
<div class="paragraph">
<p>Test 1:  The evaluator shall establish a DTLS connection.  The evaluator will then modify at least one byte in a record message and verify that the Client discards the record or terminates the DTLS session.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_2_3_2">4.3.3.3.3. FCS_DTLSC_EXT.2.3</h6>
<div class="paragraph">
<p>Test 1:  The evaluator shall set up a DTLS connection with a DTLS Server. The evaluator shall then capture traffic sent from the DTLS Server to the TOE. The evaluator shall retransmit copies of this traffic to the TOE in order to impersonate the DTLS Server. The evaluator shall observe that the TSF does not take action in response to receiving these packets and that the audit log indicates that the replayed traffic was discarded.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_dtlss_ext_2_dtls_server_support_for_mutual_authentication">4.3.4. FCS_DTLSS_EXT.2 DTLS Server support for mutual authentication</h4>
<div class="sect4">
<h5 id="_tss_43">4.3.4.1. TSS</h5>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_2_1_and_fcs_dtlss_ext_2_2">4.3.4.1.1. FCS_DTLSS_EXT.2.1 and FCS_DTLSS_EXT.2.2</h6>
<div class="paragraph">
<p>The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for DTLS mutual authentication.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the TSS describes how the TSF uses certificates to authenticate the DTLS client. The evaluator shall verify the TSS describes whether the TSF supports any fallback authentication functions (e.g. username/password, challenge response) the TSF uses to authenticate DTLS clients that do not present a certificate. If fallback authentication functions are supported, the evaluator shall verify the TSS describes whether the fallback authentication functions can be disabled.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_2_3">4.3.4.1.2. FCS_DTLSS_EXT.2.3</h6>
<div class="paragraph">
<p>The evaluator shall verify that the TSS describes which types of identifiers are supported for during client authentication (e.g. Fully Qualified Domain Name (FQDN)). If FQDNs are supported, the evaluator shall verify that the TSS describes that corresponding identifiers are matched according to RFC6125. For all other types of identifiers, the evaluator shall verify that the TSS describes how these identifiers are parsed from the certificate, what the expected identifiers are and how the parsed identifiers from the certificate are matched against the expected identifiers.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_36">4.3.4.2. Guidance Documentation</h5>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_2_1_and_fcs_dtlss_ext_2_2_2">4.3.4.2.1. FCS_DTLSS_EXT.2.1 and FCS_DTLSS_EXT.2.2</h6>
<div class="paragraph">
<p>If the TSS indicates that mutual authentication using X.509v3 certificates is used, the evaluator shall verify that the AGD guidance includes instructions for configuring the client-side certificates for DTLS mutual authentication.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the guidance describes how to configure the DTLS client certificate authentication function. If the TSF supports fallback authentication functions, the evaluator shall verify the guidance provides instructions for configuring the fallback authentication functions. If fallback authentication functions can be disabled, the evaluator shall verify the guidance provides instructions for disabling the fallback authentication functions.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_2_3_2">4.3.4.2.2. FCS_DTLSS_EXT.2.3</h6>
<div class="paragraph">
<p>The evaluator shall ensure that the AGD guidance describes the configuration of expected identifier(s) for X.509 certificate-based authentication of DTLS clients. The evaluator ensures this description includes all types of identifiers described in the TSS and, if claimed, configuration of the TOE to use a directory server.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_41">4.3.4.3. Tests</h5>
<div class="paragraph">
<p>For all tests in this chapter the TLS client used for testing of the TOE shall support mutual authentication.</p>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_2_1_and_fcs_dtlss_ext_2_2_3">4.3.4.3.1. FCS_DTLSS_EXT.2.1 and FCS_DTLSS_EXT.2.2</h6>
<div class="paragraph">
<p>Test 1a [conditional]: If the TOE requires or can be configured to require a client certificate, the evaluator shall configure the TOE to require a client certificate and send a Certificate Request to the client. The evaluator shall attempt a connection while sending a certificate_list structure with a length of zero in the Client Certificate message. The evaluator shall verify that the handshake is not finished successfully and no application data flows.</p>
</div>
<div class="paragraph">
<p>Test 1b [conditional]: If the TOE supports fallback authentication functions and these functions cannot be disabled, the evaluator shall configure the fallback authentication functions on the TOE and configure the TOE to send a Certificate Request to the client. The evaluator shall attempt a connection while sending a certificate_list structure with a length of zero in the Client Certificate message. The evaluator shall verify the TOE authenticates the connection using the fallback authentication functions as described in the TSS.</p>
</div>
<div class="paragraph">
<p>Note: Testing the validity of the client certificate is performed as part of X.509 testing.</p>
</div>
<div class="paragraph">
<p>Test 2 [conditional]: If DTLS 1.2 is claimed for the TOE, the evaluator shall configure the server to send a certificate request to the client without the supported_signature_algorithm used by the client&#8217;s certificate. The evaluator shall attempt a connection using the client certificate and verify that the connection is denied.</p>
</div>
<div class="paragraph">
<p>Test 3: The aim of this test is to check the response of the server when it receives a client identity certificate that is signed by an impostor CA (either Root CA or intermediate CA). To carry out this test the evaluator shall configure the client to send a client identity certificate with an issuer field that identifies a CA recognised by the TOE as a trusted CA, but where the key used for the signature on the client certificate does not correspond to the CA certificate trusted by the TOE (meaning that the client certificate is invalid because its certification path does not terminate in the claimed CA certificate). The evaluator shall verify that the attempted connection is denied.</p>
</div>
<div class="paragraph">
<p>Test 4: The evaluator shall configure the client to send a certificate with the Client Authentication purpose in the extendedKeyUsage field and verify that the server accepts the attempted connection. The evaluator shall repeat this test without the Client Authentication purpose and shall verify that the server denies the connection. Ideally, the two certificates should be identical except for the Client Authentication purpose.</p>
</div>
<div class="paragraph">
<p>Test 5: The evaluator shall perform the following modifications to the traffic:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Configure the server to require mutual authentication and then connect to the server with a client configured to send a client certificate that is signed by a Certificate Authority trusted by the TOE.  The evaluator shall verify that the server accepts the connection.</p>
</li>
<li>
<p>Configure the server to require mutual authentication and then modify a byte in the signature block of the clients Certificate Verify handshake message (see RFC5246 Sec 7.4.8). The evaluator shall verify that the server rejects the connection.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note: Testing the validity of the client certificate is performed as part of X.509 testing.</p>
</div>
<div class="paragraph">
<p>The evaluator shall demonstrate that using an invalid certificate results in the function failing as follows:</p>
</div>
<div class="paragraph">
<p>Test 6: Using the administrative guidance, the evaluator shall load a CA certificate or certificates needed to validate the presented certificate used to authenticate an external entity and demonstrate that the function succeeds, and a trusted channel can be established.</p>
</div>
<div class="paragraph">
<p>Test 7: The evaluator shall then change the presented certificate(s) so that validation fails and show that the certificate is not automatically accepted. The evaluator shall repeat this test to cover the selected types of failure defined in the SFR (i.e. the selected ones from failed matching of the reference identifier, failed validation of the certificate path, failed validation of the expiration date, failed determination of the revocation status). The evaluator performs the action indicated in the SFR selection observing the TSF resulting in the expected state for the trusted channel (e.g. trusted channel was established) covering the types of failure for which an override mechanism is defined.</p>
</div>
<div class="paragraph">
<p>Test 8 [conditional]: The purpose of this test is to verify that only selected certificate validation failures could be administratively overridden. If any override mechanism is defined for failed certificate validation, the evaluator shall configure a new presented certificate that does not contain a valid entry in one of the mandatory fields or parameters (e.g. inappropriate value in extendedKeyUsage field) but is otherwise valid and signed by a trusted CA. The evaluator shall confirm that the certificate validation fails (i.e. certificate is rejected), and there is no administrative override available to accept such certificate.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_2_3_3">4.3.4.3.2. FCS_DTLSS_EXT.2.3</h6>
<div class="paragraph">
<p>The evaluator shall send a client certificate with an identifier that does not match an expected identifier and verify that the server denies the connection.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_evaluation_activities_for_selection_based_requirements">5. Evaluation Activities for Selection-Based Requirements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_confidential_data_on_nonvolatile_storage_devices_2">5.1. Confidential Data on Nonvolatile Storage Devices</h3>
<div class="sect3">
<h4 id="_fcs_cop_1storageencryption_cryptographic_operation_data_encryptiondecryption">5.1.1. FCS_COP.1/StorageEncryption Cryptographic operation (Data Encryption/Decryption)</h4>
<div class="sect4">
<h5 id="_tss_44">5.1.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall verify the TSS includes a description of the key size used for encryption and the mode used for encryption.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_37">5.1.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p>If multiple encryption modes are supported, the evaluator examines the guidance documentation to determine that the method of choosing a specific mode/key size by the end user is described.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_42">5.1.1.3. Tests</h5>
<div class="paragraph">
<p>The following tests are conditional based upon the selections made in the SFR.</p>
</div>
<div class="paragraph">
<p>Note: Testing of cryptographic functions implemented in the Root of Trust for Secure Boot (FPT_SBT_EXT.1) may not be feasible and independent testing may not be available. In this situation, contact the CC Scheme.</p>
</div>
<div class="paragraph">
<p><strong>AES-CBC Tests</strong></p>
</div>
<div class="paragraph">
<p>For the AES-CBC tests described below, the plaintext, ciphertext, and IV values
shall consist of 128-bit blocks. To determine correctness, the evaluator shall
compare the resulting values to those obtained by submitting the same inputs to a
known-good implementation.</p>
</div>
<div class="paragraph">
<p>These tests are intended to be equivalent to those described in NISTs AES
Algorithm Validation Suite (AESAVS) (<a href="http://csrc.nist.gov/groups/STM/cavp/documents/aes/AESAVS.pdf" class="bare">http://csrc.nist.gov/groups/STM/cavp/documents/aes/AESAVS.pdf</a>). It is not recommended that evaluators use values obtained from static sources such as the
example NISTs AES Known Answer Test Values from the AESAVS document,
or use values not generated expressly to exercise the AES-CBC implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>AES-CBC Known Answer Tests</em></strong></p>
</div>
<div class="paragraph">
<p><span class="underline">KAT-1 (GFSBox):</span> To test the encrypt functionality of AES-CBC, the evaluator
shall supply a set of five different plaintext values for each selected key size and
obtain the ciphertext value that results from AES-CBC encryption of the given
plaintext using a key value of all zeros and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of AES-CBC, the evaluator shall supply a set of
five different ciphertext values for each selected key size and obtain the plaintext
value that results from AES-CBC decryption of the given ciphertext using a key
value of all zeros and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p><span class="underline">KAT-2 (KeySBox):</span> To test the encrypt functionality of AES-CBC, the evaluator
shall supply a set of five different key values for each selected key size and obtain
the ciphertext value that results from AES-CBC encryption of an all-zeros plaintext
using the given key value and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of AES-CBC, the evaluator shall supply a set of
five different key values for each selected key size and obtain the plaintext that
results from AES-CBC decryption of an all-zeros ciphertext using the given key
and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p><span class="underline">KAT-3 (Variable Key):</span> To test the encrypt functionality of AES-CBC, the evaluator
shall supply a set of keys for each selected key size (as described below) and obtain
the ciphertext value that results from AES encryption of an all-zeros plaintext using
each key and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p>Key i in each set shall have the leftmost i bits set to ones and the remaining bits to
zeros, for values of i from 1 to the key size. The keys and corresponding ciphertext
are listed in AESAVS, Appendix E.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of AES-CBC, the evaluator shall use the same keys
as above to decrypt the ciphertext results from above. Each decryption should result
in an all-zeros plaintext.</p>
</div>
<div class="paragraph">
<p><span class="underline">KAT-4 (Variable Text):</span> To test the encrypt functionality of AES-CBC, for each
selected key size, the evaluator shall supply a set of 128-bit plaintext values (as
described below) and obtain the ciphertext values that result from AES-CBC
encryption of each plaintext value using a key of each size and IV consisting of all
zeros.</p>
</div>
<div class="paragraph">
<p>Plaintext value i shall have the leftmost i bits set to ones and the remaining bits set
to zeros, for values of i from 1 to 128. The plaintext values are listed in AESAVS,
Appendix D.</p>
</div>
<div class="paragraph">
<p>To test the decrypt functionality of AES-CBC, for each selected key size, use the
plaintext values from above as ciphertext input, and AES-CBC decrypt each
ciphertext value using key of each size consisting of all zeros and an IV of all zeros.</p>
</div>
<div class="paragraph">
<p><strong><em>AES-CBC Multi-Block Message Test</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality by encrypting an i-block message where 1 &lt; i &lt;=10. The evaluator shall choose a key, an IV and plaintext message of length i blocks and encrypt the message, using the mode to be tested, with the chosen key and IV. The ciphertext shall be compared to the result of encrypting the same plaintext message with the same key and IV using a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall also test the decrypt functionality for each mode by decrypting an i-block message where 1 &lt; i &lt;=10. The evaluator shall choose a key, an IV and a ciphertext message of length i blocks and decrypt the message, using the mode to be tested, with the chosen key and IV. The plaintext shall be compared to the result of decrypting the same ciphertext message with the same key and IV using a known good implementation.</p>
</div>
<div class="paragraph">
<p><strong><em>AES-CBC Monte Carlo Tests</em></strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the encrypt functionality for each selected key size using
100 3-tuples of pseudo-random values for plaintext, IVs, and keys.</p>
</div>
<div class="paragraph">
<p>The evaluator shall supply a single 3-tuple of pseudo-random values for each
selected key size. This 3-tuple of plaintext, IV, and key is provided as input to the
below algorithm to generate the remaining 99 3-tuples, and to run each 3-tuple
through 1000 iterations of AES-CBC encryption.</p>
</div>
<div class="literalblock">
<div class="content">
<pre># Input: PT, IV, Key
Key[0] = Key
IV[0] = IV
PT[0] = PT
for i = 0 to 99 {
    Output Key[i], IV[i], PT[0]
    for j = 0 to 999 {
        if (j == 0) {
            CT[j] = AES-CBC-Encrypt(Key[i], IV[i], PT[j])
            PT[j+1] = IV[i]
        } else {
            CT[j] = AES-CBC-Encrypt(Key[i], PT[j])
            PT[j+1] = CT[j-1]
        }
    }
    Output CT[j]
    If (KeySize == 128) Key[i+1] = Key[i] xor CT[j]
    If (KeySize == 192) Key[i+1] = Key[i] xor (last 64 bits of CT[j-1] || CT[j])
    If (KeySize == 256) Key[i+1] = Key[i] xor ((CT[j-1] | CT[j])
    IV[i+1] = CT[j]
    PT[0] = CT[j-1]
}</pre>
</div>
</div>
<div class="paragraph">
<p>The ciphertext computed in the 1000th iteration (CT[999]) is the result for each of
the 100 3-tuples for each selected key size. This result shall be compared to the
result of running 1000 iterations with the same values using a known good
implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality using the same test as above,
exchanging CT and PT, and replacing AES-CBC-Encrypt with AES-CBC-Decrypt.</p>
</div>
<div class="paragraph">
<p><strong>AES-GCM Test</strong></p>
</div>
<div class="paragraph">
<p>These tests are intended to be equivalent to those described in the NIST document,
The Galois/Counter Mode (GCM) and GMAC Validation System (GCMVS) with
the Addition of XPN Validation Testing, rev. 15 Jun 2016, section 6.2, found at
<a href="http://csrc.nist.gov/groups/STM/cavp/documents/mac/gcmvs.pdf" class="bare">http://csrc.nist.gov/groups/STM/cavp/documents/mac/gcmvs.pdf</a>.</p>
</div>
<div class="paragraph">
<p>It is not recommended that evaluators use values obtained from static sources such
as <a href="http://csrc.nist.gov/groups/STM/cavp/documents/mac/gcmtestvectors.zip" class="bare">http://csrc.nist.gov/groups/STM/cavp/documents/mac/gcmtestvectors.zip</a>, or use
values not generated expressly to exercise the AES-GCM implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the authenticated encryption functionality of AES-GCM by
supplying 15 sets of Key, Plaintext, AAD, IV, and Tag data for every combination
of the following parameters as selected in the ST and supported by the
implementation under test:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Key size in bits:</strong> Each selected and supported key size (e.g., 128, 192, or
256 bits).</p>
</li>
<li>
<p><strong>Plaintext length in bits:</strong> Up to four values for plaintext length: Two values
that are non-zero integer multiples of 128, if supported. And two values that
are non-multiples of 128, if supported.</p>
</li>
<li>
<p><strong>AAD length in bits:</strong> Up to five values for AAD length: Zero-length, if
supported. Two values that are non-zero integer multiples of 128, if
supported. And two values that are integer non-multiples of 128, if
supported.</p>
</li>
<li>
<p><strong>IV length in bits:</strong> Up to three values for IV length: 96 bits. Minimum and
maximum supported lengths, if different.</p>
</li>
<li>
<p><strong>MAC length in bits:</strong> Each supported length (e.g., 128, 120, 112, 104, 96).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To determine correctness, the evaluator shall compare the resulting values to those
obtained by submitting the same inputs to a known-good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the authenticated decrypt functionality of AES-GCM by
supplying 15 Ciphertext-Tag pairs for every combination of the above parameters,
replacing Plaintext length with Ciphertext length. For each parameter combination
the evaluator shall introduce an error into either the Ciphertext or the Tag such that
approximately half of the cases are correct and half the cases contain errors. To
determine correctness, the evaluator shall compare the resulting pass/fail status and
Plaintext values to the results obtained by submitting the same inputs to a knowngood
implementation.</p>
</div>
<div class="paragraph">
<p><strong>XTS-AES Test</strong></p>
</div>
<div class="paragraph">
<p>These tests are intended to be equivalent to those described in the NIST document,
The XTS-AES Validation System (XTSVS), updated 5 Sept 2013, found at <a href="http://csrc.nist.gov/groups/STM/cavp/documents/aes/XTSVS.pdf" class="bare">http://csrc.nist.gov/groups/STM/cavp/documents/aes/XTSVS.pdf</a></p>
</div>
<div class="paragraph">
<p>It is not recommended that evaluators use values obtained from static sources such
as the XTS-AES test vectors at <a href="http://csrc.nist.gov/groups/STM/cavp/documents/aes/XTSTestVectors.zip" class="bare">http://csrc.nist.gov/groups/STM/cavp/documents/aes/XTSTestVectors.zip</a> or use values not generated expressly to exercise the XTS-AES implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall generate test values as follows:</p>
</div>
<div class="paragraph">
<p>For each supported key size (256 bit (for AES-128) and 512 bit (for AES-256)
keys), the evaluator shall provide up to five data lengths:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Two data lengths divisible by the 128-bit block size, If data unit lengths of
complete block sizes are supported.</p>
</li>
<li>
<p>Two data lengths not divisible by the 128-bit block size, if data unit lengths
of partial block sizes are supported.</p>
</li>
<li>
<p>The largest data length supported by the implementation, or 2^16 (65536),
whichever is larger.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The evaluator shall specify whether the implementation supports tweak values of
128-bit hexadecimal strings or a data unit sequence numbers, or both.</p>
</div>
<div class="paragraph">
<p>For each combination of key size and data length, the evaluator shall provide 100 sets of input data and obtain the ciphertext that results from XTS-AES encryption. If both kinds of tweak values are supported then each type of tweak value shall be used in half of every 100 sets of input data, for all combinations of key size and data length. The evaluator shall verify that the resulting  ciphertext matches the results from submitting the same inputs to a known-good implementation of XTS-AES.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the decrypt functionality of XTS-AES using the same test
as for encrypt, replacing plaintext values with ciphertext values and XTS-AES
encrypt with XTS- AES decrypt.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check that the full length keys are created by methods that
ensure that the two halves are different and independent.</p>
</div>
<div class="paragraph">
<p><strong>SEED, HIGHT, LEA Test</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall refer to Section 2.2.5. FCS_COP.1/DataEncryption Cryptographic Operation (Data Encryption/Decryption) for the required following testing.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SEED-CBC Tests</p>
</li>
<li>
<p>SEED-CFB Tests</p>
</li>
<li>
<p>SEED-OFB Tests</p>
</li>
<li>
<p>SEED-CTR Tests</p>
</li>
<li>
<p>SEED-CCM Tests</p>
</li>
<li>
<p>SEED-GCM Tests</p>
</li>
<li>
<p>HIGHT-CBC Tests</p>
</li>
<li>
<p>HIGHT-CFB Tests</p>
</li>
<li>
<p>HIGHT-OFB Tests</p>
</li>
<li>
<p>HIGHT-CTR Tests</p>
</li>
<li>
<p>LEA-CBC Tests</p>
</li>
<li>
<p>LEA-CFB Tests</p>
</li>
<li>
<p>LEA-OFB Tests</p>
</li>
<li>
<p>LEA-CTR Tests</p>
</li>
<li>
<p>LEA-CCM Tests</p>
</li>
<li>
<p>LEA-GCM Tests</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_cop_1keywrap_cryptographic_operation_key_wrapping">5.1.2. FCS_COP.1/KeyWrap Cryptographic operation (Key Wrapping)</h4>
<div class="sect4">
<h5 id="_tss_45">5.1.2.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall verify the TSS includes a description of the key wrap function(s) and shall verify the key wrap uses an approved key wrap algorithm according to the appropriate specification.</p>
</div>
<div class="paragraph">
<p>If SEED-GCM, SEED-CCM, LEA-GCM, or LEA-CCM is selected, the evaluator shall examine the TOE summary specification to confirm that it describes how the IV is generated and that the same IV is never reused to encrypt different plaintext pairs under the same key. Moreover, in the case of GCM, the evaluator shall confirm that, at each invocation of GCM, the length of the plaintext is at most (2^32)-2 blocks.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_38">5.1.2.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall check the operational user guidance to confirm that the instructions for establishing the evaluated configuration use only those key wrap function(s) selected in the ST. If multiple key access modes are supported, the evaluator shall examine the operational user guidance to determine that the method of choosing a specific mode/key size by the end user is described.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kmd_6">5.1.2.3. KMD</h5>
<div class="paragraph">
<p>The evaluator shall review the KMD to ensure that all keys are wrapped using the approved method and a description of when the key wrapping occurs.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_43">5.1.2.4. Tests</h5>
<div class="paragraph">
<p>The evaluator shall include test cases of FCS_COP.1/KeyWrap to the test subset. Note that FCS_COP.1/KeyWrap may be not mapped to the specific interface(s) after evaluators analysis during ADV_FSP.1.</p>
</div>
<div class="paragraph">
<p>The evaluator shall produce test documentation for test cases of FCS_COP.1/KeyWrap. If there is no explicit external interface(s) mapped to FCS_COP.1/KeyWrap, the evaluator shall employ an alternative test approach (refer to CEM, section 15.2.2.).</p>
</div>
<div class="paragraph">
<p>The evaluator shall perform the following tests or witness respective tests executed by the developer if technically possible, otherwise an analysis of the implementation representation has to be performed.</p>
</div>
<div class="paragraph">
<p><strong>Preconditions for testing</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Specification of wrapping keys as input parameter to the function to be tested</p>
</li>
<li>
<p>Specification of further required input parameters if required</p>
</li>
<li>
<p>Specification of keys to be wrapped (plaintext, as functions argument)</p>
</li>
<li>
<p>Direct access to wrapped key (ciphertext), e.g. in the nonvolatile memory</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>AES-KW, AES-KWP, AES-GCM, AES-CCM</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall ensure the wrapped key is wrapped as specified in this SFR using reference implementation of wrapping in accordance with AES in the modes and key size specified in this SFR. This reference implementation of wrapping algorithm may be a tool or program provided by the evaluator or the developer, this implementation is dependent on the KMD description provided by the developer.</p>
</div>
<div class="paragraph">
<p><strong>SEED-KW [SP 800-38F, sec. 6.2]</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall test the authenticated-encryption functionality of SEED-KW (Key Wrap) for each combination of the following input parameters:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Supported key lengths selected in the ST (128 bits)</p>
</li>
<li>
<p>Five plaintext lengths:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Two lengths that are non-zero multiples of 128 bits (two semi-block lengths)</p>
</li>
<li>
<p>Two lengths that are odd multiples of the semi-block length (64 bits)</p>
</li>
<li>
<p>The largest supported plaintext length less than or equal to 4096 bits.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For each set of the above parameters the evaluator shall generate a set of 100 key and plaintext pairs and obtain the ciphertext that results from SEED-KW authenticated encryption. To determine correctness, the evaluator shall compare the results with those obtained from the SEED-KW authenticated-encryption function of a known good implementation.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the authenticated-decryption functionality of SEED-KW using the same test as for authenticated-encryption, replacing plaintext values with ciphertext values and SEED-KW authenticated-encryption (KW-AE) with SEED-KW authenticated-decryption (KW-AD). For the authenticated-decryption test, 20 out of the 100 trials per plaintext length must have ciphertext values that are not authentic; that is, they fail authentication.</p>
</div>
<div class="paragraph">
<p>Additionally, the evaluator shall perform the following negative tests:</p>
</div>
<div class="paragraph">
<p><span class="underline">Test 1 (invalid plaintext length)</span></p>
</div>
<div class="paragraph">
<p>Determine the valid plaintext lengths of the implementation from the TOE specification. Verify that the implementation of KW-AE in the TOE rejects plaintexts of invalid length by testing plaintext of the following lengths: 1) plaintext length greater than 64 semi-blocks, 2) plaintext bit-length not divisible by 64, 3) plaintext with length 0, and 4) plaintext with one semi-block.</p>
</div>
<div class="paragraph">
<p><span class="underline">Test 2 (invalid ciphertext length)</span></p>
</div>
<div class="paragraph">
<p>Determine the valid ciphertext lengths of the implementation from the TOE specification. Verify that the implementation of KW-AD in the TOE rejects ciphertexts of invalid length by testing ciphertext of the following lengths: 1) ciphertext with length greater than 65 semi-blocks, 2) ciphertext with bit-length not divisible by 64, 3) ciphertext with length 0, 4)	ciphertext with length of one semi-block, and 5) ciphertext with length of two semi-blocks.</p>
</div>
<div class="paragraph">
<p><span class="underline">Test 3 (invalid ICV1)</span></p>
</div>
<div class="paragraph">
<p>Test that the implementation detects invalid ICV1 values by encrypting any plaintext value eight times using a different value for ICV1 each time as follows: Start with a base ICV1 of 0xA6A6A6A6A6A6A6A6. For each of the eight tests change a different byte to a different value, so that each of the eight bytes is changed once. Verify that the implementation of KW-AD in the TOE outputs FAIL for each test.</p>
</div>
<div class="paragraph">
<p><strong>SEED-KWP [SP 800-38F, sec. 6.3]</strong></p>
</div>
<div class="paragraph">
<p>The tests below are derived from The Key Wrap Validation System (KWVS), Updated: June 20, 2014 from the National Institute of Standards and Technology.</p>
</div>
<div class="paragraph">
<p>The evaluator shall test the authenticated-encryption functionality of SEED-KWP (Key Wrap with Padding) for each combination of the following input parameters:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Supported key lengths selected in the ST (128 bits)</p>
</li>
<li>
<p>Five plaintext lengths:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Four lengths that are multiple of 8 bits</p>
</li>
<li>
<p>The largest supported length less than or equal to 4096 bits.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The evaluator shall test the authenticated-decryption (KWP-AD) functionality of SEED-KWP using the same test as for authenticated-encryption, replacing plaintext values with ciphertext values and SEED-KWP authenticated-encryption with SEED-KWP authenticated-decryption. For the authenticated-decryption test, 20 out of the 100 trials per plaintext length must have ciphertext values that are not authentic; that is, they fail authentication.</p>
</div>
<div class="paragraph">
<p>Additionally, the evaluator shall perform the following negative tests:</p>
</div>
<div class="paragraph">
<p><span class="underline">Test 1 (invalid plaintext length)</span></p>
</div>
<div class="paragraph">
<p>Determine the valid plaintext lengths of the implementation from the TOE specification. Verify that the implementation of KWP-AE in the TOE rejects plaintexts of invalid length by testing plaintext of the following lengths: 1) plaintext length greater than 64 semi-blocks, 2) plaintext bit-length not divisible by 8, 3) plaintext with length 0.</p>
</div>
<div class="paragraph">
<p><span class="underline">Test 2 (invalid ciphertext length)</span></p>
</div>
<div class="paragraph">
<p>Determine the valid ciphertext lengths of the implementation from the TOE specification. Verify that the implementation of KWP-AD in the TOE rejects ciphertexts of invalid length by testing ciphertext of the following lengths: 1) ciphertext with length greater than 65 semi-blocks, 2) ciphertext with bit-length not divisible by 64, 3) ciphertext with length 0, 4) ciphertext with length of one semi-block.</p>
</div>
<div class="paragraph">
<p><span class="underline">Test 3 (invalid ICV2)</span></p>
</div>
<div class="paragraph">
<p>Test that the implementation detects invalid ICV2 values by encrypting any plaintext value eight times using a different value for ICV2 each time as follows: Start with a base ICV2 of 0xA65959A6. For each of the four tests change a different byte to a different value, so that each of the four bytes is changed once. Verify that the implementation of KWP-AD in the TOE outputs FAIL for each test.</p>
</div>
<div class="paragraph">
<p><span class="underline">Test 4 (invalid padding length)</span></p>
</div>
<div class="paragraph">
<p>Generate one ciphertext using algorithm KWP-AE with substring <code>[len(P)/8]</code><sub>32</sub> of S replaced by each of the following 32-bit values, where <code>len(P)</code> is the length of P in bits and <code>[]</code><sub>32</sub> denotes representation of an integer in 32 bits:</p>
</div>
<div class="paragraph">
<p> <code>[0]</code><sub>32</sub><br>
 <code>[len(P)/8&#8212;&#8203;8]</code><sub>32</sub><br>
 <code>[len(P)/8+8]</code><sub>32</sub><br>
 <code>[513]</code><sub>32</sub><br></p>
</div>
<div class="paragraph">
<p>Verify that the implementation of KWP-AD in the TOE outputs FAIL on those inputs.</p>
</div>
<div class="paragraph">
<p><span class="underline">Test 5 (invalid padding bits)</span></p>
</div>
<div class="paragraph">
<p>If the implementation supports plaintext of length not a multiple of 64-bits, then</p>
</div>
<div class="literalblock">
<div class="content">
<pre>for each PAD length [1..7]
    for each byte in PAD
        set a zero PAD value;
        replace current byte by a non-zero value and use the resulting  plaintext as input to algorithm KWP-AE to generate  ciphertexts;

        Verify that the implementation of KWP-AD in the TOE outputs FAIL on this input.</pre>
</div>
</div>
<div class="paragraph">
<p><strong>SEED-GCM [ISO 19772, clause 11]</strong></p>
</div>
<div class="paragraph">
<p>Refer to FCS_COP.1/StorageEncryption for the required SEED-GCM testing. Each distinct SEED-GCM implementation shall be tested separately.</p>
</div>
<div class="paragraph">
<p><strong>SEED-CCM [ISO 19772, clause 8]</strong></p>
</div>
<div class="paragraph">
<p>Refer to FCS_COP.1/StorageEncryption for the required SEED-CCM testing. Each distinct SEED-CCM implementation shall be tested separately.</p>
</div>
<div class="paragraph">
<p><strong>LEA-KW [SP 800-38F, sec. 6.2]</strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-KW [SP 800-38F, sec. 6.2] for the required LEA-KW testing. The evaluator shall test the authenticated encryption functionality using the same test as SEED-KW Tests, replacing SEED algorithm with LEA algorithm as PRF. In the LEA-KW testing, supported key lengths should be selected in the ST (e.g., 128bits, 192bits, 256bits).</p>
</div>
<div class="paragraph">
<p><strong>LEA-KWP [SP 800-38F, sec. 6.3]</strong></p>
</div>
<div class="paragraph">
<p>Refer to SEED-KWP [SP 800-38F, sec. 6.3] for the required LEA-KWP testing. The evaluator shall test the authenticated encryption functionality using the same test as SEED-KWP Tests, replacing SEED algorithm with LEA algorithm as PRF. In the LEA-KWP testing, supported key lengths should be selected in the ST (e.g., 128bits, 192bits, 256bits).</p>
</div>
<div class="paragraph">
<p><strong>LEA-GCM [ISO 19772, clause 11]</strong></p>
</div>
<div class="paragraph">
<p>Refer to FCS_COP.1/StorageEncryption for the required LEA-GCM testing. Each distinct LEA-GCM implementation shall be tested separately.</p>
</div>
<div class="paragraph">
<p><strong>LEA-CCM [ISO 19772, clause 8]</strong></p>
</div>
<div class="paragraph">
<p>Refer to FCS_COP.1/StorageEncryption for the required LEA-CCM testing. Each distinct LEA-CCM implementation shall be tested separately.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_cop_1keyenc_cryptographic_operation_key_encryption">5.1.3. FCS_COP.1/KeyEnc Cryptographic operation (Key Encryption)</h4>
<div class="sect4">
<h5 id="_tss_46">5.1.3.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall verify the TSS includes a description of the key encryption function(s) and shall verify the key encryption uses an approved algorithm according to the appropriate specification.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kmd_7">5.1.3.2. KMD</h5>
<div class="paragraph">
<p>The evaluator shall review the KMD to ensure that all keys are encrypted using the approved method and a description of when the key encryption occurs is provided.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_44">5.1.3.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall use tests in FCS_COP.1/StorageEncryption to verify encryption.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_cop_1keytransport_cryptographic_operation_key_transport">5.1.4. FCS_COP.1/KeyTransport Cryptographic operation (Key Transport)</h4>
<div class="sect4">
<h5 id="_tss_47">5.1.4.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall verify the TSS provides a high level description of the RSA scheme and the cryptographic key size that is being used, and that the asymmetric algorithm being used for key transport is RSA. If more than one scheme/key size are allowed, then the evaluator shall make sure and test all combinations of scheme and key size. There may be more than one key size to specify  an RSA modulus size (and/or encryption exponent size), an AES key size, hash sizes, MAC key/MAC tag size.</p>
</div>
<div class="paragraph">
<p>If the KTS-OAEP scheme was selected, the evaluator shall verify that the TSS identifies the hash function, the mask generating function, the random bit generator, the encryption primitive and decryption primitive.</p>
</div>
<div class="paragraph">
<p>If the KTS-KEM-KWS scheme was selected, the evaluator shall verify that the TSS identifies the key derivation method, the AES-based key wrapping method, the secret value encapsulation technique, and the random number generator.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_39">5.1.4.2. Guidance Documentation</h5>
<div class="paragraph">
<p>There are no AGD evaluation activities for this SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kmd_8">5.1.4.3. KMD</h5>
<div class="paragraph">
<p>There are no KMD evaluation activities for this SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_45">5.1.4.4. Tests</h5>
<div class="paragraph">
<p>For each supported key transport schema, the evaluator shall initiate at least 25 sessions that require key transport with an independently developed remote instance of a key transport entity, using known RSA key-pairs. The evaluator shall observe traffic passed from the sender-side and to the receiver-side of the TOE, and shall perform the following tests, specific to which key transport scheme was employed.</p>
</div>
<div class="paragraph">
<p>If the KTS-OAEP scheme was selected, the evaluator shall perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall inspect each cipher text, C, produced by the RSA-OAEP encryption operation of the TOE and make sure it is the correct length, either 256 or 384 bytes depending on RSA key size. The evaluator shall also feed into the TOEs RSA-OAEP decryption operation some cipher texts that are the wrong length and verify that the erroneous input is detected and that the decryption operation exits with an error code.</p>
</li>
<li>
<p>The evaluator shall convert each cipher text, C, produced by the RSA-OAEP encryption operation of the TOE to the correct cipher text integer, c, and use the decryption primitive to compute em = RSADP((n,d),c) and convert em to the encoded message EM. The evaluator shall then check that the first byte of EM is 0x00. The evaluator shall also feed into the TOEs RSA-OAEP decryption operation some cipher texts where the first byte of EM was set to a value other than 0x00, and verify that the erroneous input is detected and that the decryption operation exits with an error code.</p>
</li>
<li>
<p>The evaluator shall decrypt each cipher text, C, produced by the RSA-OAEP encryption operation of the TOE using RSADP, and perform the OAEP decoding operation (described in SP800-56B section 7.2.2.4) to recover HA || X. For each HA, the evaluator shall take the corresponding A and the specified hash algorithm and verify that HA' = Hash(A). The evaluator shall also force the TOE to perform some RSA-OAEP decryptions where the A value is passed incorrectly, and the evaluator shall verify that an error is detected.</p>
</li>
<li>
<p>The evaluator shall check the format of the X string recovered in OAEP. Test.3 to ensure that the format is of the form PS || 01 || K, where PS consists of zero or more consecutive 0x00 bytes and K is the transported keying material. The evaluator shall also feed into the TOEs RSA-OAEP decryption operation some cipher texts for which the resulting X strings do not have the correct format (i.e., the leftmost non-zero byte is not 0x01). These incorrectly formatted X variables shall be detected by the RSA-OAEP decrypt function.</p>
</li>
<li>
<p>The evaluator shall trigger all detectable decryption errors and validate that the returned error codes are the same and that no information is given back to the sender on which type of error occurred. The evaluator shall also validate that no intermediate results from the TOEs receiver-side operations are revealed to the sender.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the KTS-KEM-KWS scheme was selected, the evaluator shall perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall inspect each cipher text, C, produced by RSA-KEM-KWS encryption operation of the TOE and make sure the length (in bytes) of the cipher text, cLen, is greater than nLen (the length, in bytes, of the modulus of the RSA public key) and that cLen - nLen is consistent with the byte lengths supported by the key wrapping algorithm. The evaluator shall feed into the RSA-KEM-KWS decryption operation a cipher text of unsupported length and verify that an error is detected and that the decryption process stops.</p>
</li>
<li>
<p>The evaluator shall separate the cipher text, C, produced by the sender-side of the TOE into its C0 and C1 components and use the RSA decryption primitive to recover the secret value, Z, from C0. The evaluator shall check that the unsigned integer represented by Z is greater than 1 and less than n-1, where n is the modulus of the RSA public key. The evaluator shall construct examples where the cipher text is created with a secret value Z = 1 and make sure the RSA-KEM-KWS decryption process detects the error. Similarly, the evaluator shall construct examples where the cipher text is created with a secret value Z = n  1 and make sure the RSA-KEM-KWS decryption process detects the error.</p>
</li>
<li>
<p>The evaluator shall attempt to successfully recover the secret value Z, derive the key wrapping key, KWK, and unwrap the KWA-cipher text following the RSA-KEM-KWS decryption process given in SP800-56B section 7.2.3.4. If the key-wrapping algorithm is AES-CCM, the evaluator shall verify that the value of any (unwrapped) associated data, A, that was passed with the wrapped keying material is correct. The evaluator shall feed into the TOEs RSA-KEM-KWS decryption operation examples of incorrect cipher text and verify that a decryption error is detected. If the key-wrapping algorithm is AES-CCM, the evaluator shall attempt at least one decryption where the wrong value of A is given to the RSA-KEM-KWS decryption operation and verify that a decryption error is detected. Similarly, if the key-wrapping algorithm is AES-CCM, the evaluator shall attempt at least one decryption where the wrong nonce is given to the RSA-KEM-KWS decryption operation and verify that a decryption error is detected.</p>
</li>
<li>
<p>The evaluator shall trigger all detectable decryption errors and validate that the resulting error codes are the same and that no information is given back to the sender on which type of error occurred. The evaluator shall also validate that no intermediate results from the TOEs receiver-side operations (in particular, no Z values) are revealed to the sender.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_smc_ext_1_submask_combining">5.1.5. FCS_SMC_EXT.1 Submask Combining</h4>
<div class="sect4">
<h5 id="_tss_48">5.1.5.1. TSS</h5>
<div class="paragraph">
<p>If keys are XORed together to form an intermediate key, the TSS section shall identify how this is performed (e.g., if there are ordering requirements, checks performed, etc.).   The evaluator shall also confirm that the TSS describes how the length of the output produced is at least the same as that of the DEK.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kmd_9">5.1.5.2. KMD</h5>
<div class="paragraph">
<p>The evaluator shall review the KMD to ensure that an approved combination is used and does not result in the weakening or exposure of key material.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_46">5.1.5.3. Tests</h5>
<div class="paragraph">
<p>(conditional): If there is more than one authorization factor, the evaluator shall ensure that failure to supply a required authorization factor does not result in access to the encrypted data.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_protected_communications_2">5.2. Protected Communications</h3>
<div class="sect3">
<h4 id="_fcs_ipsec_ext_1_ipsec_selected">5.2.1. FCS_IPSEC_EXT.1 IPsec selected</h4>
<div class="sect4">
<h5 id="_tss_49">5.2.1.1. TSS</h5>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_1">5.2.1.1.1. FCS_IPSEC_EXT.1.1</h6>
<div class="paragraph">
<p>The evaluator shall examine the TSS and determine that it describes what takes place when a packet is processed by the TOE, e.g., the algorithm used to process the packet. The TSS describes how the SPD is implemented and the rules for processing both inbound and outbound packets in terms of the IPsec policy. The TSS describes the rules that are available and the resulting actions available after matching a rule. The TSS describes how those rules and actions form the SPD in terms of the BYPASS (e.g., no encryption), DISCARD (e.g., drop the packet), and PROTECT (e.g., encrypt the packet) actions defined in RFC 4301.</p>
</div>
<div class="paragraph">
<p>As noted in section 4.4.1 of RFC 4301, the processing of entries in the SPD is non-trivial and the evaluator shall determine that the description in the TSS is sufficient to determine which rules will be applied given the rule structure implemented by the TOE. For example, if the TOE allows specification of ranges, conditional rules, etc., the evaluator shall determine that the description of rule processing (for both inbound and outbound packets) is sufficient to determine the action that will be applied, especially in the case where two different rules may apply. This description shall cover both the initial packets (that is, no SA is established on the interface or for that particular packet) as well as packets that are part of an established SA.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_3">5.2.1.1.2. FCS_IPSEC_EXT.1.3</h6>
<div class="paragraph">
<p>The evaluator checks the TSS to ensure it states that the VPN can be established to operate in transport mode and/or tunnel mode (as identified in FCS_IPSEC_EXT.1.3).</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_4">5.2.1.1.3. FCS_IPSEC_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator shall examine the TSS to verify that the selected algorithms are implemented. In addition, the evaluator ensures that the SHA-based HMAC algorithm conforms to the algorithms specified in FCS_COP.1/KeyedHash Cryptographic Operation (for keyed-hash message authentication) and if the SHA-based HMAC function truncated output is utilized it must also be described.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_5">5.2.1.1.4. FCS_IPSEC_EXT.1.5</h6>
<div class="paragraph">
<p>The evaluator shall examine the TSS to verify that IKEv1 and/or IKEv2 are implemented.</p>
</div>
<div class="paragraph">
<p>For IKEv1 implementations, the evaluator shall examine the TSS to ensure that, in the description of the IPsec protocol, it states that aggressive mode is not used for IKEv1 Phase 1 exchanges, and that only main mode is used. It may be that this is a configurable option.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_6">5.2.1.1.5. FCS_IPSEC_EXT.1.6</h6>
<div class="paragraph">
<p>The evaluator shall ensure the TSS identifies the algorithms used for encrypting the IKEv1 and/or IKEv2 payload, and that the algorithms chosen in the selection of the requirement are included in the TSS discussion.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_7">5.2.1.1.6. FCS_IPSEC_EXT.1.7</h6>
<div class="paragraph">
<p>The evaluator shall ensure the TSS identifies the lifetime configuration method used for limiting the IKEv1 Phase 1 SA lifetime and/or the IKEv2 SA lifetime. The evaluator shall verify that the selection made here corresponds to the selection in FCS_IPSEC_EXT.1.5.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_8">5.2.1.1.7. FCS_IPSEC_EXT.1.8</h6>
<div class="paragraph">
<p>The evaluator shall ensure the TSS identifies the lifetime configuration method used for limiting the IKEv1 Phase 2 SA lifetime and/or the IKEv2 Child SA lifetime. The evaluator shall verify that the selection made here corresponds to the selection in FCS_IPSEC_EXT.1.5.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_9">5.2.1.1.8. FCS_IPSEC_EXT.1.9</h6>
<div class="paragraph">
<p>The evaluator shall check to ensure that, for each DH group supported, the TSS describes the process for generating "x". The evaluator shall verify that the TSS indicates that the random number generated that meets the requirements in this cPP is used, and that the length of "x" meets the stipulations in the requirement.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_10">5.2.1.1.9. FCS_IPSEC_EXT.1.10</h6>
<div class="paragraph">
<p>If the first selection is chosen, the evaluator shall check to ensure that, for each DH group supported, the TSS describes the process for generating each nonce. The evaluator shall verify that the TSS indicates that the random number generated that meets the requirements in this cPP is used, and that the length of the nonces meet the stipulations in the requirement.</p>
</div>
<div class="paragraph">
<p>If the second selection is chosen, the evaluator shall check to ensure that, for each PRF hash supported, the TSS describes the process for generating each nonce. The evaluator shall verify that the TSS indicates that the random number generated that meets the requirements in this cPP is used, and that the length of the nonces meet the stipulations in the requirement.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_11">5.2.1.1.10. FCS_IPSEC_EXT.1.11</h6>
<div class="paragraph">
<p>The evaluator shall check to ensure that the DH groups specified in the requirement are listed as being supported in the TSS. If there is more than one DH group supported, the evaluator checks to ensure the TSS describes how a particular DH group is specified/negotiated with a peer.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_12">5.2.1.1.11. FCS_IPSEC_EXT.1.12</h6>
<div class="paragraph">
<p>The evaluator shall check that the TSS describes the potential strengths (in terms of the number of bits in the symmetric key) of the algorithms that are allowed for the IKE and ESP exchanges. The TSS shall also describe the checks that are done when negotiating IKEv1 Phase 2 and/or IKEv2 CHILD_SA suites to ensure that the strength (in terms of the number of bits of key in the symmetric algorithm) of the negotiated algorithm is less than or equal to that of the IKE SA this is protecting the negotiation.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_13">5.2.1.1.12. FCS_IPSEC_EXT.1.13</h6>
<div class="paragraph">
<p>The evaluator ensures that the TSS identifies RSA and/or ECDSA as being used to perform peer authentication. The description must be consistent with the algorithms as specified in FCS_COP.1/SigGen Cryptographic Operation (for cryptographic signature).</p>
</div>
<div class="paragraph">
<p>If pre-shared keys are chosen in the selection, the evaluator shall check to ensure that the TSS describes how pre-shared keys are established and used in authentication of IPsec connections. The description in the TSS shall also indicate how pre-shared key establishment is accomplished for TOEs that can generate a pre-shared key as well as TOEs that simply use a pre-shared key.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_14">5.2.1.1.13. FCS_IPSEC_EXT.1.14</h6>
<div class="paragraph">
<p>The evaluator shall ensure that the TSS describes how the TOE compares the peers presented identifier to the reference identifier. This description shall include which field(s) of the certificate are used as the presented identifier (DN, Common Name, or SAN). If the TOE simultaneously supports the same identifier type in the CN and SAN, the TSS shall describe how the TOE prioritizes the comparisons (e.g. the result of comparison if CN matches but SAN does not). If the location (e.g. CN or SAN) of non-DN identifier types must explicitly be configured as part of the reference identifier, the TSS shall state this. If the ST author assigned an additional identifier type, the TSS description shall also include a description of that type and the method by which that type is compared to the peers presented certificate, including what field(s) are compared and which fields take precedence in the comparison.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_40">5.2.1.2. Guidance Documentation</h5>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_1_2">5.2.1.2.1. FCS_IPSEC_EXT.1.1</h6>
<div class="paragraph">
<p>The evaluator shall examine the guidance documentation to verify it instructs the Administrator how to construct entries into the SPD that specify a rule for processing a packet. The description includes all three cases  a rule that ensures packets are encrypted/decrypted, dropped, and flow through the TOE without being encrypted. The evaluator shall determine that the description in the guidance documentation is consistent with the description in the TSS, and that the level of detail in the guidance documentation is sufficient to allow the administrator to set up the SPD in an unambiguous fashion. This includes a discussion of how ordering of rules impacts the processing of an IP packet.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_3_2">5.2.1.2.2. FCS_IPSEC_EXT.1.3</h6>
<div class="paragraph">
<p>The evaluator shall confirm that the guidance documentation contains instructions on how to configure the connection in each mode selected.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_4_2">5.2.1.2.3. FCS_IPSEC_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator checks the guidance documentation to ensure it provides instructions on how to configure the TOE to use the algorithms selected.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_5_2">5.2.1.2.4. FCS_IPSEC_EXT.1.5</h6>
<div class="paragraph">
<p>The evaluator shall check the guidance documentation to ensure it instructs the administrator how to configure the TOE to use IKEv1 and/or IKEv2 (as selected), and how to configure the TOE to perform NAT traversal (if selected).</p>
</div>
<div class="paragraph">
<p>If the IKEv1 Phase 1 mode requires configuration of the TOE prior to its operation, the evaluator shall check the guidance documentation to ensure that instructions for this configuration are contained within that guidance.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_6_2">5.2.1.2.5. FCS_IPSEC_EXT.1.6</h6>
<div class="paragraph">
<p>The evaluator ensures that the guidance documentation describes the configuration of all selected algorithms in the requirement.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_7_2">5.2.1.2.6. FCS_IPSEC_EXT.1.7</h6>
<div class="paragraph">
<p>The evaluator shall verify that the values for SA lifetimes can be configured and that the instructions for doing so are located in the guidance documentation. If time-based limits are supported, the evaluator ensures that the Administrator is able to configure Phase 1 SA values for 24 hours. Currently there are no values mandated for the number of bytes, the evaluator just ensures that this can be configured if selected in the requirement.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_8_2">5.2.1.2.7. FCS_IPSEC_EXT.1.8</h6>
<div class="paragraph">
<p>The evaluator shall verify that the values for SA lifetimes can be configured and that the instructions for doing so are located in the guidance documentation. If time-based limits are supported, the evaluator ensures that the Administrator is able to configure Phase 2 SA values for 8 hours. Currently there are no values mandated for the number of bytes, the evaluator just ensures that this can be configured if selected in the requirement.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_11_2">5.2.1.2.8. FCS_IPSEC_EXT.1.11</h6>
<div class="paragraph">
<p>The evaluator ensures that the guidance documentation describes the configuration of all algorithms selected in the requirement.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_13_2">5.2.1.2.9. FCS_IPSEC_EXT.1.13</h6>
<div class="paragraph">
<p>The evaluator ensures the guidance documentation describes how to set up the TOE to use certificates with RSA and/or ECDSA signatures and public keys.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check that the guidance documentation describes how pre-shared keys are to be generated and established. The description in the guidance documentation shall also indicate how pre-shared key establishment is accomplished for TOEs that can generate a pre-shared key as well as TOEs that simply use a pre-shared key.</p>
</div>
<div class="paragraph">
<p>The evaluator will ensure that the guidance documentation describes how to configure the TOE to connect to a trusted CA and ensure a valid certificate for that CA is loaded into the TOE and marked trusted.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_14_2">5.2.1.2.10. FCS_IPSEC_EXT.1.14</h6>
<div class="paragraph">
<p>The evaluator shall ensure that the operational guidance describes all supported identifiers, explicitly states whether the TOE supports the SAN extension or not and includes detailed instructions on how to configure the reference identifier(s) used to check the identity of peer(s). If the identifier scheme implemented by the TOE does not guarantee unique identifiers, the evaluator shall ensure that the operational guidance provides a set of warnings and/or CA policy recommendations that would result in secure TOE use.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_47">5.2.1.3. Tests</h5>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_1_3">5.2.1.3.1. FCS_IPSEC_EXT.1.1</h6>
<div class="paragraph">
<p>The evaluator uses the guidance documentation to configure the TOE to carry out the following tests:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall configure the SPD such that there is a rule for dropping a packet, encrypting a packet, and (if configurable) allowing a packet to flow in plaintext. The selectors used in the construction of the rule shall be different such that the evaluator can generate a packet and send packets to the gateway with the appropriate fields (fields that are used by the rule - e.g., the IP addresses, TCP/UDP ports) in the packet header. The evaluator performs both positive and negative test cases for each type of rule (e.g. a packet that matches the rule and another that does not match the rule). The evaluator observes via the audit trail, and packet captures that the TOE exhibited the expected behaviour: appropriate packets were dropped, allowed to flow without modification, encrypted by the IPsec implementation.</p>
</li>
<li>
<p>Test 2: The evaluator shall devise several tests that cover a variety of scenarios for packet processing. As with Test 1, the evaluator ensures both positive and negative test cases are constructed. These scenarios must exercise the range of possibilities for SPD entries and processing modes as outlined in the TSS and guidance documentation. Potential areas to cover include rules with overlapping ranges and conflicting entries, inbound and outbound packets, and packets that establish SAs as well as packets that belong to established SAs. The evaluator shall verify, via the audit trail and packet captures, for each scenario that the expected behavior is exhibited, and is consistent with both the TSS and the guidance documentation.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_2">5.2.1.3.2. FCS_IPSEC_EXT.1.2</h6>
<div class="paragraph">
<p>The evaluator uses the guidance documentation to configure the TOE to carry out the following tests:</p>
</div>
<div class="paragraph">
<p>The evaluator shall configure the SPD such that there is a rule for dropping a packet, encrypting a packet, and (if configurable) allowing a packet to flow in plaintext. The evaluator may use the SPD that was created for verification of FCS_IPSEC_EXT.1.1. The evaluator shall construct a network packet that matches the rule to allow the packet to flow in plaintext and send that packet. The evaluator should observe that the network packet is passed to the proper destination interface with no modification. The evaluator shall then modify a field in the packet header; such that it no longer matches the evaluator-created entries (there may be a TOE created final entry that discards packets that do not match any previous entries). The evaluator sends the packet and observes that the packet was dropped.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_3_3">5.2.1.3.3. FCS_IPSEC_EXT.1.3</h6>
<div class="paragraph">
<p>The evaluator shall perform the following test(s) based on the selections chosen:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: [conditional] If tunnel mode is selected, the evaluator uses the guidance documentation to configure the TOE to operate in tunnel mode and also configures a VPN peer to operate in tunnel mode. The evaluator configures the TOE and the VPN peer to use any of the allowable cryptographic algorithms, authentication methods, etc. to ensure an allowable SA can be negotiated. The evaluator shall then initiate a connection from the TOE to connect to the VPN peer. The evaluator observes (for example, in the audit trail and the captured packets) that a successful connection was established using the tunnel mode.</p>
</li>
<li>
<p>Test 2: [conditional] If transport mode is selected, the evaluator uses the guidance documentation to configure the TOE to operate in transport mode and also configures a VPN peer to operate in transport mode. The evaluator configures the TOE and the VPN peer to use any of the allowed cryptographic algorithms, authentication methods, etc. to ensure an allowable SA can be negotiated. The evaluator then initiates a connection from the TOE to connect to the VPN peer. The evaluator observes (for example, in the audit trail and the captured packets) that a successful connection was established using the transport mode.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_4_3">5.2.1.3.4. FCS_IPSEC_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator shall configure the TOE as indicated in the guidance documentation configuring the TOE to use each of the supported algorithms, attempt to establish a connection using ESP, and verify that the attempt succeeds.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_5_3">5.2.1.3.5. FCS_IPSEC_EXT.1.5</h6>
<div class="paragraph">
<p>Tests are performed in conjunction with the other IPsec evaluation activities.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: If IKEv1 is selected, the evaluator shall configure the TOE as indicated in the guidance documentation and attempt to establish a connection using an IKEv1 Phase 1 connection in aggressive mode. This attempt should fail. The evaluator should then show that main mode exchanges are supported.</p>
</li>
<li>
<p>Test 2: If NAT traversal is selected within the IKEv2 selection, the evaluator shall configure the TOE so that it will perform NAT traversal processing as described in the TSS and RFC 5996, section 2.23. The evaluator shall initiate an IPsec connection and determine that the NAT is successfully traversed.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_6_3">5.2.1.3.6. FCS_IPSEC_EXT.1.6</h6>
<div class="paragraph">
<p>The evaluator shall configure the TOE to use the ciphersuite under test to encrypt the IKEv1 and/or IKEv2 payload and establish a connection with a peer device, which is configured to only accept the payload encrypted using the indicated ciphersuite. The evaluator will confirm the algorithm was that used in the negotiation.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_7_3">5.2.1.3.7. FCS_IPSEC_EXT.1.7</h6>
<div class="paragraph">
<p>When testing this functionality, the evaluator needs to ensure that both sides are configured appropriately. From the RFC A difference between IKEv1 and IKEv2 is that in IKEv1 SA lifetimes were negotiated. In IKEv2, each end of the SA is responsible for enforcing its own lifetime policy on the SA and rekeying the SA when necessary. If the two ends have different lifetime policies, the end with the shorter lifetime will end up always being the one to request the rekeying. If the two ends have the same lifetime policies, it is possible that both will initiate a rekeying at the same time (which will result in redundant SAs). To reduce the probability of this happening, the timing of rekeying requests SHOULD be jittered.</p>
</div>
<div class="paragraph">
<p>Each of the following tests shall be performed for each version of IKE selected in the FCS_IPSEC_EXT.1.5 protocol selection:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: [conditional] If number of bytes is selected as the SA lifetime measure, the evaluator shall configure a maximum lifetime in terms of the number of bytes allowed following the guidance documentation. The evaluator shall configure a test peer with a byte lifetime that exceeds the lifetime of the TOE. The evaluator shall establish a SA between the TOE and the test peer, and determine that once the allowed number of bytes through this SA is exceeded, a new SA is negotiated. The evaluator shall verify that the TOE initiates a Phase 1 negotiation.</p>
</li>
<li>
<p>Test 2: [conditional] If length of time is selected as the SA lifetime measure, the evaluator shall configure a maximum lifetime of 24 hours for the Phase 1 SA following the guidance documentation. The evaluator shall configure a test peer with a lifetime that exceeds the lifetime of the TOE. The evaluator shall establish a SA between the TOE and the test peer, maintain the Phase 1 SA for 24 hours, and determine that a new Phase 1 SA is negotiated on or before 24 hours has elapsed. The evaluator shall verify that the TOE initiates a Phase 1 negotiation.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_8_3">5.2.1.3.8. FCS_IPSEC_EXT.1.8</h6>
<div class="paragraph">
<p>When testing this functionality, the evaluator needs to ensure that both sides are configured appropriately. From the RFC A difference between IKEv1 and IKEv2 is that in IKEv1 SA lifetimes were negotiated. In IKEv2, each end of the SA is responsible for enforcing its own lifetime policy on the SA and rekeying the SA when necessary. If the two ends have different lifetime policies, the end with the shorter lifetime will end up always being the one to request the rekeying. If the two ends have the same lifetime policies, it is possible that both will initiate a rekeying at the same time (which will result in redundant SAs). To reduce the probability of this happening, the timing of rekeying requests SHOULD be jittered.</p>
</div>
<div class="paragraph">
<p>Each of the following tests shall be performed for each version of IKE selected in the FCS_IPSEC_EXT.1.5 protocol selection:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: [conditional] If number of bytes is selected as the SA lifetime measure, the evaluator shall configure a maximum lifetime in terms of the number of bytes allowed following the guidance documentation. The evaluator shall configure a test peer with a byte lifetime that exceeds the lifetime of the TOE. The evaluator shall establish a SA between the TOE and the test peer, and determine that once the allowed number of bytes through this SA is exceeded, a new SA is negotiated. The evaluator shall verify that the TOE initiates a Phase 2 negotiation.</p>
</li>
<li>
<p>Test 2: [conditional] If length of time is selected as the SA lifetime measure, the evaluator shall configure a maximum lifetime of 8 hours for the Phase 2 SA following the guidance documentation. The evaluator shall configure a test peer with a lifetime that exceeds the lifetime of the TOE. The evaluator shall establish a SA between the TOE and the test peer, maintain the Phase 1 SA for 8 hours, and determine that once a new Phase 2 SA is negotiated when or before 8 hours has lapsed. The evaluator shall verify that the TOE initiates a Phase 2 negotiation.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_10_2">5.2.1.3.9. FCS_IPSEC_EXT.1.10</h6>
<div class="paragraph">
<p>The following tests shall be performed.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: If IKEv1 is supported, Configure the TOE to use IKEv1:</p>
<div class="ulist">
<ul>
<li>
<p>Test 1.a: If according to the security strength associated with the negotiated DiffieHellman group has been selected, for each supported authentication methods and DH
groups, demonstrate the TOE uses phase 1 and phase 2 nonces meeting the strength
requirement defined in NIST SP 800-57 for the appropriate DH group.</p>
</li>
<li>
<p>Test 1.b: If at least 128 bits in size and at least half the output size of the negotiated
pseudorandom function (PRF) hash has been selected, for each supported
authentication method and PRF hash, demonstrate the TOE uses phase 1 and phase 2
nonces suitable for the selected PRF.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Test 2: If IKEv2 is supported, configure the TOE to use IKEv2:</p>
<div class="ulist">
<ul>
<li>
<p>For each supported DH group, demonstrate the TOE uses IKE_SA_INIT and CREATE_CHILD_SA nonces suitable for the selected PRF.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_11_3">5.2.1.3.10. FCS_IPSEC_EXT.1.11</h6>
<div class="paragraph">
<p>For each supported DH group, the evaluator shall test to ensure that all supported IKE protocols can be successfully completed using that particular DH group.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_12_2">5.2.1.3.11. FCS_IPSEC_EXT.1.12</h6>
<div class="paragraph">
<p>The evaluator simply follows the guidance to configure the TOE to perform the following tests.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: This test shall be performed for each version of IKE supported. The evaluator shall successfully negotiate an IPsec connection using each of the supported algorithms and hash functions identified in the requirements.</p>
</li>
<li>
<p>Test 2: This test shall be performed for each version of IKE supported. The evaluator shall attempt to establish a SA for ESP that selects an encryption algorithm with more strength than that being used for the IKE SA (i.e., symmetric algorithm with a key size larger than that being used for the IKE SA). Such attempts should fail.</p>
</li>
<li>
<p>Test 3: This test shall be performed for each version of IKE supported. The evaluator shall attempt to establish an IKE SA using an algorithm that is not one of the supported algorithms and hash functions identified in the requirements. Such an attempt should fail.</p>
</li>
<li>
<p>Test 4: This test shall be performed for each version of IKE supported. The evaluator shall attempt to establish a SA for ESP (assumes the proper parameters where used to establish the IKE SA) that selects an encryption algorithm that is not identified in FCS_IPSEC_EXT.1.4. Such an attempt should fail.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_13_3">5.2.1.3.12. FCS_IPSEC_EXT.1.13</h6>
<div class="paragraph">
<p>For efficiency sake, the testing is combined with the testing for FIA_X509_EXT.1, FIA_X509_EXT.2 (for IPsec connections), and FCS_IPSEC_EXT.1.1.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_ipsec_ext_1_14_3">5.2.1.3.13. FCS_IPSEC_EXT.1.14</h6>
<div class="paragraph">
<p>In the context of the tests below, a valid certificate is a certificate that passes FIA_X509_EXT.1 validation checks but does not necessarily contain an authorized subject.</p>
</div>
<div class="paragraph">
<p>The evaluator shall perform the following tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Test 1: [conditional] For each CN/identifier type combination selected, the evaluator shall configure the peers reference identifier on the TOE (per the administrative guidance) to match the field in the peers presented certificate and shall verify that the IKE authentication succeeds. If the TOE prioritizes CN checking over SAN (through explicit configuration of the field when specifying the reference identifier or prioritization rules), the evaluator shall also configure the  SAN so it contains an incorrect identifier of the correct type (e.g. the reference identifier on the TOE is example.com, the CN=example.com, and the SAN:FQDN=otherdomain.com) and verify that IKE authentication succeeds.</p>
</li>
<li>
<p>Test 2: [conditional] For each SAN/identifier type combination selected, the evaluator shall configure the peers reference identifier on the TOE (per the administrative guidance) to match the field in the peers presented certificate and shall verify that the IKE authentication succeeds. If the TOE prioritizes SAN checking over CN (through explicit specification of the field when specifying the reference identifier or prioritization rules), the evaluator shall also configure the CN so it contains an incorrect identifier formatted to be the same type (e.g. the reference identifier on the TOE is DNS-ID; identify certificate has an identifier in SAN with correct DNS-ID, CN with incorrect DNS-ID (and not a different type of identifier)) and verify that IKE authentication succeeds.</p>
</li>
<li>
<p>Test 3: [conditional] For each CN/identifier type combination selected, the evaluator shall:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Create a valid certificate with the CN so it contains the valid identifier followed by nul character (ASCII null character in hex is '0x00'). If the TOE prioritizes CN checking over SAN (through explicit specification of the field when specifying the reference identifier or prioritization rules) for the same identifier type, the evaluator shall configure the SAN so it matches the reference identifier.</p>
</li>
<li>
<p>Configure the peers reference identifier on the TOE (per the administrative guidance) to match the CN without the nul character (ASCII null character in hex is '0x00') and verify that IKE authentication fails.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 4: [conditional] For each SAN/identifier type combination selected, the evaluator shall:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Create a valid certificate with an incorrect identifier in the SAN. The evaluator shall configure a string representation of the correct identifier in the DN. If the TOE prioritizes CN checking over SAN (through explicit specification of the field when specifying the reference identifier or prioritization rules) for the same identifier type, the addition/modification shall be to any non-CN field of the DN. Otherwise, the addition/modification shall be to the CN.</p>
</li>
<li>
<p>Configure the peers reference identifier on the TOE (per the administrative guidance) to match the correct identifier (expected in the SAN) and verify that IKE authentication fails.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 5: [conditional] If the TOE supports DN identifier types, the evaluator shall configure the peers reference identifier on the TOE (per the administrative guidance) to match the subject DN in the peers presented certificate and shall verify that the IKE authentication succeeds.</p>
</li>
<li>
<p>Test 6: [conditional] If the TOE supports DN identifier types, to demonstrate a bit-wise comparison of the DN, the evaluator shall create the following valid certificates and verify that the IKE authentication fails when each certificate is presented to the TOE:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Duplicate the CN field, so the otherwise authorized DN contains two identical CNs.</p>
</li>
<li>
<p>Append \0 to a non-CN field of an otherwise authorized DN.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_tlsc_ext_1_tls_client_protocol_without_mutual_authentication">5.2.2. FCS_TLSC_EXT.1 TLS Client Protocol without mutual authentication</h4>
<div class="sect4">
<h5 id="_tss_50">5.2.2.1. TSS</h5>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_1_1">5.2.2.1.1. FCS_TLSC_EXT.1.1</h6>
<div class="paragraph">
<p>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that the ciphersuites supported are specified. The evaluator shall check the TSS to ensure that the ciphersuites specified include those listed for this component.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_1_2">5.2.2.1.2. FCS_TLSC_EXT.1.2</h6>
<div class="paragraph">
<p>The evaluator shall ensure that the TSS describes the clients method of establishing all reference identifiers from the administrator/application-configured reference identifier, including which types of reference identifiers are supported (e.g. application-specific Subject Alternative Names) and whether IP addresses and wildcards are supported.</p>
</div>
<div class="paragraph">
<p>If IP addresses are supported in the CN as reference identifiers, the evaluator shall ensure that the TSS describes the TOEs conversion of the text representation of the IP address in the CN to a binary representation of the IP address in network byte order. The evaluator shall also ensure that the TSS describes whether canonical format (RFC 5952 for IPv6, RFC 3986 for IPv4) is enforced.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_1_4">5.2.2.1.3. FCS_TLSC_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator shall verify that TSS describes the Supported Elliptic Curves/Supported Groups Extension and whether the required behaviour is performed by default or may be configured.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_41">5.2.2.2. Guidance Documentation</h5>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_1_1_2">5.2.2.2.1. FCS_TLSC_EXT.1.1</h6>
<div class="paragraph">
<p>The evaluator shall check the guidance documentation to ensure that it contains instructions on configuring the TOE so that TLS conforms to the description in the TSS.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_1_2_2">5.2.2.2.2. FCS_TLSC_EXT.1.2</h6>
<div class="paragraph">
<p>The evaluator shall ensure that the operational guidance describes all supported identifiers, explicitly states whether the TOE supports the SAN extension or not and includes detailed instructions on how to configure the reference identifier(s) used to check the identity of peer(s). If the identifier scheme implemented by the TOE includes support for IP addresses, the evaluator shall ensure that the operational guidance provides a set of warnings and/or CA policy recommendations that would result in secure TOE use.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_1_4_2">5.2.2.2.3. FCS_TLSC_EXT.1.4</h6>
<div class="paragraph">
<p>If the TSS indicates that the Supported Elliptic Curves/Supported Groups Extension must be configured to meet the requirement, the evaluator shall verify that AGD guidance includes configuration of the Supported Elliptic Curves/Supported Groups Extension.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_48">5.2.2.3. Tests</h5>
<div class="paragraph">
<p>For all tests in this chapter the TLS server used for testing of the TOE shall be configured not to require mutual authentication.</p>
</div>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_1_1_3">5.2.2.3.1. FCS_TLSC_EXT.1.1</h6>
<div class="paragraph">
<p>Test 1: The evaluator shall establish a TLS connection using each of the ciphersuites specified by the requirement. This connection may be established as part of the establishment of a higher-level protocol, e.g., as part of an HTTPS session. It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</p>
</div>
<div class="paragraph">
<p>Test 2: The evaluator shall attempt to establish the connection using a server with a server certificate that contains the Server Authentication purpose in the extendedKeyUsage field and verify that a connection is established. The evaluator will then verify that the client rejects an otherwise valid server certificate that lacks the Server Authentication purpose in the extendedKeyUsage field, and a connection is not established. Ideally, the two certificates should be identical except for the extendedKeyUsage field.</p>
</div>
<div class="paragraph">
<p>Test 3: The evaluator shall send a server certificate in the TLS connection that does not match the server-selected ciphersuite (for example, send an ECDSA certificate while using the TLS_RSA_WITH_AES_128_CBC_SHA ciphersuite). The evaluator shall verify that the TOE disconnects after receiving the servers Certificate handshake message.</p>
</div>
<div class="paragraph">
<p>Test 4: The evaluator shall perform the following 'negative tests':</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The evaluator shall configure the server to select the TLS_NULL_WITH_NULL_NULL ciphersuite and verify that the client denies the connection.</p>
</li>
<li>
<p>Modify the servers selected ciphersuite in the Server Hello handshake message to be a ciphersuite not presented in the Client Hello handshake message. The evaluator shall verify that the client rejects the connection after receiving the Server Hello.</p>
</li>
<li>
<p>[conditional]: If the TOE presents the Supported Elliptic Curves/Supported Groups Extension the evaluator shall configure the server to perform an ECDHE or DHE key exchange in the TLS connection using a non-supported curve/group (for example P-192) and shall verify that the TOE disconnects after receiving the servers Key Exchange handshake message.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Test 5: The evaluator performs the following modifications to the traffic:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change the TLS version selected by the server in the Server Hello to a non-supported TLS version and verify that the client rejects the connection.</p>
</li>
<li>
<p>[conditional]: If using DHE or ECDH, modify the signature block in the Servers Key Exchange handshake message, and verify that the handshake does not finished successfully, and no application data flows. This test does not apply to cipher suites using RSA key exchange. If a TOE only supports RSA key exchange in conjunction with TLS, then this test shall be omitted.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Test 6: The evaluator performs the following 'scrambled message tests':</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Modify a byte in the Server Finished handshake message and verify that the handshake does not finish successfully and no application data flows.</p>
</li>
<li>
<p>Send a garbled message from the server after the server has issued the ChangeCipherSpec message and verify that the handshake does not finish successfully and no application data flows.</p>
</li>
<li>
<p>Modify at least one byte in the servers nonce in the Server Hello handshake message and verify that the client rejects the Server Key Exchange handshake message (if using a DHE or ECDHE ciphersuite) or that the server denies the clients Finished handshake message.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_1_2_3">5.2.2.3.2. FCS_TLSC_EXT.1.2</h6>
<div class="paragraph">
<p>Note that the following tests are marked conditional and are applicable under the following conditions:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For TLS-based trusted channel communications according to FTP_ITC.1 where RFC 6125 is selected, tests 1-6 are applicable.</p>
<div class="paragraph">
<p>or</p>
</div>
</li>
<li>
<p>For TLS-based trusted path communications according to FTP_TRP where RFC 6125 is selected, tests 1-6 are applicable</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note that for some tests additional conditions apply.</p>
</div>
<div class="paragraph">
<p>IP addresses are binary values that must be converted to a textual representation when presented in the CN of a certificate. When testing IP addresses in the CN, the evaluator shall follow the following formatting rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>IPv4: The CN contains a single address that is represented a 32-bit numeric address (IPv4) is written in decimal as four numbers that range from 0-255 separated by periods as specified in RFC 3986.</p>
</li>
<li>
<p>IPv6: The CN contains a single IPv6 address that is represented as eight colon separated groups of four lowercase hexadecimal digits, each group representing 16 bits as specified in RFC 4291. Note: Shortened addresses, suppressed zeros, and embedded IPv4 addresses are not tested.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The evaluator shall configure the reference identifier according to the AGD guidance and perform the following tests during a TLS connection:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1 [conditional]: The evaluator shall present a server certificate that contains a CN that does not match the reference identifier and does not contain the SAN extension. The evaluator shall verify that the connection fails. The evaluator shall repeat this test for each identifier type (e.g. IPv4, IPv6, FQDN) supported in the CN. When testing IPv4 or IPv6 addresses, the evaluator shall modify a single decimal or hexadecimal digit in the CN.
Remark: Some systems might require the presence of the SAN extension. In this case the connection would still fail but for the reason of the missing SAN extension instead of the mismatch of CN and reference identifier. Both reasons are acceptable to pass Test 1.</p>
</li>
<li>
<p>Test 2 [conditional]: The evaluator shall present a server certificate that contains a CN that matches the reference identifier, contains the SAN extension, but does not contain an identifier in the SAN that matches the reference identifier. The evaluator shall verify that the connection fails. The evaluator shall repeat this test for each supported SAN type (e.g. IPv4, IPv6, FQDN, URI). When testing IPv4 or IPv6 addresses, the evaluator shall modify a single decimal or hexadecimal digit in the SAN.</p>
</li>
<li>
<p>Test 3 [conditional]: If the TOE does not mandate the presence of the SAN extension, the evaluator shall present a server certificate that contains a CN that matches the reference identifier and does not contain the SAN extension. The evaluator shall verify that the connection succeeds. The evaluator shall repeat this test for each identifier type (e.g. IPv4, IPv6, FQDN) supported in the CN. If the TOE does mandate the presence of the SAN extension, this Test shall be omitted.</p>
</li>
<li>
<p>Test 4 [conditional]: The evaluator shall present a server certificate that contains a CN that does not match the reference identifier but does contain an identifier in the SAN that matches. The evaluator shall verify that the connection succeeds. The evaluator shall repeat this test for each supported SAN type (e.g. IPv4, IPv6, FQDN, SRV).</p>
</li>
<li>
<p>Test 5 [conditional]: The evaluator shall perform the following wildcard tests with each supported type of reference identifier that includes a DNS name (i.e. CN-ID with DNS, DNS-ID, SRV-ID, URI-ID):</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>[conditional]: The evaluator shall present a server certificate containing a wildcard that is not in the left-most label of the presented identifier (e.g. foo.*.example.com) and verify that the connection fails.</p>
</li>
<li>
<p>[conditional]: The evaluator shall present a server certificate containing a wildcard in the left-most label (e.g. *.example.com). The evaluator shall configure the reference identifier with a single left-most label (e.g. foo.example.com) and verify that the connection succeeds, if wildcards are supported, or fails if wildcards are not supported. The evaluator shall configure the reference identifier without a left-most label as in the certificate (e.g. example.com) and verify that the connection fails. The evaluator shall configure the reference identifier with two left-most labels (e.g. bar.foo.example.com) and verify that the connection fails. (Remark: Support for wildcards was always intended to be optional. It is sufficient to state that the TOE does not support wildcards and observe rejected connection attempts to satisfy corresponding assurance activities.)</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 6 [conditional]: If IP addresses are supported, the evaluator shall present a server certificate that contains a CN that matches the reference identifier, except one of the groups has been replaced with an asterisk (*) (e.g. CN=192.168.1.\* when connecting to 192.168.1.20, CN=2001:0DB8:0000:0000:0008:0800:200C:* when connecting to 2001:0DB8:0000:0000:0008:0800:200C:417A). The certificate shall not contain the SAN extension. The evaluator shall verify that the connection fails. The evaluator shall repeat this test for each supported IP address version (e.g. IPv4, IPv6).</p>
<div class="paragraph">
<p>Remark: Some systems might require the presence of the SAN extension. In this case the connection would still fail but for the reason of the missing SAN extension instead of the mismatch of CN and reference identifier. Both reasons are acceptable to pass Test 6.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_1_3">5.2.2.3.3. FCS_TLSC_EXT.1.3</h6>
<div class="paragraph">
<p>The evaluator shall demonstrate that using an invalid certificate results in the function failing as follows:</p>
</div>
<div class="paragraph">
<p>Test 1: Using the administrative guidance, the evaluator shall load a CA certificate or certificates needed to validate the presented certificate used to authenticate an external entity and demonstrate that the function succeeds, and a trusted channel can be established.</p>
</div>
<div class="paragraph">
<p>Test 2: The evaluator shall then change the presented certificate(s) so that validation fails and show that the certificate is not automatically accepted. The evaluator shall repeat this test to cover the selected types of failure defined in the SFR (i.e. the selected ones from failed matching of the reference identifier, failed validation of the certificate path, failed validation of the expiration date, failed determination of the revocation status). The evaluator performs the action indicated in the SFR selection observing the TSF resulting in the expected state for the trusted channel (e.g. trusted channel was established) covering the types of failure for which an override mechanism is defined.</p>
</div>
<div class="paragraph">
<p>Test 3 [conditional]: The purpose of this test to verify that only selected certificate validation failures could be administratively overridden. If any override mechanism is defined for failed certificate validation, the evaluator shall configure a new presented certificate that does not contain a valid entry in one of the mandatory fields or parameters (e.g. inappropriate value in extendedKeyUsage field) but is otherwise valid and signed by a trusted CA. The evaluator shall confirm that the certificate validation fails (i.e. certificate is rejected), and there is no administrative override available to accept such certificate.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlsc_ext_1_4_3">5.2.2.3.4. FCS_TLSC_EXT.1.4</h6>
<div class="paragraph">
<p>Test 1 [conditional]: If the TOE presents the Supported Elliptic Curves/Supported Groups Extension, the evaluator shall configure the server to perform ECDHE or DHE (as applicable) key exchange using each of the TOEs supported curves and/or groups. The evaluator shall verify that the TOE successfully connects to the server.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_tlss_ext_1_tls_server_protocol_without_mutual_authentication">5.2.3. FCS_TLSS_EXT.1 TLS Server Protocol without mutual authentication</h4>
<div class="sect4">
<h5 id="_tss_51">5.2.3.1. TSS</h5>
<div class="sect5">
<h6 id="_fcs_tlss_ext_1_1">5.2.3.1.1. FCS_TLSS_EXT.1.1</h6>
<div class="paragraph">
<p>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that the ciphersuites supported are specified. The evaluator shall check the TSS to ensure that the ciphersuites specified are identical to those listed for this component.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_1_2">5.2.3.1.2. FCS_TLSS_EXT.1.2</h6>
<div class="paragraph">
<p>The evaluator shall verify that the TSS contains a description of how the TOE technically prevents the use of old SSL and TLS versions.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_1_3">5.2.3.1.3. FCS_TLSS_EXT.1.3</h6>
<div class="paragraph">
<p>If using ECDHE and/or DHE ciphers, the evaluator shall verify that the TSS lists all EC Diffie-Hellman curves and/or Diffie-Hellman groups used in the key establishment by the TOE when acting as a TLS Server. For example, if the TOE supports TLS_DHE_RSA_WITH_AES_128_CBC_SHA cipher and Diffie-Hellman parameters with size 2048 bits, then list Diffie-Hellman Group 14.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_1_4">5.2.3.1.4. FCS_TLSS_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator shall verify that the TSS describes if session resumption based on session IDs is supported (RFC 4346 and/or RFC 5246) and/or if session resumption based on session tickets is supported (RFC 5077).</p>
</div>
<div class="paragraph">
<p>If session tickets are supported, the evaluator shall verify that the TSS describes that the session tickets are encrypted using symmetric algorithms consistent with FCS_COP.1/DataEncryption. The evaluator shall verify that the TSS identifies the key lengths and algorithms used to protect session tickets.</p>
</div>
<div class="paragraph">
<p>If session tickets are supported, the evaluator shall verify that the TSS describes that session tickets adhere to the structural format provided in section 4 of RFC 5077 and if not, a justification shall be given of the actual session ticket format.</p>
</div>
<div class="paragraph">
<p>If the TOE claims a (D)TLS server capable of session resumption (as a single context, or across multiple contexts), the evaluator verifies that the TSS describes how session resumption operates (i.e. what would trigger a full handshake, e.g. checking session status, checking Session ID, etc.). If multiple contexts are used the TSS describes how session resumption is coordinated across those contexts. In case session establishment and session resumption are always using a separate context, the TSS shall describe how the contexts interact with respect to session resumption (in particular regarding the session ID). It is acceptable for sessions established in one context to be resumable in another context.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_42">5.2.3.2. Guidance Documentation</h5>
<div class="sect5">
<h6 id="_fcs_tlss_ext_1_1_2">5.2.3.2.1. FCS_TLSS_EXT.1.1</h6>
<div class="paragraph">
<p>The evaluator shall check the guidance documentation to ensure that it contains instructions on configuring the TOE so that TLS conforms to the description in the TSS (for instance, the set of ciphersuites advertised by the TOE may have to be restricted to meet the requirements).</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_1_2_2">5.2.3.2.2. FCS_TLSS_EXT.1.2</h6>
<div class="paragraph">
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_1_3_2">5.2.3.2.3. FCS_TLSS_EXT.1.3</h6>
<div class="paragraph">
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_1_4_2">5.2.3.2.4. FCS_TLSS_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_49">5.2.3.3. Tests</h5>
<div class="sect5">
<h6 id="_fcs_tlss_ext_1_1_3">5.2.3.3.1. FCS_TLSS_EXT.1.1</h6>
<div class="paragraph">
<p>Test 1: The evaluator shall establish a TLS connection using each of the ciphersuites specified by the requirement. This connection may be established as part of the establishment of a higher-level protocol, e.g., as part of an HTTPS session. It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</p>
</div>
<div class="paragraph">
<p>Test 2: The evaluator shall send a Client Hello to the server with a list of ciphersuites that does not contain any of the ciphersuites in the servers ST and verify that the server denies the connection. Additionally, the evaluator shall send a Client Hello to the server containing only the TLS_NULL_WITH_NULL_NULL ciphersuite and verify that the server denies the connection.</p>
</div>
<div class="paragraph">
<p>Test 3: The evaluator shall perform the following modifications to the traffic:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Modify a byte in the Client Finished handshake message, and verify that the server rejects the connection and does not send any application data.</p>
</li>
<li>
<p>(Test Intent: The intent of this test is to ensure that the server&#8217;s TLS implementation immediately makes use of the key exchange and authentication algorithms to: a) Correctly encrypt (D)TLS Finished message and b) Encrypt every (D)TLS message after session keys are negotiated.)</p>
<div class="paragraph">
<p>The evaluator shall use one of the claimed ciphersuites to complete a successful handshake and observe transmission of properly encrypted application data. The evaluator shall verify that no Alert with alert level Fatal (2) messages were sent.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify that the Finished message (Content type hexadecimal 16 and handshake message type hexadecimal 14) is sent immediately after the server&#8217;s ChangeCipherSpec (Content type hexadecimal 14) message. The evaluator shall examine the Finished message (encrypted example in hexadecimal of a TLS record containing a Finished message, 16 03 03 00 40 11 22 33 44 55&#8230;&#8203;) and confirm that it does not contain unencrypted data (unencrypted example in hexadecimal of a TLS record containing a Finished message, 16 03 03 00 40 14 00 00 0c&#8230;&#8203;), by verifying that the first byte of the encrypted Finished message does not equal hexadecimal 14 for at least one of three test messages. There is a chance that an encrypted Finished message contains a hexadecimal value of '14' at the position where a plaintext Finished message would contain the message type code '14'. If the observed Finished message contains a hexadecimal value of '14' at the position where the plaintext Finished message would contain the message type code, the test shall be repeated three times in total. In case the value of '14' can be observed in all three tests it can be assumed that the Finished message has indeed been sent in plaintext and the test has to be regarded as 'failed'. Otherwise it has to be assumed that the observation of the value '14' has been due to chance and that the Finished message has indeed been sent encrypted. In that latter case the test shall be regarded as passed.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_1_2_3">5.2.3.3.2. FCS_TLSS_EXT.1.2</h6>
<div class="paragraph">
<p>The evaluator shall send a Client Hello requesting a connection for all mandatory and selected protocol versions in the SFR (e.g. by enumeration of protocol versions in a test client) and verify that the server denies the connection for each attempt.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_1_3_3">5.2.3.3.3. FCS_TLSS_EXT.1.3</h6>
<div class="paragraph">
<p>Test 1: [conditional] If ECDHE ciphersuites are supported:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The evaluator shall repeat this test for each supported elliptic curve. The evaluator shall attempt a connection using a supported ECDHE ciphersuite and a single supported elliptic curve specified in the Elliptic Curves Extension. The Evaluator shall verify (though a packet capture or instrumented client) that the TOE selects the same curve in the Server Key Exchange message and successfully establishes the connection.</p>
</li>
<li>
<p>The evaluator shall attempt a connection using a supported ECDHE ciphersuite and a single unsupported elliptic curve (e.g. secp192r1 (0x13)) specified in RFC4492, chap. 5.1.1. The evaluator shall verify that the TOE does not send a Server Hello message and the connection is not successfully established.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Test 2: [conditional] If DHE ciphersuites are supported, the evaluator shall repeat the following test for each supported parameter size. If any configuration is necessary, the evaluator shall configure the TOE to use a supported Diffie-Hellman parameter size. The evaluator shall attempt a connection using a supported DHE ciphersuite. The evaluator shall verify (through a packet capture or instrumented client) that the TOE sends a Server Key Exchange Message where p Length is consistent with the message are the ones configured Diffie-Hellman parameter size(s).</p>
</div>
<div class="paragraph">
<p>Test 3: [conditional] If RSA key establishment ciphersuites are supported, the evaluator shall repeat this test for each RSA key establishment key size. If any configuration is necessary, the evaluator shall configure the TOE to perform RSA key establishment using a supported key size (e.g. by loading a certificate with the appropriate key size). The evaluator shall attempt a connection using a supported RSA key establishment ciphersuite. The evaluator shall verify (through a packet capture or instrumented client) that the TOE sends a certificate whose modulus is consistent with the configured RSA key size.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_tlss_ext_1_4_3">5.2.3.3.4. FCS_TLSS_EXT.1.4</h6>
<div class="paragraph">
<p><em>Test Objective: To demonstrate that the TOE will not resume a session for which the client failed to complete the handshake (independent of TOE support for session resumption).</em></p>
</div>
<div class="paragraph">
<p>Test 1 [conditional]: If the TOE does not support session resumption based on session IDs according to RFC4346 (TLS1.1) or RFC5246 (TLS1.2) or session tickets according to RFC5077, the evaluator shall perform the following test:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The client sends a Client Hello with a zero-length session identifier and with a SessionTicket extension containing a zero-length ticket.</p>
</li>
<li>
<p>The client verifies the server does not send a NewSessionTicket handshake message (at any point in the handshake).</p>
</li>
<li>
<p>The client verifies the Server Hello message contains a zero-length session identifier or passes the following steps:</p>
<div class="paragraph">
<p>Note: The following steps are only performed if the ServerHello message contains a non-zero length SessionID.</p>
</div>
</li>
<li>
<p>The client completes the TLS handshake and captures the SessionID from the ServerHello.</p>
</li>
<li>
<p>The client sends a ClientHello containing the SessionID captured in step d). This can be done by keeping the TLS session in step d) open
or start a new TLS session using the SessionID captured in step d).</p>
</li>
<li>
<p>The client verifies the TOE (1) implicitly rejects the SessionID by sending a ServerHello containing a different SessionID and by performing a full handshake (as shown in Figure 1 of RFC 4346 or RFC 5246), or (2) terminates the connection in some way that prevents the flow of application data.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Remark: If multiple contexts are supported for session resumption, the session ID or session ticket may be obtained in one context for resumption in another context.  It is possible that one or more contexts may only permit the construction of sessions to be reused in other contexts but not actually permit resumption themselves.  For contexts which do not permit resumption, the evaluator is required to verify this behaviour subject to the description provided in the TSS. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session</p>
</div>
<div class="paragraph">
<p>Test 2 [conditional]: If the TOE supports session resumption using session IDs according to RFC4346 (TLS1.1) or RFC5246 (TLS1.2), the evaluator shall carry out the following steps (note that for each of these tests, it is not necessary to perform the test case for each supported version of TLS):</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The evaluator shall conduct a successful handshake and capture the TOE-generated session ID in the Server Hello message.  The evaluator shall then initiate a new TLS connection and send the previously captured session ID to show that the TOE resumed the previous session by responding with ServerHello containing the same SessionID immediately followed by ChangeCipherSpec and Finished messages (as shown in Figure 2 of RFC 4346 or RFC 5246).</p>
</li>
<li>
<p>The evaluator shall initiate a handshake and capture the TOE-generated session ID in the Server Hello message.  The evaluator shall then, within the same handshake, generate or force an unencrypted fatal Alert message immediately before the client would otherwise send its ChangeCipherSpec message thereby disrupting the handshake.  The evaluator shall then initiate a new Client Hello using the previously captured session ID, and verify that the server (1) implicitly rejects the session ID by sending a ServerHello containing a different SessionID and performing a full handshake (as shown in figure 1 of RFC 4346 or RFC 5246), or (2) terminates the connection in some way that prevents the flow of application data.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Remark: If multiple contexts are supported for session resumption, for each of the above test cases, the session ID may be obtained in one context for resumption in another context.  There is no requirement that the session ID be obtained and replayed within the same context subject to the description provided in the TSS.  All contexts that can reuse a session ID constructed in another context must be tested. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session.</p>
</div>
<div class="paragraph">
<p>Test 3 [conditional]: If the TOE supports session tickets according to RFC5077, the evaluator shall carry out the following steps (note that for each of these tests, it is not necessary to perform the test case for each supported version of TLS):</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The evaluator shall permit a successful TLS handshake to occur in which a session ticket is exchanged with the non-TOE client.  The evaluator shall then attempt to correctly reuse the previous session by sending the session ticket in the ClientHello.  The evaluator shall confirm that the TOE responds with a ServerHello with an empty SessionTicket extension, NewSessionTicket, ChangeCipherSpec and Finished messages (as seen in figure 2 of RFC 5077).</p>
</li>
<li>
<p>The evaluator shall permit a successful TLS handshake to occur in which a session ticket is exchanged with the non-TOE client.  The evaluator will then modify the session ticket and send it as part of a new Client Hello message.  The evaluator shall confirm that the TOE either (1) implicitly rejects the session ticket by performing a full handshake (as shown in figure 3 or 4 of RFC 5077), or (2) terminates the connection in some way that prevents the flow of application data.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_dtlsc_ext_1_dtls_client_protocol_without_mutual_authentication">5.2.4. FCS_DTLSC_EXT.1 DTLS Client Protocol without mutual authentication</h4>
<div class="sect4">
<h5 id="_tss_52">5.2.4.1. TSS</h5>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_1_1">5.2.4.1.1. FCS_DTLSC_EXT.1.1</h6>
<div class="paragraph">
<p>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that the ciphersuites supported are specified. The evaluator shall check the TSS to ensure that the ciphersuites specified include those listed for this component.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_1_2">5.2.4.1.2. FCS_DTLSC_EXT.1.2</h6>
<div class="paragraph">
<p>The evaluator shall ensure that the TSS describes the clients method of establishing all reference identifiers from the administrator/application-configured reference identifier, including which types of reference identifiers are supported (e.g. application-specific Subject Alternative Names) and whether IP addresses and wildcards are supported.</p>
</div>
<div class="paragraph">
<p>If IP addresses are supported in the CN as reference identifiers, the evaluator shall ensure that the TSS describes the TOEs conversion of the text representation of the IP address in the CN to a binary representation of the IP address in network byte order. The evaluator shall also ensure that the TSS describes whether canonical format (RFC 5952 for IPv6, RFC 3986 for IPv4) is enforced.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_1_4">5.2.4.1.3. FCS_DTLSC_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator shall verify that TSS describes the Supported Elliptic Curves/Supported Groups Extension and whether the required behaviour is performed by default or may be configured.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_43">5.2.4.2. Guidance Documentation</h5>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_1_1_2">5.2.4.2.1. FCS_DTLSC_EXT.1.1</h6>
<div class="paragraph">
<p>The evaluator shall also check the guidance documentation to ensure that it contains instructions on configuring the TOE so that DTLS conforms to the description in the TSS.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_1_2_2">5.2.4.2.2. FCS_DTLSC_EXT.1.2</h6>
<div class="paragraph">
<p>The evaluator shall ensure that the operational guidance describes all supported identifiers, explicitly states whether the TOE supports the SAN extension or not and includes detailed instructions on how to configure the reference identifier(s) used to check the identity of peer(s). If the identifier scheme implemented by the TOE includes support for IP addresses, the evaluator shall ensure that the operational guidance provides a set of warnings and/or CA policy recommendations that would result in secure TOE use.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_1_4_2">5.2.4.2.3. FCS_DTLSC_EXT.1.4</h6>
<div class="paragraph">
<p>If the TSS indicates that the Supported Elliptic Curves/Supported Groups Extension must be configured to meet the requirement, the evaluator shall verify that AGD guidance includes configuration of the Supported Elliptic Curves/Supported Groups Extension.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_50">5.2.4.3. Tests</h5>
<div class="paragraph">
<p>For all tests in this chapter the DTLS server used for testing of the TOE shall be configured not to require mutual authentication.</p>
</div>
<div class="paragraph">
<p>For clarification: DTLS communication packets might be received in a different order than sent due to the use of the UDP protocol.  All tests requiring a specific order of test steps ("before", "after") are therefore referring to the sequence numbering of DTLS packets.</p>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_1_1_3">5.2.4.3.1. FCS_DTLSC_EXT.1.1</h6>
<div class="paragraph">
<p>Test 1: The evaluator shall establish a DTLS connection using each of the ciphersuites specified by the requirement. This connection may be established as part of the establishment of a higher-level application protocol, e.g., as part of a syslog session. It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).
11	The goal of the following test is to verify that the TOE accepts only certificates with appropriate values in the extendedKeyUsage extension, and implicitly that the TOE correctly parses the extendedKeyUsage extension as part of X.509v3 server certificate validation.</p>
</div>
<div class="paragraph">
<p>Test 2: The evaluator shall attempt to establish the connection using a server with a server certificate that contains the Server Authentication purpose in the extendedKeyUsage extension and verify that a connection is established. The evaluator shall repeat this test using a different, but otherwise valid and trusted, certificate that lacks the Server Authentication purpose in the extendedKeyUsage extension and ensure that a connection is not established. Ideally, the two certificates should be similar in structure, the types of identifiers used, and the chain of trust.</p>
</div>
<div class="paragraph">
<p>Test 3: The evaluator shall send a server certificate in the DTLS connection that does not match the server-selected ciphersuite (for example, send an ECDSA certificate while using the TLS_RSA_WITH_AES_128_CBC_SHA ciphersuite). The evaluator shall verify that the TOE disconnects after receiving the servers Certificate handshake message.</p>
</div>
<div class="paragraph">
<p>Test 4: The evaluator shall perform the following 'negative tests':</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The evaluator shall configure the server to select the TLS_NULL_WITH_NULL_NULL ciphersuite and verify that the client denies the connection.</p>
</li>
<li>
<p>Modify the servers selected ciphersuite in the Server Hello handshake message to be a ciphersuite not presented in the Client Hello handshake message. The evaluator shall verify that the client rejects the connection after receiving the Server Hello.</p>
</li>
<li>
<p>[conditional]: If the TOE presents the Supported Elliptic Curves/Supported Groups Extension the evaluator shall configure the server to perform an ECDHE or DHE key exchange in the DTLS connection using a non-supported curve/group (for example P-192) and shall verify that the TOE disconnects after receiving the servers Key Exchange handshake message.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Test 5: The evaluator performs the following modifications to the traffic:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change the DTLS version selected by the server in the Server Hello to a non-supported DTLS version and verify that the client rejects the connection.</p>
</li>
<li>
<p>[conditional]: If using DHE or ECDH, modify the signature block in the Servers Key Exchange handshake message, and verify that the handshake is not finished successfully and no application data flows. This test does not apply to cipher suites using RSA key exchange. If a TOE only supports RSA key exchange in conjunction with DTLS, then this test shall be omitted.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Test 6: The evaluator performs the following 'scrambled message tests':</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Modify a byte in the Server Finished handshake message and verify that the handshake is not finished successfully and no application data flows.</p>
</li>
<li>
<p>Send a garbled message from the Server after the Server has issued the ChangeCipherSpec message and verify that the handshake is not finished successfully and no application data flows.</p>
</li>
<li>
<p>Modify at least one byte in the servers nonce in the Server Hello handshake message and verify that the client rejects the Server Key Exchange handshake message (if using a DHE or ECDHE ciphersuite) or that the server denies the clients Finished handshake message.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_1_2_3">5.2.4.3.2. FCS_DTLSC_EXT.1.2</h6>
<div class="paragraph">
<p>Note that tests 1-6 are only applicable to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DTLS-based trusted channel communications according to FTP_ITC.1 and trusted path communications according to FTP_TRP.1</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>IP addresses are binary values that must be converted to a textual representation when presented in the CN of a certificate. When testing IP addresses in the CN, the evaluator shall follow the following formatting rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>IPv4: The CN contains a single address that is represented a 32-bit numeric address (IPv4) is written in decimal as four numbers that range from 0-255 separated by periods as specified in RFC 3986.</p>
</li>
<li>
<p>IPv6: The CN contains a single IPv6 address that is represented as eight colon separated groups of four lowercase hexadecimal digits, each group representing 16 bits as specified in RFC 4291. Note: Shortened addresses, suppressed zeros, and embedded IPv4 addresses are not tested..</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The evaluator shall configure the reference identifier according to the AGD guidance and perform the following tests during a DTLS connection:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1 [conditional]: The evaluator shall present a server certificate that contains a CN that does not match the reference identifier and does not contain the SAN extension. The evaluator shall verify that the connection fails. The evaluator shall repeat this test for each identifier type (e.g. IPv4, IPv6, FQDN) supported in the CN. When testing IPv4 or IPv6 addresses, the evaluator shall modify a single decimal or hexadecimal digit in the CN.
Remark: Some systems might require the presence of the SAN extension. In this case the connection would still fail but for the reason of the missing SAN extension instead of the mismatch of CN and reference identifier. Both reasons are acceptable to pass Test 1.</p>
</li>
<li>
<p>Test 2 [conditional]: The evaluator shall present a server certificate that contains a CN that matches the reference identifier, contains the SAN extension, but does not contain an identifier in the SAN that matches the reference identifier. The evaluator shall verify that the connection fails. The evaluator shall repeat this test for each supported SAN type (e.g. IPv4, IPv6, FQDN, URI). When testing IPv4 or IPv6 addresses, the evaluator shall modify a single decimal or hexadecimal digit in the SAN.</p>
</li>
<li>
<p>Test 3 [conditional]: If the TOE does not mandate the presence of the SAN extension, the evaluator shall present a server certificate that contains a CN that matches the reference identifier and does not contain the SAN extension. The evaluator shall verify that the connection succeeds. The evaluator shall repeat this test for each identifier type (e.g. IPv4, IPv6, FQDN) supported in the CN. If the TOE does mandate the presence of the SAN extension, this test shall be omitted.</p>
</li>
<li>
<p>Test 4 [conditional]: The evaluator shall present a server certificate that contains a CN that does not match the reference identifier but does contain an identifier in the SAN that matches. The evaluator shall verify that the connection succeeds. The evaluator shall repeat this test for each supported SAN type (e.g. IPv4, IPv6, FQDN, SRV).</p>
</li>
<li>
<p>Test 5 [conditional]: The evaluator shall perform the following wildcard tests with each supported type of reference identifier that includes a DNS name (i.e. CN-ID with DNS, DNS-ID, SRV-ID, URI-ID):</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>[conditional]: The evaluator shall present a server certificate containing a wildcard that is not in the left-most label of the presented identifier (e.g. foo.*.example.com) and verify that the connection fails.</p>
</li>
<li>
<p>[conditional]: The evaluator shall present a server certificate containing a wildcard in the left-most label (e.g. *.example.com). The evaluator shall configure the reference identifier with a single left-most label (e.g. foo.example.com) and verify that the connection succeeds, if wildcards are supported, or fails if wildcards are not supported. The evaluator shall configure the reference identifier without a left-most label as in the certificate (e.g. example.com) and verify that the connection fails. The evaluator shall configure the reference identifier with two left-most labels (e.g. bar.foo.example.com) and verify that the connection fails. (Remark: Support for wildcards was always intended to be optional. It is sufficient to state that the TOE does not support wildcards and observe rejected connection attempts to satisfy corresponding assurance activities).</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 6:[conditional] If IP address identifiers supported in the SAN or CN, the evaluator shall present a server certificate that contains a CN that matches the reference identifier, except one of the groups has been replaced with a wildcard asterisk (*) (e.g. CN=*.168.0.1 when connecting to 192.168.0.1&#8230;&#8203; Objective: The objective of this test is to ensure the TOE is able to differentiate between IP address identifiers that are not allowed to contain wildcards and other types of identifiers that may contain wildcards.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Remark: Some systems might require the presence of the SAN extension. In this case the connection would still fail but for the reason of the missing SAN extension instead of the mismatch of CN and reference identifier. Both reasons are acceptable to pass Test 6.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_1_3">5.2.4.3.3. FCS_DTLSC_EXT.1.3</h6>
<div class="paragraph">
<p>The evaluator shall demonstrate that using an invalid certificate results in the function failing as follows:</p>
</div>
<div class="paragraph">
<p>Test 1: Using the administrative guidance, the evaluator shall load a CA certificate or certificates needed to validate the presented certificate used to authenticate an external entity and demonstrate that the function succeeds and a trusted channel can be established.</p>
</div>
<div class="paragraph">
<p>Test 2: The evaluator shall then change the presented certificate(s) so that validation fails and show that the certificate is not automatically accepted. The evaluator shall repeat this test to cover the selected types of failure defined in the SFR (i.e. the selected ones from failed matching of the reference identifier, failed validation of the certificate path, failed validation of the expiration date, failed determination of the revocation status). The evaluator performs the action indicated in the SFR selection observing the TSF resulting in the expected state for the trusted channel (e.g. trusted channel was established) covering the types of failure for which an override mechanism is defined.</p>
</div>
<div class="paragraph">
<p>Test 3 [conditional]: The purpose of this test to verify that only selected certificate validation failures could be administratively overridden. If any override mechanism is defined for failed certificate validation, the evaluator shall configure a new presented certificate that does not contain a valid entry in one of the mandatory fields or parameters (e.g. inappropriate value in extendedKeyUsage field) but is otherwise valid and signed by a trusted CA. The evaluator shall confirm that the certificate validation fails (i.e. certificate is rejected), and there is no administrative override available to accept such certificate.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlsc_ext_1_4_3">5.2.4.3.4. FCS_DTLSC_EXT.1.4</h6>
<div class="paragraph">
<p>Test 1 [conditional]: If the TOE presents the Supported Elliptic Curves/Supported Groups Extension, the evaluator shall configure the server to perform ECDHE or DHE (as applicable) key exchange using each of the TOEs supported curves and/or groups. The evaluator shall verify that the TOE successfully connects to the server.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_dtlss_ext_1_dtls_server_protocol_without_mutual_authentication">5.2.5. FCS_DTLSS_EXT.1 DTLS Server Protocol without mutual authentication</h4>
<div class="sect4">
<h5 id="_tss_53">5.2.5.1. TSS</h5>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_1">5.2.5.1.1. FCS_DTLSS_EXT.1.1</h6>
<div class="paragraph">
<p>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that the ciphersuites supported are specified. The evaluator shall check the TSS to ensure that the ciphersuites specified are identical to those listed for this component.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_3">5.2.5.1.2. FCS_DTLSS_EXT.1.3</h6>
<div class="paragraph">
<p>The evaluator shall verify that the TSS describes how the DTLS Client IP address is validated prior to issuing a ServerHello message.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_4">5.2.5.1.3. FCS_DTLSS_EXT.1.4</h6>
<div class="paragraph">
<p>If using ECDHE or DHE ciphers, the evaluator shall verify that the TSS describes the key agreement parameters of the server Key Exchange message.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_5">5.2.5.1.4. FCS_DTLSS_EXT.1.5</h6>
<div class="paragraph">
<p>The evaluator shall verify that the TSS describes the actions that take place if a message received from the DTLS Client fails the MAC integrity check.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_6">5.2.5.1.5. FCS_DTLSS_EXT.1.6</h6>
<div class="paragraph">
<p>The evaluator shall verify that TSS describes how replay is detected and silently discarded for DTLS records that have previously been received and too old to fit in the sliding window.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_7">5.2.5.1.6. FCS_DTLSS_EXT.1.7</h6>
<div class="paragraph">
<p>The evaluator shall verify that the TSS describes if session resumption based on session IDs is supported (RFC 4346 and/or RFC 5246) and/or if session resumption based on session tickets is supported (RFC 5077).</p>
</div>
<div class="paragraph">
<p>If session tickets are supported, the evaluator shall verify that the TSS describes that the session tickets are encrypted using symmetric algorithms consistent with FCS_COP.1/DataEncryption. The evaluator shall verify that the TSS identifies the key lengths and algorithms used to protect session tickets.</p>
</div>
<div class="paragraph">
<p>If session tickets are supported, the evaluator shall verify that the TSS describes that session tickets adhere to the structural format provided in section 4 of RFC 5077 and if not, a justification shall be given of the actual session ticket format.</p>
</div>
<div class="paragraph">
<p>If the TOE claims a (D)TLS server capable of session resumption (as a single context, or across multiple contexts), the evaluator verifies that the TSS describes how session resumption operates (i.e. what would trigger a full handshake, e.g. checking session status, checking Session ID, etc.). If multiple contexts are used the TSS describes how session resumption is coordinated across those contexts. In case session establishment and session resumption are always using a separate context, the TSS shall describe how the contexts interact with respect to session resumption (in particular regarding the session ID). It is acceptable for sessions established in one context to be resumable in another context.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_44">5.2.5.2. Guidance Documentation</h5>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_1_2">5.2.5.2.1. FCS_DTLSS_EXT.1.1</h6>
<div class="paragraph">
<p>The evaluator shall also check the guidance documentation to ensure that it contains instructions on configuring the TOE so that DTLS conforms to the description in the TSS (for instance, the set of ciphersuites advertised by the TOE may have to be restricted to meet the requirements).</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_4_2">5.2.5.2.2. FCS_DTLSS_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_51">5.2.5.3. Tests</h5>
<div class="paragraph">
<p>For clarification: For DTLS communication packets might be received in a different order than sent due to the use of the UDP protocol.  All tests requiring a specific order of test steps ("before", "after") are therefore referring to the sequence numbering of DTLS packets.</p>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_1_3">5.2.5.3.1. FCS_DTLSS_EXT.1.1</h6>
<div class="paragraph">
<p>Test 1: The evaluator shall establish a DTLS connection using each of the ciphersuites specified by the requirement. This connection may be established as part of the establishment of a higher-level application protocol, e.g., as part of a syslog session. It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</p>
</div>
<div class="paragraph">
<p>Test 2: The evaluator shall send a Client Hello to the server with a list of ciphersuites that does not contain any of the ciphersuites in the servers ST and verify that the server denies the connection. Additionally, the evaluator shall send a Client Hello to the server containing only the TLS_NULL_WITH_NULL_NULL ciphersuite and verify that the server denies the connection.</p>
</div>
<div class="paragraph">
<p>Test 3: The evaluator shall perform the following modifications to the traffic:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Modify a byte in the Client Finished handshake message and verify that the server rejects the connection and does not send any application data.</p>
</li>
<li>
<p>(Test Intent: The intent of this test is to ensure that the server&#8217;s TLS implementation immediately makes use of the key exchange and authentication algorithms to: a) Correctly encrypt (D)TLS Finished message and b) Encrypt every (D)TLS message after session keys are negotiated.)</p>
<div class="paragraph">
<p>The evaluator shall use one of the claimed ciphersuites to complete a successful handshake and observe transmission of properly encrypted application data. The evaluator shall verify that no Alert with alert level Fatal (2) messages were sent.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify that the Finished message (Content type hexadecimal 16 and handshake message type hexadecimal 14) is sent immediately after the server&#8217;s ChangeCipherSpec (Content type hexadecimal 14) message. The evaluator shall examine the Finished message (encrypted example in hexadecimal of a TLS record containing a Finished message, 16 03 03 00 40 11 22 33 44 55&#8230;&#8203;) and confirm that it does not contain unencrypted data (unencrypted example in hexadecimal of a TLS record containing a Finished message, 16 03 03 00 40 14 00 00 0c&#8230;&#8203;), by verifying that the first byte of the encrypted Finished message does not equal hexadecimal 14 for at least one of three test messages. There is a chance that an encrypted Finished message contains a hexadecimal value of '14' at the position where a plaintext Finished message would contain the message type code '14'. If the observed Finished message contains a hexadecimal value of '14' at the position where the plaintext Finished message would contain the message type code, the test shall be repeated three times in total. In case the value of '14' can be observed in all three tests it can be assumed that the Finished message has indeed been sent in plaintext and the test has to be regarded as 'failed'. Otherwise it has to be assumed that the observation of the value '14' has been due to chance and that the Finished message has indeed been sent encrypted. In that latter case the test shall be regarded as 'passed'.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_3_2">5.2.5.3.2. FCS_DTLSS_EXT.1.3</h6>
<div class="paragraph">
<p>Modify at least one byte in the cookie from the Server&#8217;s HelloVerifyRequest message and verify that the Server rejects the Client&#8217;s handshake message.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_4_3">5.2.5.3.3. FCS_DTLSS_EXT.1.4</h6>
<div class="paragraph">
<p>Test 1 [conditional]: If ECDHE ciphersuites are supported:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The evaluator shall repeat this test for each supported elliptic curve. The evaluator shall attempt a connection using a supported ECDHE ciphersuite and a single supported elliptic curve specified in the Elliptic Curves Extension. The evaluator shall verify (through a packet capture or instrumented client) that the TOE selects the same curve in the Server Key Exchange message and successfully establishes the connection.</p>
</li>
<li>
<p>The evaluator shall attempt a connection using a supported ECDHE ciphersuite and a single unsupported elliptic curve (e.g. secp192r1 (0x13)) specified in RFC4492, chap. 5.1.1. The evaluator shall verify that the TOE does not send a Server Hello message and the connection is not successfully established.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Test 2 [conditional]: If DHE ciphersuites are supported, the evaluator shall repeat the following test for each supported parameter size. If any configuration is necessary, the evaluator shall configure the TOE to use a supported Diffie-Hellman parameter size. The evaluator shall attempt a connection using a supported DHE ciphersuite. The evaluator shall verify (through a packet capture or instrumented client) that the TOE sends a Server Key Exchange Message where p Length is consistent with the configured Diffie-Hellman parameter size(s).</p>
</div>
<div class="paragraph">
<p>Test 3 [conditional]: If RSA key establishment ciphersuites are supported, the evaluator shall repeat this test for each RSA key establishment key size. If any configuration is necessary, the evaluator shall configure the TOE to perform RSA key establishment using a supported key size (e.g. by loading a certificate with the appropriate key size). The evaluator shall attempt a connection using a supported RSA key establishment ciphersuite. The evaluator shall verify (through a packet capture or instrumented client) that the TOE sends a certificate whose modulus is consistent with the configured RSA key size.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_5_2">5.2.5.3.4. FCS_DTLSS_EXT.1.5</h6>
<div class="paragraph">
<p>The evaluator shall establish a connection using a client.  The evaluator will then modify at least one byte in a record message and verify that the Server discards the record or terminates the DTLS session.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_6_2">5.2.5.3.5. FCS_DTLSS_EXT.1.6</h6>
<div class="paragraph">
<p>The evaluator shall set up a DTLS connection. The evaluator shall then capture traffic sent from the DTLS Client to the TOE. The evaluator shall retransmit copies of this traffic to the TOE in order to impersonate the DTLS Client. The evaluator shall observe that the TSF does not take action in response to receiving these packets and that the audit log indicates that the replayed traffic was discarded.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_dtlss_ext_1_7_2">5.2.5.3.6. FCS_DTLSS_EXT.1.7</h6>
<div class="paragraph">
<p><em>Test Objective: To demonstrate that the TOE will not resume a session for which the client failed to complete the handshake (independent of TOE support for session resumption)</em></p>
</div>
<div class="paragraph">
<p>Test 1 [conditional]: If the TOE does not support session resumption based on session IDs according to RFC4346 (TLS1.1) or RFC5246 (TLS1.2) or session tickets according to RFC5077, the evaluator shall perform the following test:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The client sends a Client Hello with a zero-length session identifier and with a SessionTicket extension containing a zero-length ticket.</p>
</li>
<li>
<p>The client verifies the server does not send a NewSessionTicket handshake message (at any point in the handshake).</p>
</li>
<li>
<p>The client verifies the Server Hello message contains a zero-length session identifier or passes the following steps:</p>
<div class="paragraph">
<p>Note: The following steps are only performed if the ServerHello message contains a non-zero length SessionID.</p>
</div>
</li>
<li>
<p>The client completes the TLS handshake and captures the SessionID from the ServerHello.</p>
</li>
<li>
<p>The client sends a ClientHello containing the SessionID captured in step d). This can be done by keeping the TLS session from step d) open or by starting a new TLS session using the SessionID captured in step d).</p>
</li>
<li>
<p>The client verifies the TOE (1) implicitly rejects the SessionID by sending a ServerHello containing a different SessionID and by performing a full handshake (as shown in Figure 1 of RFC 4346 or RFC 5246), or (2) terminates the connection in some way that prevents the flow of application data.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Remark: If multiple contexts are supported for session resumption, the session ID or session ticket may be obtained in one context for resumption in another context.  It is possible that one or more contexts may only permit the construction of sessions to be reused in other contexts but not actually permit resumption themselves.  For contexts which do not permit resumption, the evaluator is required to verify this behaviour subject to the description provided in the TSS. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session.</p>
</div>
<div class="paragraph">
<p>Test 2 [conditional]: If the TOE supports session resumption using session IDs according to RFC4346 (TLS1.1) or RFC5246 (TLS1.2), the evaluator shall carry out the following steps (note that for each of these tests, it is not necessary to perform the test case for each supported version of TLS):</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The evaluator shall conduct a successful handshake and capture the TOE-generated session ID in the Server Hello message.  The evaluator shall then initiate a new TLS connection and send the previously captured session ID to show that the TOE resumed the previous session by responding with ServerHello containing the same SessionID immediately followed by ChangeCipherSpec and Finished messages (as shown in figure 2 of RFC 4346 or RFC 5246).</p>
</li>
<li>
<p>The evaluator shall initiate a handshake and capture the TOE-generated session ID in the Server Hello message.  The evaluator shall then, within the same handshake, generate or force an unencrypted fatal Alert message immediately before the client would otherwise send its ChangeCipherSpec message thereby disrupting the handshake.  The evaluator shall then initiate a new Client Hello using the previously captured session ID, and verify that the server (1) implicitly rejects the session ID by sending a ServerHello containing a different SessionID and performing a full handshake (as shown in figure 1 of RFC 4346 or RFC 5246), or (2) terminates the connection in some way that prevents the flow of application data.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Remark: If multiple contexts are supported for session resumption, for each of the above test cases, the session ID may be obtained in one context for resumption in another context.  There is no requirement that the session ID be obtained and replayed within the same context subject to the description provided in the TSS.  All contexts that can reuse a session ID constructed in another context must be tested. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session.</p>
</div>
<div class="paragraph">
<p>Test 3 [conditional]: If the TOE supports session tickets according to RFC5077, the evaluator shall carry out the following steps (note that for each of these tests, it is not necessary to perform the test case for each supported version of TLS):</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The evaluator shall permit a successful TLS handshake to occur in which a session ticket is exchanged with the non-TOE client.  The evaluator shall then attempt to correctly reuse the previous session by sending the session ticket in the ClientHello.  The evaluator shall confirm that the TOE responds with a ServerHello with an empty SessionTicket extension, NewSessionTicket, ChangeCipherSpec and Finished messages (as seen in figure 2 of RFC 5077).</p>
</li>
<li>
<p>The evaluator shall permit a successful TLS handshake to occur in which a session ticket is exchanged with the non-TOE client.  The evaluator will then modify the session ticket and send it as part of a new Client Hello message.  The evaluator shall confirm that the TOE either (1) implicitly rejects the session ticket by performing a full handshake (as shown in figure 3 or 4 of RFC 5077), or (2) terminates the connection in some way that prevents the flow of application data.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Remark: If multiple contexts are supported for session resumption, for each of the above test cases, the session ticket may be obtained in one context for resumption in another context.  There is no requirement that the session ticket be obtained and replayed within the same context subject to the description provided in the TSS. All contexts that can reuse a session ticket constructed in another context must be tested. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_sshc_ext_1_ssh_client">5.2.6. FCS_SSHC_EXT.1 SSH Client</h4>
<div class="sect4">
<h5 id="_tss_54">5.2.6.1. TSS</h5>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_2">5.2.6.1.1. FCS_SSHC_EXT.1.2</h6>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a list of the public key algorithms that are acceptable for use for user authentication and that this list is consistent with asymmetric key generation algorithms selected in FCS_CKM.1, hashing algorithms selected in FCS_COP.1/Hash, and signature generation algorithms selected in FCS_COP.1/SigGen. The evaluator shall confirm the TSS is unambiguous in declaring the TOEs ability to authenticate itself to a remote endpoint with a user-based public key.</p>
</div>
<div class="paragraph">
<p>If password-based authentication method has been selected in the FCS_SSHC_EXT.1.2, then the evaluator shall confirm it is also described in the TSS.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_3">5.2.6.1.2. FCS_SSHC_EXT.1.3</h6>
<div class="paragraph">
<p>The evaluator shall check that the TSS describes how large packets in terms of RFC 4253 are detected and handled.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_4">5.2.6.1.3. FCS_SSHC_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that optional characteristics are specified, and the encryption algorithms supported are specified as well. The evaluator shall check the TSS to ensure that the encryption algorithms specified are identical to those listed for this component.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_5">5.2.6.1.4. FCS_SSHC_EXT.1.5</h6>
<div class="paragraph">
<p>The evaluator shall confirm the TSS describes how a host-key public key (i.e., SSH servers public key) is associated with the server identity.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that optional characteristics are specified, and the host-key public key algorithms supported by the TOE are specified as well. The evaluator shall check the TSS to ensure that the host-key public key algorithms specified are identical to those listed for this component.</p>
</div>
<div class="paragraph">
<p>If x509v3-based public key authentication algorithms are claimed, the evaluator shall confirm that the TSS includes the description of how the TOE establishes the servers identity and how this identity is confirmed with the one that is presented in the provided certificate. For example, the TOE could verify that a servers configured IP address matches the one presented in the servers x.509v3 certificate.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_6">5.2.6.1.5. FCS_SSHC_EXT.1.6</h6>
<div class="paragraph">
<p>The evaluator shall check the TSS to ensure that it lists the supported data integrity algorithms, and that the list corresponds to the list in this component.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_7">5.2.6.1.6. FCS_SSHC_EXT.1.7</h6>
<div class="paragraph">
<p>The evaluator shall check the TSS to ensure that it lists the supported key exchange algorithms, and that the list corresponds to the list in this component.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_8">5.2.6.1.7. FCS_SSHC_EXT.1.8</h6>
<div class="paragraph">
<p>The evaluator shall check that the TSS specifies the following:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Both thresholds are checked by the TOE.</p>
</li>
<li>
<p>Rekeying is performed upon reaching the threshold that is hit first.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In cases where TOE limitations prevent reaching the time threshold, the evaluator shall check the TSS to ensure it contains:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>An argument describing this TOE limitation and</p>
</li>
<li>
<p>Identification of the hardware components (if any) that form the basis of the such argument.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example, if a specific Ethernet Controller or Wi-Fi radio chip is the root cause of such limitation, these subsystems shall be identified.</p>
</div>
<div class="paragraph">
<p>In cases where TOE limitations prevent reaching the data transfer threshold, the evaluator shall check the TSS to ensure it contains:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>An argument describing this TOE limitation and</p>
</li>
<li>
<p>Identification of the hardware components (if any) that form the basis of the such argument.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example, if a specific Ethernet Controller or Wi-Fi radio chip is the root cause of such limitation, these subsystems shall be identified.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_45">5.2.6.2. Guidance Documentation</h5>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_2_2">5.2.6.2.1. FCS_SSHC_EXT.1.2</h6>
<div class="paragraph">
<p>The evaluator shall check the guidance documentation to ensure that it contains instructions to the administrator on how to ensure that only the allowed mechanisms are used in SSH connections initiated by the TOE.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_4_2">5.2.6.2.2. FCS_SSHC_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator shall also check the guidance documentation to ensure that it contains instructions on configuring the TOE so that SSH conforms to the description in the TSS (for instance, the set of algorithms advertised by the TOE may have to be restricted to meet the requirements).</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_5_2">5.2.6.2.3. FCS_SSHC_EXT.1.5</h6>
<div class="paragraph">
<p>The evaluator shall also check the guidance documentation to ensure that it contains instructions on configuring the TOE so that SSH conforms to the description in the TSS (for instance, the set of algorithms advertised by the TOE may have to be restricted to meet the requirements).</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_6_2">5.2.6.2.4. FCS_SSHC_EXT.1.6</h6>
<div class="paragraph">
<p>The evaluator shall also check the guidance documentation to ensure that it contains instructions to the Security Administrator on how to ensure that only the allowed data integrity algorithms are used in SSH connections with the TOE (specifically, that the none MAC algorithm is not allowed).</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_7_2">5.2.6.2.5. FCS_SSHC_EXT.1.7</h6>
<div class="paragraph">
<p>The evaluator shall also check the guidance documentation to ensure that it contains instructions to the Security Administrator on how to ensure that only the allowed key exchange algorithms are used in SSH connections with the TOE.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_8_2">5.2.6.2.6. FCS_SSHC_EXT.1.8</h6>
<div class="paragraph">
<p>If one or more thresholds that are checked by the TOE to fulfil the SFR are configurable, then the evaluator shall check that the guidance documentation describes how to configure those thresholds. Either the allowed values are specified in the guidance documentation and must not exceed the limits specified in the SFR (one hour of session time, one gigabyte of transmitted traffic) or the TOE must not accept values beyond the limits specified in the SFR. The evaluator shall check that the guidance documentation describes that the TOE reacts to the first threshold reached.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_52">5.2.6.3. Tests</h5>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_2_3">5.2.6.3.1. FCS_SSHC_EXT.1.2</h6>
<div class="paragraph">
<p>Test objective: The purpose of these tests is to check the authentication of the client to the server using each claimed authentication method.</p>
</div>
<div class="paragraph">
<p>Test 1: For each claimed public-key authentication method, the evaluator shall configure the TOE to present a public key corresponding to that authentication method (e.g., 2048-bit RSA key when using ssh-rsa public key). The evaluator shall establish sufficient separate SSH connections with an appropriately configured remote non-TOE SSH server to demonstrate the use of all claimed public key algorithms. It is sufficient to observe the successful completion of the SSH Authentication Protocol to satisfy the intent of this test.</p>
</div>
<div class="paragraph">
<p>Test 2: [Conditional] If password-based authentication method has been selected in the FCS_SSHC_EXT.1.2, then following the guidance documentation the evaluator shall configure the TOE to perform password-based authentication with a remote SSH server to demonstrate that the TOE can successfully authenticate using a password as an authentication method.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_3_2">5.2.6.3.2. FCS_SSHC_EXT.1.3</h6>
<div class="paragraph">
<p>The evaluator shall demonstrate that if the TOE receives a packet larger than that specified in this component, that packet is dropped.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_4_3">5.2.6.3.3. FCS_SSHC_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator must ensure that only claimed ciphers and cryptographic primitives are used to establish an SSH connection. To verify this, the evaluator shall start session establishment for an SSH connection with a remote server (referred to as remote endpoint below). The evaluator shall capture the traffic exchanged between the TOE and the remote endpoint during protocol negotiation (e.g. using a packet capture tool or information provided by the endpoint, respectively). The evaluator shall verify from the captured traffic that the TOE offers all the ciphers defined in the TSS for the TOE for SSH sessions, but no additional ones compared to the definition in the TSS. The evaluator shall perform one successful negotiation of an SSH session to verify that the TOE behaves as expected. It is sufficient to observe the successful negotiation of the session to satisfy the intent of the test. If the evaluator detects that not all ciphers defined in the TSS for SSH are supported by the TOE and/or the TOE supports one or more additional ciphers not defined in the TSS for SSH, the test shall be regarded as failed.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_5_3">5.2.6.3.4. FCS_SSHC_EXT.1.5</h6>
<div class="paragraph">
<p>Test 1: The evaluator shall establish an SSH connection using each of the public key algorithms specified by the requirement to authenticate an SSH server to the TOE. It is sufficient to observe (on the wire) the successful negotiation of the algorithm to satisfy the intent of the test. Test objective: The purpose of this positive test is to check the authentication of the server by the client (when establishing the transport layer connection), and not for checking generation of the authentication message from the client (in the User Authentication Protocol). The evaluator shall therefore establish sufficient separate SSH connections (with an appropriately configured server) to cause the TOE to demonstrate use of all public key algorithms claimed in FCS_SSHC_EXT.1.5 in the ST.</p>
</div>
<div class="paragraph">
<p>Test 2: The evaluator shall configure an SSH server to only allow a public key algorithm that is not included in the ST selection. The evaluator shall attempt to establish an SSH connection from the TOE to the SSH server and observe that the connection is rejected.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_6_3">5.2.6.3.5. FCS_SSHC_EXT.1.6</h6>
<div class="paragraph">
<p>Test 1: [conditional, if an HMAC or AEAD_AES_*_GCM algorithm is selected in the ST] The evaluator shall establish an SSH connection using each of the algorithms, except implicit, specified by the requirement. It is sufficient to observe (on the wire) the successful negotiation of the algorithm to satisfy the intent of the test.</p>
</div>
<div class="paragraph">
<p>Note: To ensure the observed algorithm is used, the evaluator shall ensure a non-aes*-gcm@openssh.com encryption algorithm is negotiated while performing this test.</p>
</div>
<div class="paragraph">
<p>Test 2: [conditional, if an HMAC or AEAD_AES_*_GCM algorithm is selected in the ST] The evaluator shall configure an SSH server to only allow a MAC algorithm that is not included in the ST selection. The evaluator shall attempt to connect from the TOE to the SSH server and observe that the attempt fails.</p>
</div>
<div class="paragraph">
<p>Note: To ensure the proposed MAC algorithm is used, the evaluator shall ensure a non-aes*-gcm@openssh.com encryption algorithm is negotiated while performing this test.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_7_3">5.2.6.3.6. FCS_SSHC_EXT.1.7</h6>
<div class="paragraph">
<p>Test 1: The evaluator shall configure an SSH server to permit all allowed key exchange methods. The evaluator shall attempt to connect from the TOE to the SSH server using each allowed key exchange method and observe that each attempt succeeds.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_8_3">5.2.6.3.7. FCS_SSHC_EXT.1.8</h6>
<div class="paragraph">
<p>The evaluator needs to perform testing that rekeying is performed according to the description in the TSS. The evaluator shall test both, the time-based threshold and the traffic-based threshold.</p>
</div>
<div class="paragraph">
<p>For testing of the time-based threshold, the evaluator shall use the TOE to connect to an SSH server and keep the session open until the threshold is reached. The evaluator shall verify that the SSH session has been active longer than the threshold value and shall verify that the TOE initiated a rekey (the method of verification shall be reported by the evaluator).</p>
</div>
<div class="paragraph">
<p>Testing does not necessarily have to be performed with the threshold configured at the maximum allowed value of one hour of session time, but the value used for testing shall not exceed one hour. The evaluator needs to ensure that the rekeying has been initiated by the TOE and not by the SSH server the TOE is connected to.</p>
</div>
<div class="paragraph">
<p>For testing of the traffic-based threshold the evaluator shall use the TOE to connect to an SSH server and shall transmit data to and/or receive data from the TOE within the active SSH session until the threshold for data protected by either encryption key is reached. It is acceptable if the rekey occurs before the threshold is reached (e.g. because the traffic is counted according to one of the alternatives given in the Application Note for FCS_SSHC_EXT.1.8).</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify that more data has been transmitted within the SSH session than the threshold allows and shall verify that the TOE initiated a rekey (the method of verification shall be reported by the evaluator).</p>
</div>
<div class="paragraph">
<p>Testing does not necessarily have to be performed with the threshold configured at the maximum allowed value of one gigabyte of transferred traffic, but the value used for testing shall not exceed one gigabyte. The evaluator needs to ensure that the rekeying has been initiated by the TOE and not by the SSH server the TOE is connected to.</p>
</div>
<div class="paragraph">
<p>If one or more thresholds that are checked by the TOE to fulfil the SFR are configurable, the evaluator needs to verify that the threshold(s) can be configured as described in the guidance documentation and the evaluator needs to test that modification of the thresholds is restricted to Security Administrators (as required by FMT_MOF.1).</p>
</div>
<div class="paragraph">
<p>In cases where time threshold could not be reached due to TOE limitations, it is acceptable to omit testing of this (SSH rekeying based on data transfer threshold) threshold.</p>
</div>
<div class="paragraph">
<p>In cases where data transfer threshold could not be reached due to TOE limitations, it is acceptable to omit testing of this (SSH rekeying based on data transfer threshold) threshold.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshc_ext_1_9">5.2.6.3.8. FCS_SSHC_EXT.1.9</h6>
<div class="paragraph">
<p>Test 1: The evaluator shall delete all entries in the TOEs list of recognized SSH server host keys and, if selected, all entries in the TOEs list of trusted certification authorities. The evaluator shall initiate a connection from the TOE to an SSH server. The evaluator shall ensure that the TOE either rejects the connection or displays the SSH servers public key (either the key bytes themselves or a hash of the key using any allowed hash algorithm) and prompts the Security Administrator to accept or deny the key before continuing the connection.</p>
</div>
<div class="paragraph">
<p>Test 2: The evaluator shall add an entry associating a host name with a public key into the TOEs local database. The evaluator shall replace, on the corresponding SSH server, the servers host key with a different host key. If 'password-based' is selected for the TOE in FCS_SSHC_EXT.1.2, the evaluator shall initiate a connection from the TOE to the SSH server using password-based authentication, shall ensure that the TOE rejects the connection, and shall ensure that the password was not transmitted to the SSH server (for example, by instrumenting the SSH server with a debugging capability to output received passwords). If 'password-based' is not selected for the TOE in FCS_SSHC_EXT.1.2, the evaluator shall initiate a connection from the TOE to the SSH server using public key-based authentication and shall ensure that the TOE rejects the connection.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_sshs_ext_1_ssh_server">5.2.7. FCS_SSHS_EXT.1 SSH Server</h4>
<div class="sect4">
<h5 id="_tss_55">5.2.7.1. TSS</h5>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_2">5.2.7.1.1. FCS_SSHS_EXT.1.2</h6>
<div class="paragraph">
<p>The evaluator shall check to ensure that the TSS contains a description of the public key algorithms that are acceptable for use for authentication and that this list conforms to FCS_SSHS_EXT.1.5. and ensure that if password-based authentication methods have been selected in the ST then these are also described.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_3">5.2.7.1.2. FCS_SSHS_EXT.1.3</h6>
<div class="paragraph">
<p>The evaluator shall check that the TSS describes how large packets in terms of RFC 4253 are detected and handled.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_4">5.2.7.1.3. FCS_SSHS_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that optional characteristics are specified, and the encryption algorithms supported are specified as well. The evaluator shall check the TSS to ensure that the encryption algorithms specified are identical to those listed for this component.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_5">5.2.7.1.4. FCS_SSHS_EXT.1.5</h6>
<div class="paragraph">
<p>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that optional characteristics are specified, and the public key algorithms supported are specified as well. The evaluator shall check the TSS to ensure that the public key algorithms specified are identical to those listed for this component.</p>
</div>
<div class="paragraph">
<p>The evaluator shall confirm that the TSS includes the description of how the TOE establishes a user identity when an SSH client presents a public key or X.509v3 certificate. For example, the TOE could verify that the SSH clients presented public key matches one that is stored within the SSH servers authorized_keys file.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_6">5.2.7.1.5. FCS_SSHS_EXT.1.6</h6>
<div class="paragraph">
<p>The evaluator shall check the TSS to ensure that it lists the supported data integrity algorithms, and that the list corresponds to the list in this component.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_7">5.2.7.1.6. FCS_SSHS_EXT.1.7</h6>
<div class="paragraph">
<p>The evaluator shall check the TSS to ensure that it lists the supported key exchange algorithms, and that the list corresponds to the list in this component.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_8">5.2.7.1.7. FCS_SSHS_EXT.1.8</h6>
<div class="paragraph">
<p>The evaluator shall check that the TSS specifies the following:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Both thresholds are checked by the TOE.</p>
</li>
<li>
<p>Rekeying is performed upon reaching the threshold that is hit first.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In cases where TOE limitations prevent reaching the time threshold, the evaluator shall check the TSS to ensure it contains:</p>
</div>
<div class="paragraph">
<p>An argument describing this TOE limitation and</p>
</div>
<div class="paragraph">
<p>Identification of the hardware components (if any) that form the basis of the such argument.</p>
</div>
<div class="paragraph">
<p>For example, if a specific Ethernet Controller or Wi-Fi radio chip is the root cause of such limitation, these subsystems shall be identified.</p>
</div>
<div class="paragraph">
<p>In cases where TOE limitations prevent reaching the data transfer threshold, the evaluator shall check the TSS to ensure it contains:</p>
</div>
<div class="paragraph">
<p>An argument describing this TOE limitation and</p>
</div>
<div class="paragraph">
<p>Identification of the hardware components (if any) that form the basis of the such argument.</p>
</div>
<div class="paragraph">
<p>For example, if a specific Ethernet Controller or Wi-Fi radio chip is the root cause of such limitation, these subsystems shall be identified.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_46">5.2.7.2. Guidance Documentation</h5>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_4_2">5.2.7.2.1. FCS_SSHS_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator shall check the guidance documentation to ensure that it contains instructions on configuring the TOE so that SSH conforms to the description in the TSS (for instance, the set of algorithms advertised by the TOE may have to be restricted to meet the requirements).</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_5_2">5.2.7.2.2. FCS_SSHS_EXT.1.5</h6>
<div class="paragraph">
<p>The evaluator shall check the guidance documentation to ensure that it contains instructions on configuring the TOE so that SSH conforms to the description in the TSS (for instance, the set of algorithms advertised by the TOE may have to be restricted to meet the requirements).</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_6_2">5.2.7.2.3. FCS_SSHS_EXT.1.6</h6>
<div class="paragraph">
<p>The evaluator shall check the guidance documentation to ensure that it contains instructions to the Security Administrator on how to ensure that only the allowed data integrity algorithms are used in SSH connections with the TOE (specifically, that the none MAC algorithm is not allowed).</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_7_2">5.2.7.2.4. FCS_SSHS_EXT.1.7</h6>
<div class="paragraph">
<p>The evaluator shall check the guidance documentation to ensure that it contains instructions to the Security Administrator on how to ensure that only the allowed key exchange algorithms are used in SSH connections with the TOE.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_8_2">5.2.7.2.5. FCS_SSHS_EXT.1.8</h6>
<div class="paragraph">
<p>If one or more thresholds that are checked by the TOE to fulfil the SFR are configurable, then the evaluator shall check that the guidance documentation describes how to configure those thresholds. Either the allowed values are specified in the guidance documentation and must not exceed the limits specified in the SFR (one hour of session time, one gigabyte of transmitted traffic) or the TOE must not accept values beyond the limits specified in the SFR. The evaluator shall check that the guidance documentation describes that the TOE reacts to the first threshold reached.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_53">5.2.7.3. Tests</h5>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_2_2">5.2.7.3.1. FCS_SSHS_EXT.1.2</h6>
<div class="paragraph">
<p>Test 1: If password-based authentication methods have been selected in the ST then using the guidance documentation, the evaluator shall configure the TOE to accept password-based authentication and demonstrate that user authentication succeeds when the correct password is provided by the user.</p>
</div>
<div class="paragraph">
<p>Test 2: If password-based authentication methods have been selected in the ST then the evaluator shall use an SSH client, enter an incorrect password to attempt to authenticate to the TOE, and demonstrate that the authentication fails.
Note: Public key authentication is tested as part of testing for FCS_SSHS_EXT.1.5.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_3_2">5.2.7.3.2. FCS_SSHS_EXT.1.3</h6>
<div class="paragraph">
<p>The evaluator shall demonstrate that if the TOE receives a packet larger than that specified in this component, that packet is dropped.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_4_3">5.2.7.3.3. FCS_SSHS_EXT.1.4</h6>
<div class="paragraph">
<p>The evaluator must ensure that only claimed ciphers and cryptographic primitives are used to establish an SSH connection. To verify this, the evaluator shall start session establishment for an SSH connection from a remote client (referred to as remote endpoint below). The evaluator shall capture the traffic exchanged between the TOE and the remote endpoint during protocol negotiation (e.g. using a packet capture tool or information provided by the endpoint, respectively). The evaluator shall verify from the captured traffic that the TOE offers all the ciphers defined in the TSS for the TOE for SSH sessions, but no additional ones compared to the definition in the TSS. The evaluator shall perform one successful negotiation of an SSH session to verify that the TOE behaves as expected. It is sufficient to observe the successful negotiation of the session to satisfy the intent of the test. If the evaluator detects that not all ciphers defined in the TSS for SSH are supported by the TOE and/or the TOE supports one or more additional ciphers not defined in the TSS for SSH, the test shall be regarded as failed.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_5_3">5.2.7.3.4. FCS_SSHS_EXT.1.5</h6>
<div class="paragraph">
<p>Test 1: The evaluator shall establish an SSH connection using each of the public key algorithms specified by the requirement to authenticate the TOE to an SSH client. It is sufficient to observe (on the wire) the successful negotiation of the algorithm to satisfy the intent of the test.</p>
</div>
<div class="paragraph">
<p>Test 2: The evaluator shall choose one public key algorithm supported by the TOE. The evaluator shall generate a new key pair for that algorithm without configuring the TOE to recognize the public key for authentication. The evaluator shall use an SSH client to attempt to connect to the TOE with the new key pair and demonstrate that authentication fails. Test objective: The purpose of this negative test is to verify that the server rejects authentication attempts of clients that present a public key that does not match public key(s) associated by the TOE with the identity of the client (i.e. the public keys are unknown to the server). To demonstrate correct functionality, it is sufficient to determine that an SSH connection was not established after using a valid username and an unknown key of supported type.</p>
</div>
<div class="paragraph">
<p>Test 3: The evaluator shall configure an SSH client to only allow a public key algorithm that is not included in the ST selection. The evaluator shall attempt to establish an SSH connection from the SSH client to the TOE and observe that the connection is rejected.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_6_3">5.2.7.3.5. FCS_SSHS_EXT.1.6</h6>
<div class="paragraph">
<p>Test 1: [conditional, if an HMAC or AEAD_AES_*_GCM algorithm is selected in the ST] The evaluator shall establish an SSH connection using each of the algorithms, except implicit, specified by the requirement. It is sufficient to observe (on the wire) the successful negotiation of the algorithm to satisfy the intent of the test.</p>
</div>
<div class="paragraph">
<p>Note: To ensure the observed algorithm is used, the evaluator shall ensure a non-aes*-gcm@openssh.com encryption algorithm is negotiated while performing this test.</p>
</div>
<div class="paragraph">
<p>Test 2: [conditional, if an HMAC or AEAD_AES_*_GCM algorithm is selected in the ST] The evaluator shall configure an SSH client to only allow a MAC algorithm that is not included in the ST selection. The evaluator shall attempt to connect from the SSH client to the TOE and observe that the attempt fails.</p>
</div>
<div class="paragraph">
<p>Note: To ensure the proposed MAC algorithm is used, the evaluator shall ensure a non-aes*-gcm@openssh.com encryption algorithm is negotiated while performing this test.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_7_3">5.2.7.3.6. FCS_SSHS_EXT.1.7</h6>
<div class="paragraph">
<p>Test 1: The evaluator shall configure an SSH client to only allow the diffie-hellman-group1-sha1 key exchange. The evaluator shall attempt to connect from the SSH client to the TOE and observe that the attempt fails.</p>
</div>
<div class="paragraph">
<p>Test 2: For each allowed key exchange method, the evaluator shall configure an SSH client to only allow that method for key exchange, attempt to connect from the client to the TOE, and observe that the attempt succeeds.</p>
</div>
</div>
<div class="sect5">
<h6 id="_fcs_sshs_ext_1_8_3">5.2.7.3.7. FCS_SSHS_EXT.1.8</h6>
<div class="paragraph">
<p>The evaluator needs to perform testing that rekeying is performed according to the description in the TSS. The evaluator shall test both, the time-based threshold and the traffic-based threshold.</p>
</div>
<div class="paragraph">
<p>For testing of the time-based threshold, the evaluator shall use an SSH client to connect to the TOE and keep the session open until the threshold is reached. The evaluator shall verify that the SSH session has been active longer than the threshold value and shall verify that the TOE initiated a rekey (the method of verification shall be reported by the evaluator).</p>
</div>
<div class="paragraph">
<p>Testing does not necessarily have to be performed with the threshold configured at the maximum allowed value of one hour of session time, but the value used for testing shall not exceed one hour. The evaluator needs to ensure that the rekeying has been initiated by the TOE and not by the SSH client that is connected to the TOE.</p>
</div>
<div class="paragraph">
<p>For testing of the traffic-based threshold the evaluator shall use the TOE to connect to an SSH client and shall transmit data to and/or receive data from the TOE within the active SSH session until the threshold for data protected by either encryption key is reached. It is acceptable if the rekey occurs before the threshold is reached (e.g. because the traffic is counted according to one of the alternatives given in the Application Note for FCS_SSHS_EXT.1.8).</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify that more data has been transmitted within the SSH session than the threshold allows and shall verify that the TOE initiated a rekey (the method of verification shall be reported by the evaluator).</p>
</div>
<div class="paragraph">
<p>Testing does not necessarily have to be performed with the threshold configured at the maximum allowed value of one gigabyte of transferred traffic, but the value used for testing shall not exceed one gigabyte. The evaluator needs to ensure that the rekeying has been initiated by the TOE and not by the SSH client that is connected to the TOE.</p>
</div>
<div class="paragraph">
<p>If one or more thresholds that are checked by the TOE to fulfil the SFR are configurable, the evaluator needs to verify that the threshold(s) can be configured as described in the guidance documentation and the evaluator needs to test that modification of the thresholds is restricted to Security Administrators (as required by FMT_MOF.1/Functions).</p>
</div>
<div class="paragraph">
<p>In cases where the time threshold could not be reached due to TOE limitations, it is acceptable to omit testing of this (SSH rekeying based on data transfer threshold) threshold.</p>
</div>
<div class="paragraph">
<p>In cases where the data transfer threshold could not be reached due to TOE limitations, it is acceptable to omit testing of this (SSH rekeying based on data transfer threshold) threshold.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_https_ext_1_https_selected">5.2.8. FCS_HTTPS_EXT.1 HTTPS selected</h4>
<div class="sect4">
<h5 id="_tss_56">5.2.8.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS and determine that enough detail is
provided to explain how the implementation complies with RFC 2818.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_47">5.2.8.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall examine the guidance documentation to verify it instructs
the Administrator how to configure TOE for use as an HTTPS client or HTTPS
server.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_54">5.2.8.3. Tests</h5>
<div class="paragraph">
<p>Tests are performed in conjunction with the TLS evaluation activities.</p>
</div>
<div class="paragraph">
<p>If the TOE is an HTTPS client or an HTTPS server utilizing X.509 client
authentication, then the certificate validity shall be tested in accordance with
testing performed for FIA_X509_EXT.1.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_cop_1keyedhash_cryptographic_operation_keyed_hash_algorithm">5.2.9. FCS_COP.1/KeyedHash Cryptographic Operation (Keyed Hash Algorithm)</h4>
<div class="sect4">
<h5 id="_tss_57">5.2.9.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to ensure that it specifies the following
values used by the HMAC function: key length, hash function used, block size,
and output MAC length used.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_48">5.2.9.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall verify that the AGD guidance instructs the administrator
how to configure the TOE to use the values used by the HMAC function: key
length, hash function used, block size, and output MAC length used defined
in the Security Target supported by the TOE for keyed hash function.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_55">5.2.9.3. Tests</h5>
<div class="paragraph">
<p>Note: Testing of cryptographic functions implemented in the Root of Trust for Secure Boot (FPT_SBT_EXT.1) may not be feasible and independent testing may not be available. In this situation, contact the CC Scheme.</p>
</div>
<div class="paragraph">
<p>For each of the supported parameter sets, the evaluator shall compose 15 sets
of test data. Each set shall consist of a key and message data. The evaluator
shall have the TSF generate HMAC tags for these sets of test data. The
resulting MAC tags shall be compared to the result of generating HMAC tags
with the same key and message data using a known good implementation.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fia_psk_ext_1_pre_shared_key_composition">5.2.10. FIA_PSK_EXT.1 Pre-Shared Key Composition</h4>
<div class="sect4">
<h5 id="_tss_58">5.2.10.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall examine the TSS to ensure that it states that text-based pre-shared keys of 22 characters are supported, and that the TSS states the conditioning that takes place to transform the text-based pre-shared key from the key sequence entered by the user (e.g., ASCII representation) to the bit string used by IPsec, and that this conditioning is consistent with the first selection in the FIA_PSK_EXT.1.3 requirement.  If the assignment is used to specify conditioning, the evaluator will confirm that the TSS describes this conditioning.</p>
</div>
<div class="paragraph">
<p>The evaluator shall also examine the TSS to ensure it describes the process by which the bit-based pre-shared keys are generated (if the TOE supports this functionality), and confirm that this process uses the RBG specified in FCS_RBG_EXT.1.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_49">5.2.10.2. Guidance Documentation</h5>
<div class="paragraph">
<p>The evaluator shall examine the operational guidance to determine that it provides guidance on the composition of strong text-based pre-shared keys, and (if the selection indicates keys of various lengths can be entered) that it provides information on the merits of shorter or longer pre-shared keys.  The guidance must specify the allowable characters for pre-shared keys, and that list must be a super-set of the list contained in FIA_PSK_EXT.1.2.</p>
</div>
<div class="paragraph">
<p>If bit-based pre-shared keys is selected, the evaluator shall confirm the operational guidance contains instructions for either entering bit-based pre-shared keys for each protocol identified in the requirement, or generating a bit-based pre-shared key (or both).</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_56">5.2.10.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The evaluator shall compose at least 15 pre-shared keys of 22 characters that cover all allowed characters in various combinations that conform to the operational guidance, and demonstrates that a successful protocol negotiation can be performed with each key.</p>
</li>
<li>
<p>[conditional]: If the TOE supports pre-shared keys of multiple lengths, the evaluator shall repeat Test 1 using the minimum length; the maximum length; and an invalid length.  The minimum and maximum length tests should be successful, and the invalid length must be rejected by the TOE.</p>
</li>
<li>
<p>[conditional]: If the TOE supports bit-based pre-shared keys but does not generate such keys, the evaluator shall obtain a bit-based pre-shared key of the appropriate length and enter it according to the instructions in the operational guidance.  The evaluator shall then demonstrate that a successful protocol negotiation can be performed with the key.</p>
</li>
<li>
<p>[conditional]: If the TOE supports bit-based pre-shared keys and does generate such keys, the evaluator shall generate a bit-based pre-shared key of the appropriate length and use it according to the instructions in the operational guidance.  The evaluator shall then demonstrate that a successful protocol negotiation can be performed with the key.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_passphrase_based_key_entry">5.3. Passphrase-based Key Entry</h3>
<div class="sect3">
<h4 id="_fcs_pcc_ext_1_cryptographic_password_construct_and_conditioning">5.3.1. FCS_PCC_EXT.1 Cryptographic Password Construct and Conditioning</h4>
<div class="sect4">
<h5 id="_tss_59">5.3.1.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall ensure the TSS describes the manner in which the TOE enforces the construction of passwords, including the length, and requirements on characters (number and type). The TSS also provides a description of how the password is conditioned and the evaluator ensures it satisfies the requirement.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kmd_10">5.3.1.2. KMD</h5>
<div class="paragraph">
<p>The evaluator shall examine the KMD to ensure that the formation of the BEV and intermediary keys is described and that the key sizes match that selected by the ST Author.</p>
</div>
<div class="paragraph">
<p>The evaluator shall check that the KMD describes the method by which the password/passphrase is first encoded and then fed to the SHA algorithm. The settings for the algorithm (padding, blocking, etc.) shall be described, and the evaluator shall verify that these are supported by the selections in this component as well as the selections concerning the hash function itself. The evaluator shall verify that the KMD contains a description of how the output of the hash function is used to form the submask that will be input into the function and is the same length as the BEV as specified above.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_57">5.3.1.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall also perform the following tests:</p>
</div>
<div class="paragraph">
<p>Test 1: Ensure that the TOE supports passwords/passphrases of a minimum length of 64 characters.</p>
</div>
<div class="paragraph">
<p>Test 2: If the TOE supports a password/passphrase length up to a maximum number of characters, n (which would be greater than 64), then ensure that the TOE will not accept more than n characters.</p>
</div>
<div class="paragraph">
<p>Test 3: Ensure that the TOE supports passwords consisting of all characters assigned and supported by the ST.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_kdf_ext_1_cryptographic_key_derivation">5.3.2. FCS_KDF_EXT.1 Cryptographic Key Derivation</h4>
<div class="sect4">
<h5 id="_tss_60">5.3.2.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall verify the TSS includes a description of the key derivation function and shall verify the key derivation uses an approved derivation mode and key expansion algorithm according to SP800-108, SP800-132, or ISO/IEC 11770-6:2016.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kmd_11">5.3.2.2. KMD</h5>
<div class="paragraph">
<p>The evaluator shall examine the vendors KMD to ensure that all keys used are derived using an approved method and a description of how and when the keys are derived.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_58">5.3.2.3. Tests</h5>
<div class="paragraph">
<p>The evaluator shall include test cases of FCS_KDF_EXT.1 to the test subset. Note that FCS_KDF_EXT.1 may be not mapped to the specific interface(s) after evaluators analysis during ADV_FSP.1.</p>
</div>
<div class="paragraph">
<p>The evaluator shall produce test documentation for test cases of FCS_KDF_EXT.1. If there is no explicit external interface(s) mapped to FCS_KDF_EXT.1, the evaluator shall employ an alternative test approach (refer to CEM, section 15.2.2.).</p>
</div>
<div class="paragraph">
<p>The evaluator shall perform the following tests or witness respective tests executed by the developer if technically possible, otherwise an analysis of the implementation representation has to be performed.</p>
</div>
<div class="paragraph">
<p><strong>Preconditions for testing</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Specification of input parameter to the key derivation function to be tested</p>
</li>
<li>
<p>Specification of further required input parameters</p>
</li>
<li>
<p>Access to derived key(s)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The below tests are derived from Key Derivation using Pseudorandom Functions (SP 800-108) Validation System (KBKDFVS), Updated 4 January 2016, Section 6.2, from the National Institute of Standards and Technology.</p>
</div>
<div class="paragraph">
<p>The evaluator shall perform one or more of the following tests to verify the correctness of the key derivation function, depending on the mode(s) that are supported:</p>
</div>
<div class="paragraph">
<p><strong>Counter Mode Tests</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall determine the following characteristics of the key derivation function:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>One or more pseudorandom functions (PRFs) that are included in the key derivation algorithm selection in the SFR, and their output lengths in bits (h)</p>
</li>
<li>
<p>One or more of the values {8, 16, 24, 32} that equal the length of the binary representation of the counter (r), and the location of the counter relative to the fixed input data: before, after, or in the middle. If the counter is in the middle then the lengths of data before and after the counter must be determined</p>
</li>
<li>
<p>the key size selections in the SFR, i.e the lengths (in bits) of the derived keying material (L)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For each supported combination of PRF, counter location, value of r, and value of L, the evaluator shall generate 20 pseudorandom key derivation key values (K<sub>I</sub>).</p>
</div>
<div class="paragraph">
<p>For each value of K<sub>I</sub>, the evaluator shall supply this data to the TOE in order to produce the keying material output K<sub>O</sub>. The evaluator shall verify that the resulting output matches the results from submitting the same inputs to a known-good implementation of the key derivation function, having the same characteristics.</p>
</div>
<div class="paragraph">
<p><strong>Feedback Mode Tests</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall determine the following characteristics of the key derivation function:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>One or more pseudorandom functions (PRFs) that are included in the key derivation algorithm selection in the SFR, and their output lengths in bits (h)</p>
</li>
<li>
<p>If the implementation includes a counter then one or more of the values {8, 16, 24, 32} that equal the length of the binary representation of the counter (r), and the location of the counter relative to the fixed input data: before, after, or in the middle. If the counter is in the middle then the lengths of data before and after the counter must be determined</p>
</li>
<li>
<p>the key size selections in the SFR, i.e the lengths (in bits) of the derived keying material (L)</p>
</li>
<li>
<p>the supported IV lengths.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For each supported combination of PRF, counter location (of a counter is used), value of r (if a counter is used), value of L, and IV length, the evaluator shall generate 20 pseudorandom key derivation key values (K<sub>I</sub>).</p>
</div>
<div class="paragraph">
<p>For each value of K<sub>I</sub>, the evaluator shall supply this data to the TOE in order to produce the keying material output K<sub>O</sub>. The evaluator shall verify that the resulting output matches the results from submitting the same inputs to a known-good implementation of the key derivation function, having the same characteristics.</p>
</div>
<div class="paragraph">
<p><strong>Double Pipeline Iteration Mode Tests</strong></p>
</div>
<div class="paragraph">
<p>The evaluator shall determine the following characteristics of the key derivation function:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>One or more pseudorandom functions (PRFs) that are included in the key derivation algorithm selection in the SFR, and their output lengths in bits (h)</p>
</li>
<li>
<p>If the implementation includes a counter then one or more of the values {8, 16, 24, 32} that equal the length of the binary representation of the counter (r), and the location of the counter relative to the fixed input data: before, after, or in the middle. If the counter is in the middle then the lengths of data before and after the counter must be determined</p>
</li>
<li>
<p>the key size selections in the SFR, i.e the lengths (in bits) of the derived keying material (L)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For each supported combination of PRF, counter location (if a counter is used), value of r (if a counter is used), and value of L, the evaluator shall generate 20 pseudorandom key derivation key values (K<sub>I</sub>).</p>
</div>
<div class="paragraph">
<p>For each value of K<sub>I</sub>, the evaluator shall supply this data to the TOE in order to produce the keying material output K<sub>O</sub>. The evaluator shall verify that the resulting output matches the results from submitting the same inputs to a known-good implementation of the key derivation function, having the same characteristics.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_cop_1cmac_cryptographic_operation_for_cipher_based_message_authentication">5.3.3. FCS_COP.1/CMAC Cryptographic Operation (for cipher-based message authentication)</h4>
<div class="sect4">
<h5 id="_tss_61">5.3.3.1. TSS</h5>
<div class="paragraph">
<p>If HMAC was selected:
The evaluator shall examine the TSS to ensure that it specifies the following values used by the HMAC function: key length, hash function used, block size, and output MAC length used.</p>
</div>
<div class="paragraph">
<p>If CMAC was selected:
The evaluator shall examine the TSS to ensure that it specifies the following values used by the CMAC function: key length, block cipher used, block size (of the cipher), and output MAC length used.</p>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_50">5.3.3.2. Guidance Documentation</h5>
<div class="paragraph">
<p>There are no AGD evaluation activities for this SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kmd_12">5.3.3.3. KMD</h5>
<div class="paragraph">
<p>There are no KMD evaluation activities for this SFR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tests_59">5.3.3.4. Tests</h5>
<div class="paragraph">
<p>Note: Testing of cryptographic functions implemented in the Root of Trust for Secure Boot (FPT_SBT_EXT.1) may not be feasible and independent testing may not be available. In this situation, contact the CC Scheme.</p>
</div>
<div class="paragraph">
<p>If HMAC was selected:
For each of the supported parameter sets, the evaluator shall compose 15 sets of test data. Each set shall consist of a key and message data. The evaluator shall have the TSF generate HMAC tags for these sets of test data. The resulting MAC tags shall be compared to the result of generating HMAC tags with the same key using a known good implementation.</p>
</div>
<div class="paragraph">
<p>If CMAC was selected:
For each of the supported parameter sets, the evaluator shall compose at least 15 sets of test data. Each set shall consist of a key and message data. The test data shall include messages of different lengths, some with partial blocks as the last block and some with full blocks as the last block. The test data keys shall include cases for which subkey K1 is generated both with and without using the irreducible polynomial R_b, as well as cases for which subkey K2 is generated from K1 both with and without using the irreducible polynomial R_b. (The subkey generation and polynomial R_b are as defined in SP800-38E.) The evaluator shall have the TSF generate CMAC tags for these sets of test data. The resulting MAC tags shall be compared to the result of generating CMAC tags with the same key using a known good implementation.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_sni_ext_1_cryptographic_operation_salt_nonce_and_initialization_vector_generation">5.3.4. FCS_SNI_EXT.1 Cryptographic Operation (Salt, Nonce, and Initialization Vector Generation)</h4>
<div class="sect4">
<h5 id="_tss_62">5.3.4.1. TSS</h5>
<div class="paragraph">
<p>The evaluator shall ensure the TSS describes how salts are generated. The evaluator shall confirm that the salt is generating using an RBG described in FCS_RBG_EXT.1.</p>
</div>
<div class="paragraph">
<p>The evaluator shall ensure the TSS describes how nonces are created uniquely and how IVs and tweaks are handled (based on the AES mode). The evaluator shall confirm that the nonces are unique and the IVs and tweaks meet the stated requirements.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_identification_and_authentication_fia_2">5.4. Identification and Authentication (FIA)</h3>
<div class="sect3">
<h4 id="_authentication_using_x_509_certificates_fia_x509_ext">5.4.1. Authentication using X.509 certificates (FIA_X509_EXT)</h4>
<div class="sect4">
<h5 id="_fia_x509_ext_1_x_509_certificate_validation">5.4.1.1. FIA_X509_EXT.1  X.509 Certificate Validation</h5>
<div class="sect5">
<h6 id="_tss_63">5.4.1.1.1. TSS</h6>
<div class="paragraph">
<p>The evaluator shall ensure the TSS describes where the check of validity of the certificates takes place, and that the TSS identifies any of the rules for extendedKeyUsage fields (in FIA_X509_EXT.1.1) that are not supported by the TOE (i.e., where the ST is therefore claiming that they are trivially satisfied). It is expected that revocation checking is performed when a certificate is used in an authentication step and when performing trusted updates (if selected). It is not necessary to verify the revocation status of X.509 certificates during power-up self-tests (if the option for using X.509 certificates for self-testing is selected).</p>
</div>
<div class="paragraph">
<p>The TSS shall describe when revocation checking is performed and on what certificates. If the revocation checking during authentication is handled differently depending on whether a full certificate chain or only a leaf certificate is being presented, any differences must be summarized in the TSS section and explained in the Guidance.</p>
</div>
</div>
<div class="sect5">
<h6 id="_guidance_documentation_51">5.4.1.1.2. Guidance Documentation</h6>
<div class="paragraph">
<p>The evaluator shall also ensure that the guidance documentation describes where the check of validity of the certificates takes place, describes any of the rules for extendedKeyUsage fields (in FIA_X509_EXT.1.1) that are not supported by the TOE (i.e., where the ST is therefore claiming that they are trivially satisfied) and describes how certificate revocation checking is performed and on which certificate.</p>
</div>
</div>
<div class="sect5">
<h6 id="_tests_60">5.4.1.1.3. Tests</h6>
<div class="paragraph">
<p>The evaluator shall demonstrate that checking the validity of a certificate is performed when a certificate is used in an authentication step or when performing trusted updates. It is not sufficient to verify the status of a X.509 certificate only when it is loaded onto the TOE. It is not necessary to verify the revocation status of X.509 certificates during power-up self-tests (if the option for using X.509 certificates for self-testing is selected). The evaluator shall perform the following tests for FIA_X509_EXT.1. These tests must be repeated for each distinct security function that utilizes X.509v3 certificates. For example, if the TOE implements certificate-based authentication with IPSEC and TLS, then it shall be tested with each of these protocols:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1a: The evaluator shall present the TOE with a valid chain of certificates (terminating in a trusted CA certificate) as needed to validate the leaf certificate to be used in the function and shall use this chain to demonstrate that the function succeeds. Test 1a shall be designed in a way that the chain can be 'broken' in Test 1b by either being able to remove the trust anchor from the TOEs trust store, or by setting up the trust store in a way that at least one intermediate CA certificate needs to be provided, together with the leaf certificate from outside the TOE, to complete the chain (e.g., by storing only the root CA certificate in the trust store).</p>
<div class="paragraph">
<p>Test 1b: The evaluator shall then 'break' the chain used in Test 1a by either removing the trust anchor in the TOE&#8217;s trust store used to terminate the chain, or by removing one of the intermediate CA certificates (provided together with the leaf certificate in Test 1a) to complete the chain. The evaluator shall show that an attempt to validate this broken chain fails.</p>
</div>
</li>
<li>
<p>Test 2: The evaluator shall demonstrate that validating an expired certificate results in the function failing.</p>
</li>
<li>
<p>Test 3: The evaluator shall test that the TOE can properly handle revoked certificates-conditional on whether CRL or OCSP is selected; if both are selected, then a test shall be performed for each method. The evaluator shall test revocation of the peer certificate and revocation of the peer intermediate CA certificate i.e. the intermediate CA certificate should be revoked by the root CA. The evaluator shall ensure that a valid certificate is used, and that the validation function succeeds. The evaluator then attempts the test with a certificate that has been revoked (for each method chosen in the selection) to ensure when the certificate is no longer valid that the validation function fails. Revocation checking is only applied to certificates that are not designated as trust anchors. Therefore, the revoked certificate(s) used for testing shall not be a trust anchor.</p>
</li>
<li>
<p>Test 4: If OCSP is selected, the evaluator shall configure the OCSP server or use a man-in-the-middle tool to present a certificate that does not have the OCSP signing purpose and verify that validation of the OCSP response fails. If CRL is selected, the evaluator shall configure the CA to sign a CRL with a certificate that does not have the cRLsign key usage bit set and verify that validation of the CRL fails.</p>
</li>
<li>
<p>Test 5: The evaluator shall modify any byte in the first eight bytes of the certificate and demonstrate that the certificate fails to validate. (The certificate will fail to parse correctly.)</p>
</li>
<li>
<p>Test 6: The evaluator shall modify any byte in the certificate signatureValue field (see RFC5280 Sec. 4.1.1.3), which is normally the last field in the certificate, and demonstrate that the certificate fails to validate. (The signature on the certificate will not validate.)</p>
</li>
<li>
<p>Test 7: The evaluator shall modify any byte in the public key of the certificate and demonstrate that the certificate fails to validate. (The hash of the certificate will not validate.)</p>
<div class="paragraph">
<p>The following tests are run when a minimum certificate path length of three certificates is implemented.</p>
</div>
</li>
<li>
<p>Test 8: (Conditional on support for EC certificates as indicated in FCS_COP.1/SigGen). The evaluator shall conduct the following tests:</p>
<div class="paragraph">
<p>Test 8a: (Conditional on TOE ability to process CA certificates presented in certificate message) The test shall be designed in a way such that only the EC root certificate is designated as a trust anchor, and by setting up the trust store in a way that the EC Intermediate CA certificate needs to be provided, together with the leaf certificate, from outside the TOE to complete the chain (e.g., by storing only the EC root CA certificate in the trust store). The evaluator shall present the TOE with a valid chain of EC certificates (terminating in a trusted CA certificate), where the elliptic curve parameters are specified as a named curve. The evaluator shall confirm that the TOE validates the certificate chain.</p>
</div>
<div class="paragraph">
<p>Test 8b: (Conditional on TOE ability to process CA certificates presented in certificate message) The test shall be designed in a way such that only the EC root certificate is designated as a trust anchor, and by setting up the trust store in a way that the EC Intermediate CA certificate needs to be provided, together with the leaf certificate, from outside the TOE to complete the chain (e.g., by storing only the EC root CA certificate in the trust store). The evaluator shall present the TOE with a chain of EC certificates (terminating in a trusted CA certificate), where the intermediate certificate in the certificate chain uses an explicit format version of the Elliptic Curve parameters in the public key information field, and is signed by the trusted EC root CA, but having no other changes. The evaluator shall confirm the TOE treats the certificate as invalid.</p>
</div>
<div class="paragraph">
<p>Test 8c: The evaluator shall establish a subordinate CA certificate, where the elliptic curve parameters are specified as a named curve, that is signed by a trusted EC root CA. The evaluator shall attempt to load the certificate into the trust store and observe that it is accepted into the TOE&#8217;s trust store. The evaluator shall then establish a subordinate CA certificate that uses an explicit format version of the elliptic curve parameters, and that is signed by a trusted EC root CA. The evaluator shall attempt to load the certificate into the trust store and observe that it is rejected, and not added to the TOE&#8217;s trust store.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The evaluator shall perform the following tests for FIA_X509_EXT.1.2. The tests described must be performed in conjunction with the other certificate services assurance activities, including the functions in FIA_X509_EXT.2.1. The tests for the extendedKeyUsage rules are performed in conjunction with the uses that require those rules. Where the TSS identifies any of the rules for extendedKeyUsage fields (in FIA_X509_EXT.1.1) that are not supported by the TOE (i.e. where the ST is therefore claiming that they are trivially satisfied) then the associated extendedKeyUsage rule testing may be omitted.</p>
</div>
<div class="paragraph">
<p>The goal of the following tests is to verify that the TOE accepts a certificate as a CA certificate only if it has been marked as a CA certificate by using basicConstraints with the CA flag set to True (and implicitly tests that the TOE correctly parses the basicConstraints extension as part of X509v3 certificate chain validation).</p>
</div>
<div class="paragraph">
<p>For each of the following tests the evaluator shall create a chain of at least three certificates: a self-signed root CA certificate, an intermediate CA certificate and a leaf (node) certificate. The properties of the certificates in the chain are adjusted as described in each individual test below (and this modification shall be the only invalid aspect of the relevant certificate chain).</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall ensure that at least one of the CAs in the chain does not contain the basicConstraints extension. The evaluator confirms that the TOE rejects such a certificate at one (or both) of the following points: (i) as part of the validation of the leaf certificate belonging to this chain; (ii) when attempting to add a CA certificate without the basicConstraints extension to the TOEs trust store (i.e. when attempting to install the CA certificate as one which will be retrieved from the TOE itself when validating future certificate chains).</p>
</li>
<li>
<p>Test 2: The evaluator shall ensure that at least one of the CA certificates in the chain has a basicConstraints extension in which the CA flag is set to FALSE. The evaluator confirms that the TOE rejects such a certificate at one (or both) of the following points: (i) as part of the validation of the leaf certificate belonging to this chain; (ii) when attempting to add a CA certificate with the CA flag set to FALSE to the TOEs trust store (i.e. when attempting to install the CA certificate as one which will be retrieved from the TOE itself when validating future certificate chains).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The evaluator shall repeat these tests for each distinct use of certificates. Thus, for example, use of certificates for TLS connection is distinct from use of certificates for trusted updates so both of these uses would be tested. But there is no need to repeat the tests for each separate TLS channel/path in FTP_ITC.1, FTP_TRP.1/Admin and FTP_TRP.1/NonAdmin (unless the channels/paths use separate implementations of TLS).</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_fia_x509_ext_2_x_509_certificate_authentication">5.4.1.2. FIA_X509_EXT.2  X.509 Certificate Authentication</h5>
<div class="sect5">
<h6 id="_tss_64">5.4.1.2.1. TSS</h6>
<div class="paragraph">
<p>The evaluator shall check the TSS to ensure that it describes how the TOE chooses which certificates to use, and any necessary instructions in the administrative guidance for configuring the operating environment so that the TOE can use the certificates.</p>
</div>
<div class="paragraph">
<p>The evaluator shall examine the TSS to confirm that it describes the behaviour of the TOE when a connection cannot be established during the validity check of a certificate used in establishing a trusted channel. The evaluator shall verify that any distinctions between trusted channels are described. If the requirement that the administrator is able to specify the default action, then the evaluator shall ensure that the guidance documentation contains instructions on how this configuration action is performed.</p>
</div>
</div>
<div class="sect5">
<h6 id="_guidance_documentation_52">5.4.1.2.2. Guidance Documentation</h6>
<div class="paragraph">
<p>The evaluator shall also ensure that the guidance documentation describes the configuration required in the operating environment so the TOE can use the certificates.  The guidance documentation shall also include any required configuration on the TOE to use the certificates.  The guidance document shall also describe the steps for the Security Administrator to follow if the connection cannot be established during the validity check of a certificate used in establishing a trusted channel.</p>
</div>
</div>
<div class="sect5">
<h6 id="_tests_61">5.4.1.2.3. Tests</h6>
<div class="paragraph">
<p>The evaluator shall perform the following test for each trusted channel:</p>
</div>
<div class="paragraph">
<p>The evaluator shall demonstrate that using a valid certificate that requires certificate validation checking to be performed in at least some part by communicating with a non-TOE IT entity. The evaluator shall then manipulate the environment so that the TOE is unable to verify the validity of the certificate and observe that the action selected in FIA_X509_EXT.2.2 is performed. If the selected action is administrator-configurable, then the evaluator shall follow the guidance documentation to determine that all supported administrator-configurable options behave in their documented manner.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_fia_x509_ext_3_x509_certificate_requests">5.4.1.3. FIA_X509_EXT.3 X509 Certificate Requests</h5>
<div class="sect5">
<h6 id="_tss_65">5.4.1.3.1. TSS</h6>
<div class="paragraph">
<p>If the ST author selects "device-specific information", the evaluator shall verify that the TSS contains a description of the device-specific fields used in certificate requests.</p>
</div>
</div>
<div class="sect5">
<h6 id="_guidance_documentation_53">5.4.1.3.2. Guidance Documentation</h6>
<div class="paragraph">
<p>The evaluator shall check to ensure that the guidance documentation contains instructions on requesting certificates from a CA, including generation of a Certificate Request. If the ST author selects "Common Name", "Organization", "Organizational Unit", or "Country", the evaluator shall ensure that this guidance includes instructions for establishing these fields before creating the Certification Request.</p>
</div>
</div>
<div class="sect5">
<h6 id="_tests_62">5.4.1.3.3. Tests</h6>
<div class="paragraph">
<p>The evaluator shall perform the following tests:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall use the guidance documentation to cause the TOE to generate a Certification Request. The evaluator shall capture the generated message and ensure that it conforms to the format specified. The evaluator shall confirm that the Certification Request provides the public key and other required information, including any necessary user-input information.</p>
</li>
<li>
<p>Test 2: The evaluator shall demonstrate that validating a response message to a Certification Request without a valid certification path results in the function failing. The evaluator shall then load a certificate or certificates as trusted CAs needed to validate the certificate response message and demonstrate that the function succeeds.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_evaluation_activities_for_sars">6. Evaluation Activities for SARs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The sections below specify EAs for the Security Assurance Requirements (SARs) included in the related cPPs. The EAs in <a href="#_evaluation_activities_for_sfrs">Chapter 2, <em>Evaluation Activities for SFRs</em></a>, <a href="#_evaluation_activities_for_conditionally_mandatory_requirements">Chapter 3, <em>Evaluation Activities for Conditionally Mandatory Requirements</em></a>, <a href="#_evaluation_activities_for_optional_requirements">Chapter 4, <em>Evaluation Activities for Optional Requirements</em></a>, and <a href="#_evaluation_activities_for_selection_based_requirements">Chapter 5, <em>Evaluation Activities for Selection-Based Requirements</em></a> are an interpretation of the more general CEM assurance requirements as they apply to the specific technology area of the TOE.</p>
</div>
<div class="paragraph">
<p>In this section, each SAR that is contained in the cPP is listed, and the EAs that are not associated with an SFR are captured here, or a reference is made to the CEM, and the evaluator is expected to perform the CEM work units.</p>
</div>
<div class="sect2">
<h3 id="_class_ase_security_target">6.1. Class ASE: Security Target</h3>
<div class="paragraph">
<p>When evaluating a Security Target, the evaluator performs the work units as presented in the CEM. In addition, the evaluator ensures the content of the TSS in the ST satisfies the EAs specified in <a href="#_evaluation_activities_for_sfrs">Chapter 2, <em>Evaluation Activities for SFRs</em></a> as well as the EAs for the conditionally-mandatory, optional, and selection-based SFRs claimed by the ST and specified in <a href="#_evaluation_activities_for_conditionally_mandatory_requirements">Chapter 3, <em>Evaluation Activities for Conditionally Mandatory Requirements</em></a>, <a href="#_evaluation_activities_for_optional_requirements">Chapter 4, <em>Evaluation Activities for Optional Requirements</em></a>, and <a href="#_evaluation_activities_for_selection_based_requirements">Chapter 5, <em>Evaluation Activities for Selection-Based Requirements</em></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_class_adv_development">6.2. Class ADV: Development</h3>
<div class="sect3">
<h4 id="_basic_functional_specification_adv_fsp_1">6.2.1. Basic Functional Specification (ADV_FSP.1)</h4>
<div class="paragraph">
<p>The EAs for this assurance component focus on understanding the interfaces (e.g., application programing interfaces, command line interfaces, graphical user interfaces, network interfaces) described in the AGD documentation, and possibly identified in the TOE Summary Specification (TSS) in response to the SFRs. Specific evaluator actions to be performed against this documentation are identified (where relevant) for each SFR in <a href="#_evaluation_activities_for_sfrs">Chapter 2, <em>Evaluation Activities for SFRs</em></a>, <a href="#_evaluation_activities_for_conditionally_mandatory_requirements">Chapter 3, <em>Evaluation Activities for Conditionally Mandatory Requirements</em></a>, <a href="#_evaluation_activities_for_optional_requirements">Chapter 4, <em>Evaluation Activities for Optional Requirements</em></a>, <a href="#_evaluation_activities_for_selection_based_requirements">Chapter 5, <em>Evaluation Activities for Selection-Based Requirements</em></a>, and in EAs for AGD, ATE and AVA SARs in other parts of <a href="#_evaluation_activities_for_sars">Chapter 6, <em>Evaluation Activities for SARs</em></a>.</p>
</div>
<div class="paragraph">
<p>The EAs are reworded (indicated with italicization) for clarity and interpret the CEM work units such that they will result in more objective and repeatable actions by the evaluator. The EAs in this SD are intended to ensure the evaluators are consistently performing equivalent actions.</p>
</div>
<div class="paragraph">
<p>The documents to be examined for this assurance component in an evaluation are therefore the Security Target, AGD documentation, and any required supplementary information required by the cPP: no additional "functional specification" documentation is necessary to satisfy the EAs. The interfaces that need to be evaluated are also identified by reference to the EAs listed for each SFR, and are expected to be identified in the context of the Security Target, AGD documentation, and any required supplementary information defined in the cPP rather than as a separate list specifically for the purposes of CC evaluation. The direct identification of documentation requirements and their assessment as part of the EAs for each SFR also means that the tracing required in ADV_FSP.1.2D (work units ADV_FSP.1-4, ADV_FSP.1-6 and ADV_FSP.1-7) is treated as implicit and no separate mapping information is required for this element.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Mapping of ADV_FSP.1 CEM Work Units to Evaluation Activities</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">CEM ADV_FSP.1 Work Units</th>
<th class="tableblock halign-left valign-middle">Evaluator Activities</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ADV_FSP.1-1 The evaluator <strong><em>shall examine</em></strong> the functional specification to determine that it states the purpose of each SFR-supporting and SFR-enforcing TSFI.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><a href="#_adv_fsp_1_1_evaluation_activity">Section 6.2.2, &#8220;ADV_FSP.1-1 Evaluation Activity&#8221;</a>: <em>The evaluator shall examine the interface documentation to ensure it describes the purpose and method of use for each TSFI that is identified as being security relevant.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ADV_FSP.1-2 The evaluator <strong><em>shall examine</em></strong> the functional specification to determine that the method of use for each SFR-supporting and SFR-enforcing TSFI is given.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><a href="#_adv_fsp_1_2_evaluation_activity">Section 6.2.3, &#8220;ADV_FSP.1-2 Evaluation Activity&#8221;</a>: <em>The evaluator shall examine the interface documentation to ensure it describes the purpose and method of use for each TSFI that is identified as being security relevant.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ADV_FSP.1-3 The evaluator <strong><em>shall examine</em></strong> the presentation of the TSFI to determine that it identifies all parameters associated with each SFR-enforcing and SFR supporting
TSFI.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><a href="#_adv_fsp_1_3_evaluation_activity">Section 6.2.4, &#8220;ADV_FSP.1-3 Evaluation Activity&#8221;</a>: <em>The evaluator shall check the interface documentation to ensure it identifies and describes the parameters for each TSFI that is identified as being security relevant.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ADV_FSP.1-4 The evaluator <strong><em>shall examine</em></strong> the rationale provided by the developer for the implicit categorisation of interfaces as SFR-non-interfering to determine that it is accurate.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Paragraph 609 from the CEM: "In the case where the developer has provided adequate documentation to perform the analysis called for by the rest of the work units for this component without explicitly identifying SFR-enforcing and SFR-supporting interfaces, this work unit should be considered satisfied."</p>
<p class="tableblock">Since the rest of the ADV_FSP.1 work units will have been satisfied upon completion of the EAs, it follows that this work unit is satisfied as well.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ADV_FSP.1-5 The evaluator <strong><em>shall check</em></strong> that the tracing links the SFRs to the corresponding TSFIs.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><a href="#_adv_fsp_1_5_evaluation_activity">Section 6.2.5, &#8220;ADV_FSP.1-5 Evaluation Activity&#8221;</a>: <em>The evaluator shall examine the interface documentation to develop a mapping of the interfaces to SFRs.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ADV_FSP.1-6 The evaluator <strong><em>shall examine</em></strong> the functional specification to determine that it is a complete instantiation of the SFRs.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">EAs that are associated with the SFRs in <a href="#_evaluation_activities_for_sfrs">Chapter 2, <em>Evaluation Activities for SFRs</em></a>, and, if applicable, <a href="#_evaluation_activities_for_conditionally_mandatory_requirements">Chapter 3, <em>Evaluation Activities for Conditionally Mandatory Requirements</em></a>, <a href="#_evaluation_activities_for_optional_requirements">Chapter 4, <em>Evaluation Activities for Optional Requirements</em></a> and <a href="#_evaluation_activities_for_selection_based_requirements">Chapter 5, <em>Evaluation Activities for Selection-Based Requirements</em></a>, are performed to ensure that all the SFRs where the security functionality is externally visible (i.e., at the TSFI) are covered. Therefore, the intent of this work unit is covered.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ADV_FSP.1-7 The evaluator <strong><em>shall examine</em></strong> the functional specification to determine that it is an accurate instantiation of the SFRs.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">EAs that are associated with the SFRs in <a href="#_evaluation_activities_for_sfrs">Chapter 2, <em>Evaluation Activities for SFRs</em></a>, and, if applicable,  <a href="#_evaluation_activities_for_conditionally_mandatory_requirements">Chapter 3, <em>Evaluation Activities for Conditionally Mandatory Requirements</em></a>, <a href="#_evaluation_activities_for_optional_requirements">Chapter 4, <em>Evaluation Activities for Optional Requirements</em></a> and <a href="#_evaluation_activities_for_selection_based_requirements">Chapter 5, <em>Evaluation Activities for Selection-Based Requirements</em></a>, are performed to ensure that all the SFRs where the security functionality is externally visible (i.e., at the TSFI) are addressed, and that the description of the interfaces is accurate with respect to the specification captured in the SFRs. Therefore, the intent of this work unit is covered.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_adv_fsp_1_1_evaluation_activity">6.2.2. ADV_FSP.1-1 Evaluation Activity</h4>
<div class="paragraph">
<p><em>The evaluator shall examine the interface documentation to ensure it describes the purpose and method of use for each TSFI that is identified as being security relevant.</em></p>
</div>
<div class="paragraph">
<p>In this context, TSFI are deemed security relevant if they are used by the administrator to configure the TOE, or to perform other administrative functions (e.g., audit review or performing updates). Additionally, those interfaces that are identified in the ST, or guidance documentation, as adhering to the security policies (as presented in the SFRs), are also considered security relevant. The intent, is that these interfaces will be adequately tested, and having an understanding of how these interfaces are used in the TOE is necessary to ensure proper test coverage is applied.</p>
</div>
<div class="paragraph">
<p>The set of TSFI that are provided as evaluation evidence are contained in the Administrative Guidance and User Guidance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_adv_fsp_1_2_evaluation_activity">6.2.3. ADV_FSP.1-2 Evaluation Activity</h4>
<div class="paragraph">
<p><em>The evaluator shall examine the interface documentation to ensure it describes the purpose and method of use for each TSFI that is identified as being security relevant.</em></p>
</div>
<div class="paragraph">
<p>In this context, TSFI are deemed security relevant if they are used by the administrator to configure the TOE, or to perform other administrative functions (e.g., audit review or performing updates). Additionally, those interfaces that are identified in the ST, or guidance documentation, as adhering to the security policies (as presented in the SFRs), are also considered security relevant. The intent, is that these interfaces will be adequately tested, and having an understanding of how these interfaces are used in the TOE is necessary to ensure proper test coverage is applied.</p>
</div>
<div class="paragraph">
<p>The set of TSFI that are provided as evaluation evidence are contained in the Administrative Guidance and User Guidance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_adv_fsp_1_3_evaluation_activity">6.2.4. ADV_FSP.1-3 Evaluation Activity</h4>
<div class="paragraph">
<p><em>The evaluator shall check the interface documentation to ensure it identifies and describes the parameters for each TSFI that is identified as being security relevant.</em></p>
</div>
</div>
<div class="sect3">
<h4 id="_adv_fsp_1_5_evaluation_activity">6.2.5. ADV_FSP.1-5 Evaluation Activity</h4>
<div class="paragraph">
<p><em>The evaluator shall examine the interface documentation to develop a mapping of the interfaces to SFRs.</em></p>
</div>
<div class="paragraph">
<p>The evaluator uses the provided documentation and first identifies, and then examines a representative set of interfaces to perform the EAs presented in Chapter 2 and, if applicable, <a href="#_evaluation_activities_for_conditionally_mandatory_requirements">Chapter 3, <em>Evaluation Activities for Conditionally Mandatory Requirements</em></a>, <a href="#_evaluation_activities_for_optional_requirements">Chapter 4, <em>Evaluation Activities for Optional Requirements</em></a> and <a href="#_evaluation_activities_for_selection_based_requirements">Chapter 5, <em>Evaluation Activities for Selection-Based Requirements</em></a>, including the EAs associated with testing of the interfaces.</p>
</div>
<div class="paragraph">
<p>It should be noted that there may be some SFRs that do not have an interface that is explicitly mapped to invoke the desired functionality. For example, generating a random bit string, destroying a cryptographic key that is no longer needed, or the TSF failing to a secure state, are capabilities that may be specified in SFRs, but are not invoked by an interface.</p>
</div>
<div class="paragraph">
<p>However, if the evaluator is unable to perform some other required EA because there is insufficient design and interface information, then the evaluator is entitled to conclude that an adequate functional specification has not been provided, and hence that the verdict for the ADV_FSP.1 assurance component is a fail.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_class_agd_guidance_documentation">6.3. Class AGD: Guidance Documentation</h3>
<div class="paragraph">
<p>It is not necessary for a TOE to provide separate documentation to meet the individual requirements of AGD_OPE and AGD_PRE. Although the EAs in this section are described under the traditionally separate AGD families, the mapping between the documentation provided by the developer and the AGD_OPE and AGD_PRE requirements may be many-to-many, as long as all requirements are met in documentation that is delivered to administrators and users (as appropriate) as part of the TOE.</p>
</div>
<div class="sect3">
<h4 id="_operational_user_guidance_agd_ope_1">6.3.1. Operational User Guidance (AGD_OPE.1)</h4>
<div class="paragraph">
<p>The evaluator performs the CEM work units associated with the AGD_OPE.1 SAR. Specific requirements and EAs on the guidance documentation are identified (where relevant) in the individual EAs for each SFR.</p>
</div>
<div class="paragraph">
<p>In addition, the evaluator performs the EAs specified below.</p>
</div>
<div class="sect4">
<h5 id="_evaluation_activity">6.3.1.1. Evaluation Activity</h5>
<div class="paragraph">
<p>The evaluator shall ensure the Operational guidance documentation is distributed to administrators and users (as appropriate) as part of the TOE, so that there is a reasonable guarantee that administrators and users are aware of the existence and role of the documentation in establishing and maintaining the evaluated configuration.</p>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_2">6.3.1.2. Evaluation Activity</h5>
<div class="paragraph">
<p>The evaluator shall ensure that the Operational guidance is provided for every Operational Environment that the product supports as claimed in the Security Target and shall adequately address all platforms claimed for the TOE in the Security Target.</p>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_3">6.3.1.3. Evaluation Activity</h5>
<div class="paragraph">
<p>The evaluator shall ensure that the Operational guidance contains instructions for configuring any cryptographic engine associated with the evaluated configuration of the TOE. It shall provide a warning to the administrator that use of other cryptographic engines was not evaluated nor tested during the CC evaluation of the TOE.</p>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_4">6.3.1.4. Evaluation Activity</h5>
<div class="paragraph">
<p>The evaluator shall ensure the Operational guidance makes it clear to an administrator which security functionality and interfaces have been assessed and tested by the EAs.</p>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_5">6.3.1.5. Evaluation Activity</h5>
<div class="paragraph">
<p>In addition the evaluator shall ensure that the following requirements are also met.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The documentation must describe the process for verifying updates to
the TOE by verifying a digital signature. The evaluator shall verify that
this process includes the following steps:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Instructions for obtaining the update itself. This should include
instructions for making the update accessible to the TOE (e.g.,
placement in a specific directory).</p>
</li>
<li>
<p>Instructions for initiating the update process, as well as
discerning whether the process was successful or unsuccessful.
This includes instructions that describe at least one method of
validating the hash/digital signature.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The TOE will likely contain security functionality that does not fall in
the scope of evaluation under this cPP. The guidance documentation
shall make it clear to an administrator which security functionality is
covered by the EAs.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_preparative_procedures_agd_pre_1">6.3.2. Preparative Procedures (AGD_PRE.1)</h4>
<div class="paragraph">
<p>The evaluator performs the CEM work units associated with the AGD_PRE.1 SAR. Specific requirements and EAs on the preparative documentation are identified (and where relevant are captured in the Guidance Documentation portions of the EAs) in the individual EAs for each SFR.</p>
</div>
<div class="paragraph">
<p>Preparative procedures are distributed to administrators and users (as appropriate) as part of the TOE, so that there is a reasonable guarantee that administrators and users are aware of the existence and role of the documentation in establishing and maintaining the evaluated configuration.</p>
</div>
<div class="paragraph">
<p>In addition, the evaluator performs the EAs specified below.</p>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_6">6.3.2.1. Evaluation Activity</h5>
<div class="paragraph">
<p>The evaluator shall examine the Preparative procedures to ensure they include a description of how the administrator verifies that the operational environment can fulfil its role to support the security functionality (including the requirements of the Security Objectives for the Operational Environment specified in the Security Target).</p>
</div>
<div class="paragraph">
<p>The documentation should be in an informal style and should be written with sufficient detail and explanation that they can be understood and used by the target audience (which will typically include IT staff who have general IT experience but not necessarily experience with the TOE product itself).</p>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_7">6.3.2.2. Evaluation Activity</h5>
<div class="paragraph">
<p>The evaluator shall examine the Preparative procedures to ensure they are provided for every Operational Environment that the product supports as claimed in the Security Target and shall adequately address all platforms claimed for the TOE in the Security Target.</p>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_8">6.3.2.3. Evaluation Activity</h5>
<div class="paragraph">
<p>The evaluator shall examine the preparative procedures to ensure they include instructions to successfully install the TSF in each Operational Environment.</p>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_9">6.3.2.4. Evaluation Activity</h5>
<div class="paragraph">
<p>The evaluator shall examine the preparative procedures to ensure they include instructions to manage the security of the TSF as a product and as a component of the larger operational environment.</p>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_10">6.3.2.5. Evaluation Activity</h5>
<div class="paragraph">
<p>In addition the evaluator shall ensure that the following requirements are also met.</p>
</div>
<div class="paragraph">
<p>The preparative procedures must</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Include instructions to provide a protected administrative capability; and</p>
</li>
<li>
<p>Identify TOE passwords that have default values associated with them and
instructions shall be provided for how these can be changed.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_class_alc_life_cycle_support">6.4. Class ALC: Life-cycle Support</h3>
<div class="sect3">
<h4 id="_labelling_of_the_toe_alc_cmc_1">6.4.1. Labelling of the TOE (ALC_CMC.1)</h4>
<div class="paragraph">
<p>When evaluating that the TOE has been provided and is labelled with a unique reference, the evaluator performs the work units as presented in the CEM.</p>
</div>
</div>
<div class="sect3">
<h4 id="_toe_cm_coverage_alc_cms_1">6.4.2. TOE CM coverage (ALC_CMS.1)</h4>
<div class="paragraph">
<p>When evaluating the developer&#8217;s coverage of the TOE in their CM system, the evaluator performs the work units as presented in the CEM.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_class_ate_tests">6.5. Class ATE: Tests</h3>
<div class="sect3">
<h4 id="_independent_testing_conformance_ate_ind_1">6.5.1. Independent Testing - Conformance (ATE_IND.1)</h4>
<div class="paragraph">
<p>The focus of the testing is to confirm that the requirements specified in the SFRs are being met. Additionally, testing is performed to confirm the functionality described in the TSS, as well as the dependencies on the Operational guidance documentation is accurate.</p>
</div>
<div class="paragraph">
<p>The evaluator performs the CEM work units associated with the ATE_IND.1
SAR. Specific testing requirements and EAs are captured for each SFR in
<a href="#_evaluation_activities_for_sfrs">Chapter 2, <em>Evaluation Activities for SFRs</em></a>, <a href="#_evaluation_activities_for_conditionally_mandatory_requirements">Chapter 3, <em>Evaluation Activities for Conditionally Mandatory Requirements</em></a>, <a href="#_evaluation_activities_for_optional_requirements">Chapter 4, <em>Evaluation Activities for Optional Requirements</em></a>, and <a href="#_evaluation_activities_for_selection_based_requirements">Chapter 5, <em>Evaluation Activities for Selection-Based Requirements</em></a>.</p>
</div>
<div class="paragraph">
<p>The evaluator should consult <a href="#_equivalency_considerations">Appendix B, <em>Equivalency Considerations</em></a> when determining the appropriate
strategy for testing multiple variations or models of the TOE that may be under
evaluation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_class_ava_vulnerability_assessment">6.6. Class AVA: Vulnerability Assessment</h3>
<div class="sect3">
<h4 id="_vulnerability_survey_ava_van_1">6.6.1. Vulnerability Survey (AVA_VAN.1)</h4>
<div class="paragraph">
<p>While vulnerability analysis is inherently a subjective activity, a minimum level of analysis can be defined and some measure of objectivity and repeatability (or at least comparability) can be imposed on the vulnerability analysis process. In order to achieve such objectivity and repeatability it is important that the evaluator follows a set of well-defined activities, and documents their findings so others can follow their arguments and come to the same conclusions as the evaluator. While this does not guarantee that different evaluation facilities will identify exactly the same type of vulnerabilities or come to exactly the same conclusions, the approach defines the minimum level of analysis and the scope of that analysis, and provides Certification Bodies a measure of assurance that the minimum level of analysis is being performed by the evaluation facilities.</p>
</div>
<div class="paragraph">
<p>In order to meet these goals some refinement of the AVA_VAN.1 CEM work units is needed. The following table indicates, for each work unit in AVA_VAN.1, whether the CEM work unit is to be performed as written, or if it has been clarified by an Evaluation Activity. If clarification has been provided, a reference to this clarification is provided in the table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Mapping of AVA_VAN.1 CEM Work Units to Evaluation Activities</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">CEM AVA_VAN.1 Work Units</th>
<th class="tableblock halign-left valign-middle">Evaluator Activities</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-1 The evaluator <strong><em>shall examine</em></strong> the TOE to determine that the test configuration is consistent with the configuration under evaluation as specified in the ST.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">The evaluator shall perform the CEM activity as specified.</p>
<p class="tableblock"><em>If the iTC specifies any tools to be used in performing this analysis in section A.1.4, the following text is also included in this cell: "The calibration of test resources specified in paragraph 1467 of the CEM applies to the tools listed in Appendix A, Section A.1.4."</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-2 The evaluator <strong><em>shall examine</em></strong> the TOE to determine that it has been installed properly and is in a known state. The evaluator shall perform the CEM activity as specified.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">The evaluator shall perform the CEM activity as specified.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-3 The evaluator <strong><em>shall examine</em></strong> sources of information publicly available to identify potential vulnerabilities in the TOE. Replace CEM work unit with activities outlined in Appendix A, Section A.1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Replace CEM work unit with activities outlined in Appendix A, Section A.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-4 The evaluator <strong><em>shall record</em></strong> in the ETR the identified potential vulnerabilities that are candidates for testing and applicable to the TOE in its operational environment.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Replace the CEM work unit with the analysis activities on the list of potential vulnerabilities in Appendix A, section A.1, and documentation as specified in Appendix A, Section A.3.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-5 The evaluator <strong><em>shall devise</em></strong> penetration tests, based on the independent search for potential vulnerabilities.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Replace the CEM work unit with the activities specified in Appendix A, section A.2.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>AVA_VAN.1-6 The evaluator <strong><em>shall produce</em></strong> penetration test documentation for the tests based on the list of potential vulnerabilities in sufficient detail to enable the tests to be repeatable. The test documentation shall include:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Identification of the potential vulnerability the TOE is being tested for;</p>
</li>
<li>
<p>Instructions to connect and setup all required test equipment as required to conduct the penetration test;</p>
</li>
<li>
<p>Instructions to establish all penetration test prerequisite initial
conditions;</p>
</li>
<li>
<p>Instructions to stimulate the TSF;</p>
</li>
<li>
<p>Instructions for observing the behaviour of the TSF;</p>
</li>
<li>
<p>Descriptions of all expected results and the necessary analysis to be performed on the observed behaviour for comparison against
expected results;</p>
</li>
<li>
<p>Instructions to conclude the test and establish the necessary post-test state for the TOE.</p>
</li>
</ol>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">The CEM work unit is captured in Appendix A, Section A.3; there are no substantive differences.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-7 The evaluator shall conduct penetration testing.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">The evaluator shall perform the CEM activity as specified. See Appendix A, Section A.3 for guidance related to attack potential for confirmed flaws.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-8 The evaluator shall record the actual results of the penetration tests.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">The evaluator shall perform the CEM activity as specified.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-9 The evaluator shall report in the ETR the evaluator penetration testing effort, outlining the testing approach, configuration, depth and results.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Replace the CEM work unit with the reporting called for in Appendix A, Section A.3.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-10 The evaluator shall examine the results of all penetration testing to determine that the TOE, in its operational environment, is resistant to an attacker possessing a Basic attack potential.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">This work unit is not applicable for Type 1 and Type 2 flaws (as defined in Appendix A, Section A.1), as inclusion in this Supporting Document by the iTC makes any confirmed vulnerabilities stemming from these flaws subject to an attacker possessing a Basic attack potential. This work unit is replaced for Type 3 and Type 4 flaws by the activities defined in Appendix A, Section A.2, paragraph 110.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>AVA_VAN.1-11 The evaluator shall report in the ETR all exploitable vulnerabilities and residual vulnerabilities, detailing for each:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Its source (e.g., CEM activity being undertaken when it was conceived, known to the evaluator, read in a publication);</p>
</li>
<li>
<p>The SFR(s) not met;</p>
</li>
<li>
<p>A description;</p>
</li>
<li>
<p>Whether it is exploitable in its operational environment or not (i.e., exploitable or residual).</p>
</li>
<li>
<p>The amount of time, level of  expertise, level of knowledge of the
TOE, level of opportunity and the equipment required to perform the identified vulnerabilities, and the corresponding values using the tables 3 and 4 of Annex B.4.</p>
</li>
</ol>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Replace the CEM work unit with the reporting called for in Appendix A, Section A.3.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Because of the level of detail required for the evaluation activities, the bulk of the instructions are contained in Appendix A, while an "outline" of the assurance activity is provided below.</p>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_documentation">6.6.1.1. Evaluation Activity (Documentation)</h5>
<div class="paragraph">
<p>In addition to the activities specified by the CEM in accordance with Table 3 above, the evaluator shall perform the following activities.</p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the documentation outlined below provided by
the developer to confirm that it contains all required information. This
documentation is in addition to the documentation already required to be
supplied in response to the EAs listed previously.</em></p>
</div>
<div class="paragraph">
<p>The developer shall provide documentation identifying the list of software and
hardware components that compose the TOE. Hardware components should
identify at a minimum the processors used by the TOE. Software components
include applications, the operating system and other major components that
are independently identifiable and reusable (outside the TOE) such as a web
server and protocol or cryptographic libraries. This additional documentation
is merely a list of the name and version number of the components and will be
used by the evaluators in formulating hypotheses during their analysis.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_required_supplementary_information">7. Required Supplementary Information</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Supporting Document refers in various places to the possibility that 'required supplementary information' may need to be supplied as part of the deliverables for an evaluation. This term is intended to describe information that is not necessarily included in the Security Target or operational guidance, and that may not necessarily be public. Examples of such information could be entropy analysis, or description of a cryptographic key management architecture used in (or in support of) the TOE. The requirement for any such supplementary information will be identified in the relevant cPP.</p>
</div>
<div class="paragraph">
<p>The supplementary information required by this SD are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entropy Documentation, which is evaluated against the guidance specified in Appendix E of <a href="#HCDcPP">[HCDcPP]</a>.</p>
</li>
<li>
<p>A Key Management Description (KMD), which is evaluated against guidance specified in Appendix F of <a href="#HCDcPP">[HCDcPP]</a> and all relevant KMD Evaluation Activities in this SD.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_evaluation_activity_11">8. Evaluation Activity</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The evaluator formulates hypotheses in accordance with process defined in
Appendix A. The evaluator documents the flaw hypotheses generated for the
TOE in the report in accordance with the guidelines in Appendix A.3. The
evaluator shall perform vulnerability analysis in accordance with Appendix
A.2. The results of the analysis shall be documented in the report according to
Appendix A.3.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references">9. References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><span id="2600">[2600]</span> IEEE Std. 2600-2008 IEEE Standard for Information Technology: Hardcopy Device and System Security</p>
</li>
<li>
<p><span id="2600" class="1">[2600.1]</span> IEEE Std. 2600.1-2009 IEEE Standard for a Protection Profile in Operational Environment A</p>
</li>
<li>
<p><span id="610" class="12">[610.12]</span>  IEEE Std 610.12-1990 IEEE Standard Glossary of Software Engineering Terminology</p>
</li>
<li>
<p><span id="8802-6">[8802-6]</span> ISO/IEC 8802-6:1994 Information technology  Telecommunications and information exchange between systems  Local and metropolitan area networks  Specific requirements  Part 6</p>
</li>
<li>
<p><span id="CC1">[CC1]</span> Common Criteria for Information Technology Security Evaluation, Part 1: Introduction and general model, CCMB-2022-11-001, CC:2022 Revision 1, November 2022.</p>
</li>
<li>
<p><span id="CC2">[CC2]</span> Common Criteria for Information Technology Security Evaluation, Part 2: Security functional components, CCMB-2022-11-002, CC:2022 Revision 1, November 2022.</p>
</li>
<li>
<p><span id="CC3">[CC3]</span> Common Criteria for Information Technology Security Evaluation, Part 3: Security assurance components, CCMB-2022-11-003, CC:2022 Revision 1, November 2022.</p>
</li>
<li>
<p><span id="CEM">[CEM]</span> Common Methodology for Information Technology Security Evaluation, Evaluation methodology, CCMB-2022-11-006, CC:2022 Revision 1, November 2022.</p>
</li>
<li>
<p><span id="addenda">[addenda]</span> Errata and Interpretation for CC:2022 (Release 1) and CEM:2022 (Release 1), 002, Version 1.1, July 22, 2024.</p>
</li>
<li>
<p><span id="HCDcPP">[HCDcPP]</span> collaborative Protection Profile for Hardcopy Devices, 1.1, 29 December 2025</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vulnerability_analysis">Appendix A: Vulnerability Analysis</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_sources_of_vulnerability_information">A.1. Sources of Vulnerability Information</h3>
<div class="paragraph">
<p>CEM Work Unit AVA_VAN.1-3 has been supplemented in this Supporting Document to provide a better-defined set of flaws to investigate and procedures to follow based on this particular technology. Terminology used is based on the flaw hypothesis methodology, where the evaluation team hypothesizes flaws and then either proves or disproves those flaws (a flaw is equivalent to a "potential vulnerability" as used in the CEM). Flaws are categorized into four "types" depending on how they are formulated:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A list of flaw hypotheses applicable to the technology described by the cPP derived from public sources as documented in <a href="#Type1Hypotheses">Section A.1.1, &#8220;Type 1 Hypotheses - Public-Vulnerability-based&#8221;</a>-this fixed set has been agreed to by the iTC. Additionally, this will be supplemented with entries for a set of public sources (as indicated below) that are directly applicable to the TOE or its identified components (as defined by the process in <a href="#Type1Hypotheses">Section A.1.1, &#8220;Type 1 Hypotheses - Public-Vulnerability-based&#8221;</a> below); this is to ensure that the evaluators include in their assessment applicable entries that have been discovered since the cPP was published;</p>
</li>
<li>
<p>A list of flaw hypotheses contained in this document that are derived from lessons learned specific to that technology and other iTC input (that might be derived from other open sources and vulnerability databases, for example) as documented in <a href="#Type2Hypotheses">Section A.1.2, &#8220;Type 2 Hypotheses - iTC-sourced&#8221;</a>;</p>
</li>
<li>
<p>A list of flaw hypotheses derived from information available to the evaluators; this includes  the baseline evidence provided by the vendor described in this Supporting Document (documentation associated with EAs, documentation described in <a href="#_evaluation_activity_documentation">Section 6.6.1.1, &#8220;Evaluation Activity (Documentation)&#8221;</a>, &lt;the iTC can remove the reference to <a href="#_evaluation_activity_documentation">Section 6.6.1.1, &#8220;Evaluation Activity (Documentation)&#8221;</a> if no additional documentation is defined&gt; documentation described in <a href="#_required_supplementary_information">Chapter 7, <em>Required Supplementary Information</em></a>), as well as other information (public and/or based on evaluator experience) as documented in <a href="#Type3Hypotheses">Section A.1.3, &#8220;Type 3 Hypotheses - Evaluation-Team-Generated&#8221;</a>; and</p>
</li>
<li>
<p>A list of flaw hypotheses that are generated through the use of iTC-defined tools (e.g., nmap, protocol testers) and their application is specified in <a href="#Type4Hypotheses">Section A.1.4, &#8220;Type 4 Hypotheses - Tool-Generated&#8221;</a>.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="Type1Hypotheses">A.1.1. Type 1 Hypotheses - Public-Vulnerability-based</h4>
<div class="paragraph">
<p>The following list of public sources of vulnerability information was selected by the iTC:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Search Common Vulnerabilities and Exposures: <a href="http://cve.mitre.org/cve/" class="bare">http://cve.mitre.org/cve/</a></p>
</li>
<li>
<p>Search the National Vulnerability Database: <a href="https://nvd.nist.gov/" class="bare">https://nvd.nist.gov/</a></p>
</li>
<li>
<p>Search US-CERT: <a href="http://www.kb.cert.org/vuls/html/search" class="bare">http://www.kb.cert.org/vuls/html/search</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The list of sources above was searched with the search terms selected by evaluation laboratories.</p>
</div>
<div class="paragraph">
<p>In order to supplement this list, the evaluators shall also perform a search on the sources listed above to determine a list of potential flaw hypotheses that are more recent that the publication date of the cPP, and those that are specific to the TOE and its components as specified by the additional documentation mentioned above. Any duplicates - either in a specific entry, or in the flaw hypothesis that is generated from an entry from the same or a different source - can be noted and removed from consideration by the evaluation team.</p>
</div>
<div class="paragraph">
<p>As part of type 1 flaw hypothesis generation for the specific components of the TOE, the evaluator shall also search the component manufacturer&#8217;s websites to determine if flaw hypotheses can be generated on this basis (for instance, if security patches have been released for the version of the component being evaluated, the subject of those patches may form the basis for a flaw hypothesis).</p>
</div>
</div>
<div class="sect3">
<h4 id="Type2Hypotheses">A.1.2. Type 2 Hypotheses - iTC-sourced</h4>
<div class="paragraph">
<p>The following list of flaw hypothesis generated by the iTC for this technology must be considered by the evaluation team as flaw hypotheses in performing the vulnerability assessment.</p>
</div>
<div class="paragraph">
<p>There are currently no iTC-sourced flaw hypotheses. A future revision of the HCD
cPP may update this section for relevant findings made by evaluation laboratories.</p>
</div>
<div class="paragraph">
<p>If the evaluators discover a Type 3 or Type 4 flaw that they believe should be considered as a Type 2 flaw in future versions of this cPP, they should work with their Certification Body to determine the appropriate means of submitting the flaw for consideration by the iTC.</p>
</div>
</div>
<div class="sect3">
<h4 id="Type3Hypotheses">A.1.3. Type 3 Hypotheses - Evaluation-Team-Generated</h4>
<div class="paragraph">
<p>Type 3 flaws are formulated by the evaluator based on information presented by the product (through on-line help, product documentation and user guides, etc.) and product behaviour during the (functional) testing activities. The evaluator is also free to formulate flaws that are based on material that is not part of the baseline evidence (e.g., information gleaned from an Internet mailing list, or reading interface documentation on interfaces not included in the set provided by the developer), although such activities have the potential to vary significantly based upon the product and evaluation facility performing the analysis.</p>
</div>
<div class="paragraph">
<p>If the evaluators discover a Type 3 flaw that they believe should be considered as a Type 2 flaw in future versions of this cPP, they should work with their Certification Body to determine the appropriate means of submitting the flaw for consideration by the iTC.</p>
</div>
</div>
<div class="sect3">
<h4 id="Type4Hypotheses">A.1.4. Type 4 Hypotheses - Tool-Generated</h4>
<div class="paragraph">
<p>If the evaluators discover a Type 4 flaw that they believe should be considered as a Type 2 flaw in future versions of this cPP, they should work with their Certification Body to determine the appropriate means of submitting the flaw for consideration by the iTC.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_for_evaluator_vulnerability_analysis">A.2. Process for Evaluator Vulnerability Analysis</h3>
<div class="paragraph">
<p>As flaw hypotheses are generated from the activities described above, the evaluation team will disposition them; that is, attempt to prove, disprove, or determine the non-applicability of the hypotheses. This process is as follows.</p>
</div>
<div class="paragraph">
<p>The evaluator will refine each flaw hypothesis for the TOE and attempt to disprove it using the information provided by the developer or through penetration testing. During this process, the evaluator is free to interact directly with the developer to determine if the flaw exists, including requests to the developer for additional evidence (e.g., detailed design information, consultation with engineering staff); however, the CB should be included in these discussions. Should the developer object to the information being requested as being not compatible with the overall level of the evaluation activity/cPP and cannot provide evidence otherwise that the flaw is disproved, the evaluator prepares an appropriate set of materials as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The source documents used in formulating the hypothesis, and why it represents a potential compromise against a specific TOE function;</p>
</li>
<li>
<p>An argument why the flaw hypothesis could not be proven or disproved by the evidence provided so far; and</p>
</li>
<li>
<p>The type of information required to investigate the flaw hypothesis further.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Certification Body (CB) will then either approve or disapprove the request for additional information. If approved, the developer provides the requested evidence to disprove the flaw hypothesis (or, of course, acknowledge the flaw).</p>
</div>
<div class="paragraph">
<p>For each hypothesis, the evaluator will note whether the flaw hypothesis has been successfully disproved, successfully proven to have identified a flaw, or requires further investigation. It is important to have the results documented as outlined in Section A.3 below.</p>
</div>
<div class="paragraph">
<p>If the evaluator finds a flaw, the evaluator must report these flaws to the developer. All reported flaws must be addressed as follows:</p>
</div>
<div class="paragraph">
<p>If the developer confirms that the flaw exists and that it is exploitable at Basic Attack Potential, then a change is made by the developer, and the resulting resolution is agreed by the evaluator and noted as part of the evaluation report.</p>
</div>
<div class="paragraph">
<p>If the developer, the evaluator, and the CB agree that the flaw is exploitable only above Basic Attack Potential and does not require resolution for any other reason, then no change is made and the flaw is noted as a residual vulnerability in the CB-internal report (ETR).</p>
</div>
<div class="paragraph">
<p>If the developer and evaluator agree that the flaw is exploitable only above Basic Attack Potential, but it is deemed critical to fix because of technology-specific or cPP-specific aspects such as typical use cases or operational environments, then a change is made by the developer, and the resulting resolution is agreed by the evaluator and noted as part of the evaluation report.</p>
</div>
<div class="paragraph">
<p>Disagreements between evaluator and vendor regarding questions of the existence of a flaw, its attack potential, or whether it should be deemed critical to fix are resolved by the CB.</p>
</div>
<div class="paragraph">
<p>Any testing performed by the evaluator shall be documented in the test report as outlined in <a href="#_reporting">Section A.3, &#8220;Reporting&#8221;</a> below.</p>
</div>
<div class="paragraph">
<p>As indicated in <a href="#_reporting">Section A.3, &#8220;Reporting&#8221;</a>, Reporting, the public statement with respect to vulnerability analysis that is performed on TOEs conformant to the cPP is constrained to coverage of flaws associated with Types 1 and 2 (defined in <a href="#_sources_of_vulnerability_information">Section A.1, &#8220;Sources of Vulnerability Information&#8221;</a>) flaw hypotheses only. The fact that the iTC generates these candidate hypotheses indicates these must be addressed.</p>
</div>
<div class="paragraph">
<p>For flaws of Types 3 and 4, each CB is responsible for determining what constitutes Basic Attack Potential for the purposes of determining whether a flaw is exploitable in the TOE&#8217;s environment. The determination criteria shall be documented in the CB-internal report as specified in <a href="#_reporting">Section A.3, &#8220;Reporting&#8221;</a>. As this is a per-CB activity, no public claims are made with respect to the resistance of a particular TOE against flaws of Types 3 and 4; rather, the claim is that the activities outlined in this appendix were carried out, and the evaluation team and CB agreed that any residual vulnerabilities are not exploitable by an attacker with Basic Attack Potential.</p>
</div>
</div>
<div class="sect2">
<h3 id="_reporting">A.3. Reporting</h3>
<div class="paragraph">
<p>The evaluators shall produce two reports on the testing effort; one that is public-facing (that is, included in the non-proprietary evaluation report, which is a subset of the Evaluation Technical Report (ETR)), and the complete ETR that is delivered to the overseeing CB.</p>
</div>
<div class="paragraph">
<p>The public-facing report contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The terms and sources used when the procedures for searching public sources were followed according to instructions in the Supporting Document per <a href="#Type1Hypotheses">Section A.1.1, &#8220;Type 1 Hypotheses - Public-Vulnerability-based&#8221;</a>;</p>
</li>
<li>
<p>A statement that the evaluators have examined the Type 1 flaw hypotheses specified in this Supporting Document in <a href="#Type1Hypotheses">Section A.1.1, &#8220;Type 1 Hypotheses - Public-Vulnerability-based&#8221;</a> (i.e., the flaws listed in the previous bullet) and the Type 2 flaw hypotheses specified in this Supporting Document by the iTC in <a href="#Type2Hypotheses">Section A.1.2, &#8220;Type 2 Hypotheses - iTC-sourced&#8221;</a>.</p>
</li>
<li>
<p>A statement that the evaluation team developed Types 3 and 4 flaw hypotheses in accordance with Sections <a href="#Type3Hypotheses">Section A.1.3, &#8220;Type 3 Hypotheses - Evaluation-Team-Generated&#8221;</a>, <a href="#Type4Hypotheses">Section A.1.4, &#8220;Type 4 Hypotheses - Tool-Generated&#8221;</a>, and <a href="#_process_for_evaluator_vulnerability_analysis">Section A.2, &#8220;Process for Evaluator Vulnerability Analysis&#8221;</a>, and that no residual vulnerabilities exist that are exploitable by attackers with Basic Attack Potential as defined by the CB in accordance with the guidance in the CEM. It should be noted that this is just a statement about the "fact of" Types 3 and 4 flaw hypotheses being developed, and that no specifics about the number of flaws, the flaws themselves, or the analysis pertaining to those flaws will be included in the public-facing report.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>No other information is provided in the public-facing report.</p>
</div>
<div class="paragraph">
<p>The internal CB report contains, in addition to the information in the public-facing report:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A list of all of the flaw hypotheses generated (cf. AVA_VAN.1-4);</p>
</li>
<li>
<p>The evaluator penetration testing effort, outlining the testing approach, configuration, depth and results (cf. AVA_VAN.1-9);</p>
</li>
<li>
<p>All documentation used to generate the flaw hypotheses (in identifying the documentation used in coming up with the flaw hypotheses, the evaluation team must characterize the documentation so that a reader can determine whether it is strictly required by this Supporting Document, and the nature of the documentation (design information, developer engineering notebooks, etc.));</p>
</li>
<li>
<p>The evaluator shall report all exploitable vulnerabilities and residual vulnerabilities, detailing for each:</p>
<div class="ulist">
<ul>
<li>
<p>Its source (e.g., CEM activity being undertaken when it was conceived, known to the evaluator, read in a publication);</p>
</li>
<li>
<p>The SFR(s) not met;</p>
</li>
<li>
<p>A description;</p>
</li>
<li>
<p>Whether it is exploitable in its operational environment or not (i.e., exploitable or residual).</p>
</li>
<li>
<p>The amount of time, level of expertise, level of knowledge of the TOE, level of opportunity and the equipment required to perform the identified vulnerabilities (cf. AVA_VAN.1-11);</p>
</li>
</ul>
</div>
</li>
<li>
<p>How each flaw hypothesis was resolved (this includes whether the original flaw hypothesis was confirmed or disproved, and any analysis relating to whether a residual vulnerability is exploitable by an attacker with Basic Attack Potential) (cf. AVA_VAN1-10); and</p>
</li>
<li>
<p>In the case that actual testing was performed in the investigation (either as part of flaw hypothesis generation using tools specified by the iTC in Section A.1.4, or in proving/disproving a particular flaw) the steps followed in setting up the TOE (and any required test equipment); executing the test; post-test procedures; and the actual results (to a level of detail that allow repetition of the test, including the following:</p>
<div class="ulist">
<ul>
<li>
<p>Identification of the potential vulnerability the TOE is being tested for;</p>
</li>
<li>
<p>Instructions to connect and setup all required test equipment as required to conduct the penetration test;</p>
</li>
<li>
<p>Instructions to establish all penetration test prerequisite initial conditions;</p>
</li>
<li>
<p>Instructions to stimulate the TSF;</p>
</li>
<li>
<p>Instructions for observing the behaviour of the TSF;</p>
</li>
<li>
<p>Descriptions of all expected results and the necessary analysis to be performed on the observed behaviour for comparison against expected results;</p>
</li>
<li>
<p>Instructions to conclude the test and establish the necessary post-test state for the TOE. (cf. AVA_VAN.1-6, AVA_VAN.1-8).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_equivalency_considerations">Appendix B: Equivalency Considerations</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_2">B.1. Introduction</h3>
<div class="paragraph">
<p>This appendix provides a foundation for evaluators to determine whether a vendor&#8217;s request for equivalency of products is allowed.</p>
</div>
<div class="paragraph">
<p>For the purpose of this evaluation, equivalency can be broken into two categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Variations in models</strong>: Separate TOE models/variations may include differences that could necessitate separate testing across each model. If there are no variations in any of the categories listed below, the models may be considered equivalent.</p>
</li>
<li>
<p><strong>Variations in TOE dependencies on the environment (e.g., OS/platform the product is tested on)</strong>: The method a TOE provides functionality (or the functionality itself) may vary depending upon the environment on which it is installed. If there is no difference in the TOE-provided functionality or in the manner in which the TOE provides the functionality, the models may be considered equivalent.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Determination of equivalency for each of the above specified categories can result in several different testing outcomes.</p>
</div>
<div class="paragraph">
<p>If a set of TOE are determined to be equivalent, testing may be performed on a single variation of the TOE. However, if the TOE variations have security-relevant functional differences, each of the TOE models that exhibits either functional or structural differences must be separately tested. Generally speaking, only the difference between each variation of TOE must be separately tested. Other equivalent functionality may be tested on a representative model and not across multiple platforms.</p>
</div>
<div class="paragraph">
<p>If it is determined that a TOE operates the same regardless of the environment, testing may be performed on a single instance for all equivalent configurations. However, if the TOE is determined to provide environment-specific functionality, testing must take place in each environment for which a difference in functionality exists. Similar to the above scenario, only the functionality affected by environment differences must be retested.</p>
</div>
<div class="paragraph">
<p>If a vendor disagrees with the evaluator&#8217;s assessment of equivalency, the Scheme arbitrates between the two parties whether equivalency exists.</p>
</div>
</div>
<div class="sect2">
<h3 id="_evaluator_guidance_for_determining_equivalence">B.2. Evaluator guidance for determining equivalence</h3>
<div class="sect3">
<h4 id="_strategy">B.2.1. Strategy</h4>
<div class="paragraph">
<p>When performing the equivalency analysis, the evaluator should consider each factor independently. A factor may be any number of things at various levels of abstraction, ranging from the processor a device uses, to the underlying operating system and hardware platform a software application relies upon. Examples may be the various chip sets employed by the product, the type of network interface (different device drivers), storage media (solid state drive, spinning disk, EEPROM). It is important to consider how the difference in these factors may influence the TOE&#8217;s ability to enforce the SFRs. Each analysis of an individual factor will result in one of two outcomes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For the particular factor, all variations of the TOE on all supported platforms are equivalent. In this case, testing may be performed on a single model in a single test environment and cover all supported models and environments.</p>
</li>
<li>
<p>For the particular factor, a subset of the product has been identified to require separate testing to ensure that it operates identically to all other equivalent TOEs. The analysis would identify the specific combinations of models/testing environments that needed to be tested.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Complete CC testing of the product would encompass the totality of each individual analysis performed for each of the identified factors.</p>
</div>
</div>
<div class="sect3">
<h4 id="_guidance_for_hardcopy_devices">B.2.2. Guidance for hardcopy devices</h4>
<div class="paragraph">
<p>The following table provides a description of how an evaluator should
consider each of the factors that affect equivalency between TOE model
variations and across operating environments. Additionally, the table also
identifies scenarios that will result in additional separate testing across models.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Evaluation Equivalency Analysis</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Factor</th>
<th class="tableblock halign-left valign-top">Same/Not Same</th>
<th class="tableblock halign-left valign-top">Evaluator guidance</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><strong>Platform/Hardware Dependencies</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Independent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If there are no identified platform/hardware
dependencies, the evaluator shall consider testing
on multiple hardware platforms to be equivalent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If there are specified differences between
platforms/hardware, the evaluator must identify if
the differences affect the cPP-specified security
functionality or if they apply to non-cPP-specified
functionality. If functionality specified in the cPP
is dependent upon platform/hardware provided
services, the product must be tested on each of the
different platforms to be considered validated on
that particular hardware combination. In these
cases, the evaluator has the option of only retesting
the functionality dependent upon the
platform/hardware provided functionality. If the
differences only affect non-cPP-specified
functionality, the variations may still be
considered equivalent. For each difference the
evaluator must provide an explanation of why the
difference does or does not affect cPP-specified
functionality.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><strong>Differences in TOE Software Binaries</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the model binaries are identical, the model
variations shall be considered equivalent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Different</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If there are differences between model software
binaries, a determination must be made if the
differences affect cPP-specified security
functionality. If cPP-specified functionality is
affected, the models are not considered equivalent
and must be tested separately. The evaluator has
the option of only retesting the functionality that
was affected by the software differences. If the
differences only affect non-PP specified
functionality, the models may still be considered
equivalent. For each difference the evaluator must
provide an explanation of why the difference does
or does not affect cPP specified functionality.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><strong>Differences in Libraries Used to Provide TOE Functionality</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Same</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If there are no differences between the libraries
used in various TOE models, the model variations
shall be considered equivalent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Different</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the separate libraries are used between model
variations, a determination of whether the
functionality provided by the library affects cPPspecified
functionality must be made. If cPPspecified
functionality is affected, the models are
not considered equivalent and must be tested
separately. The evaluator has the option of only retesting the functionality that was affected by the
differences in the included libraries. If the different
libraries only affect non-PP specified
functionality, the models may still be considered
equivalent. For each different library, the evaluator
must provide an explanation of why the different
libraries do or do not affect cPP specified
functionality.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><strong>TOE Management Interface Differences</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consistent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If there are no differences in the management
interfaces between various TOE models, the model
variations shall be considered equivalent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differences</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the product provides separate interfaces based on
the model variation, a determination must be made
of whether cPP-specified functionality can be
configured by the different interfaces. If the
interface differences affect cPP-specified
functionality, the variations are not considered
equivalent and must be separately tested. The
evaluator has the option of only retesting the
functionality that can be configured by the
different interfaces (and the configuration of said
functionality). If the different management
interfaces only affect non-PP specified
functionality, the models may still be considered
equivalent. For each management interface
difference, the evaluator must provide an
explanation of why the different management
interfaces do or do not affect cPP specified
functionality.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><strong>TOE Functional Differences</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the functionality provided by different TOE
model variation is identical, the models variations
shall be considered equivalent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Different</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the functionality provided by different TOE
model variations differ, a determination must be
made if the functional differences affect cPPspecified
functionality. If cPP-specific
functionality differs between models, the models
are not considered equivalent and must be tested
separately. In these cases, the evaluator has the
option of only retesting the functionality that
differs model-to-model. If the functional
differences only affect non-cPP specified
functionality, the model variations may still be
considered equivalent. For each difference the
evaluator must provide an explanation of why the difference does or does not affect cPP specified
functionality.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_test_presentationtruth_in_advertising">B.2.3. Test presentation/Truth in advertising</h4>
<div class="paragraph">
<p>In addition to determining what to test, the evaluation results and resulting validation report must identify the actual module and testing environment combinations that have been tested. The analysis used to determine the testing subset may be considered proprietary and will only optionally be publicly included.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_glossary">Appendix C: Glossary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For definitions of standard CC terminology see [CC1].</p>
</div>
<div class="dlist glossary">
<dl>
<dt>Administrator</dt>
<dd>
<p>A User who has been specifically granted the authority to manage some portion or all of the TOE and whose actions may affect the security policies of the TOE. Administrators may possess special privileges that provide capabilities to override portions of security policies. [2600.1]</p>
</dd>
<dt>Confidential (TSF) Data</dt>
<dd>
<p>Assets for which either disclosure or alteration by a User who is not an Administrator or the owner of the data would have an effect on the operational security of the TOE. [2600.1]</p>
</dd>
<dt>DEK</dt>
<dd>
<p>A key used to encrypt data at rest.</p>
</dd>
<dt>External Authentication</dt>
<dd>
<p>Identification and authentication mechanism that uses services of External IT Entities to authenticate TOE Users.</p>
</dd>
<dt>Hardcopy Device</dt>
<dd>
<p>A system producing or utilizing a physical embodiment of an electronic document or image. These systems include printers, scanners, fax machines, digital copiers, MFPs (multifunction peripherals), MFDs (multifunction devices), all-in-ones and other similar products.[2600]</p>
</dd>
<dt>Immutable</dt>
<dd>
<p>Unchangeable. In the context of this document, this refers only to the inability to make changes in the field through manufacturer intended mechanisms and/or defined interfaces. Note that a platform or device manufacturer may still be able to make changes through manufacturing or service tools directly connected to a locally (physically) present platform or device.</p>
</dd>
<dt>Intermediate Key</dt>
<dd>
<p>A key used in a point between the initial user authorization and the DEK. [CPP_FDE_EE_V2.0]</p>
</dd>
<dt>Internal Authentication</dt>
<dd>
<p>Identification and authentication function that is wholly contained within the TOE.</p>
</dd>
<dt>Job</dt>
<dd>
<p>A document processing task submitted to the hardcopy device. A single processing task may process one or more documents. [2600.1]</p>
</dd>
<dt>Nonvolatile Storage Device</dt>
<dd>
<p>A device that provides computer storage of data that is not cleared when the power is turned off.</p>
</dd>
<dt>Operational Environment</dt>
<dd>
<p>Environment in which the TOE is operated.[CC]</p>
</dd>
<dt>Protection Profile</dt>
<dd>
<p>Implementation-independent statement of security needs for a TOE type. [CC]</p>
</dd>
<dt>Read</dt>
<dd>
<p>To access data from a storage device or data medium. (Note that in this case, the data medium may be a printed output, and therefore, release of a print job is a read operation) [610.12]</p>
</dd>
<dt>Security Assurance Requirement</dt>
<dd>
<p>A description of how assurance is to be gained that the TOE meets the SFRs. [CC]</p>
</dd>
<dt>Security Functional Requirement</dt>
<dd>
<p>A translation of the Security Objectives for the TOE into a standardized language. [CC]</p>
</dd>
<dt>Security Objective</dt>
<dd>
<p>Statement of an intent to counter identified Threats and/or satisfy identified organization security policies and/or Assumptions. [CC]</p>
</dd>
<dt>Security Target</dt>
<dd>
<p>Implementation-dependent statement of security needs for a specific identified TOE. [CC]</p>
</dd>
<dt>Submask</dt>
<dd>
<p>A submask is a bit string that can be generated and stored in a numbers of ways, such as passphrases, tokens, etc. [CPP_FDE_EE_V2.0]</p>
</dd>
<dt>Target of Evaluation</dt>
<dd>
<p>Set of software, firmware and/or hardware possibly accompanied by guidance. [CC]</p>
</dd>
<dt>TOE Security Functionality</dt>
<dd>
<p>Combined functionality of all hardware, software, and firmware of a TOE that must be relied upon for the correct enforcement of the SFRs. [CC]</p>
</dd>
<dt>TSF Data</dt>
<dd>
<p>Data for the operation of the TOE upon which the enforcement of the SFR relies. [CC]</p>
</dd>
<dt>Unauthorized Access</dt>
<dd>
<p>Access to a resource that a User is not permitted to access.</p>
</dd>
<dt>User</dt>
<dd>
<p>Human or IT entity possibly interacting with the TOE from outside of the TOE boundary. [CC]</p>
</dd>
<dt>User Data</dt>
<dd>
<p>Data for the User that does not affect the operation of the TSF. [CC]</p>
</dd>
<dt>User Document Data</dt>
<dd>
<p>The Asset that consists of the information contained in a Users Document. This includes the original Document itself in either hardcopy or electronic form, image data, or residually stored data created by the hardcopy device while processing an original Document and printed hardcopy output. [2600.1]</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_acronyms">Appendix D: Acronyms</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Acronyms</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Acronym</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AAD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional Authenticated Data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES-CBC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Advanced Encryption Standard (AES) Cipher Algorithm in Cipher Block Chaining (CBC) Mode</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES-CCM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Advanced Encryption Standard (AES) Cipher Algorithm in Counter with CBC-MAC (CCM) Mode</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES-GCM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Advanced Encryption Standard (AES) Cipher Algorithm in Galois/Counter Mode (GCM)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XTS-AES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Advanced Encryption Standard (AES) Cipher Algorithm in XEX-based tweaked-codebook mode with ciphertext stealing (XTS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Advanced Encryption Standard</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AESAVS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Advanced Encryption Standard Algorithm Validation Suite (AESAVS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AGD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Administartor Guidance Documentation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ATA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Advanced Technology Attachment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASCII</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">American Standard Code for Information Interchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BEV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Border Encryption Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Criteria</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter with CBC-MAC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCMVS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The CCM Validation System</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CEM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Evaluation Methodology</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMAC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cipher-based Message Authentication Code</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMACVS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The CMAC Validation System (CMACVS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Critical Security Parameter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CVE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Vulnerabilities and Exposures</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cPP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">collaborative Protection Profile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Encryption Key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DHE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Diffie-Hellman Ephemeral</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DRBG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deterministic Random Bit Generator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DSA2VS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The FIPS 186-4 Digital Signature Algorithm Validation System (DSA2VS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Evaluation Activity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ECDHE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elliptic Curve Diffie-Hellman Ephemeral</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ECDSA2VS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The FIPS 186-4 Elliptic Curve Digital Signature Algorithm Validation System (ECDSA2VS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EEPROM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Electrically Erasable Programmable Read Only Memory</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Evaluation Technical Report</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encapsulating Security Payload</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FDE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full-Disk Encryption</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FIPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Federal Information Processing Standards</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Galois/Counter Mode</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCMVS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Galois/Counter Mode (GCM) and GMAC Validation System (GCMVS) with the Addition of XPN Validation Testing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GMAC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Galois Message Authentication Code</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HCD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hardcopy Device</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HMAC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keyed-Hashing for Message Authentication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HMACVS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Keyed-Hash Message Authentication Code Validation System (HMACVS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IPsec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet Protocol Security</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information Technology</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iTC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">international Technical Community</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initialization Vector</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">I&amp;A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identification and Authentication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hypertext Transfer Protocol Secure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IKE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet Key Exchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Known Answer Test</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KEM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key Encapsulation Mechanism</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KMD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key Management Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key Transport Scheme</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KWK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KEK Wrapping Key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KWS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key Wrapping Scheme</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LDAP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lightweight Directory Access Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message Authentication Code</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network Address Translation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NIST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">National Institute of Standards and Technology</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network Time Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OAEP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optimal Asymmetric Encryption Padding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Online Certificate Status Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operational Environment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Personal Computer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PSTN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public Switched Telephone Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RAID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redundant Array of Independent Disks</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RBG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Random Bit Generator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RFC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request for Comments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RivestShamirAdleman</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSA2VS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The 186-4 RSA Validation System (RSA2VS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Assurance Requirement</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supporting Document</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Self-Encrypting Drive</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SFP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Function Policy</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SFR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Functional Requirement</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure Hash Algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHAVS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Secure Hash Algorithm Validation System (SHAVS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SOC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">System on a Chip</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Problem Definition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure Shell</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Target</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transmission Control Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transport Layer Security</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target of Evaluation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TPM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trusted Platform Module</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOE Security Functionality</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSFI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOE Security Functional Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOE Summary Specification</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User Datagram Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VPN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual Private Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XPN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eXtended Packet Number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XEX-based tweaked-codebook mode with ciphertext stealing</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.1<br>
Last updated 2025-12-31 05:23:45 -0800
</div>
</div>
</body>
</html>